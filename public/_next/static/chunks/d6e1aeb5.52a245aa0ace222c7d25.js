(window.webpackJsonp = window.webpackJsonp || []).push([[85], { "8OJ3": function (e, t, i) { "use strict"; var n = i("vgmO"), r = i.n(n), a = i("7zRj"), s = i.n(a), o = i("jBAH"), l = i.n(o), u = i("3zPy"), c = i.n(u), h = i("7sdD"), d = i.n(h), p = i("K4wu"), f = i.n(p), m = i("0Tbm"), g = i.n(m), v = i("10ky"), y = i("hIRe"), _ = i("mvqA"), b = i.n(_), T = i("KAYj"), k = i.n(T), S = i("qOD0"), C = i.n(S), E = i("3D7k"), w = i.n(E), P = i("Of6Q"), L = "7.6.6", A = [], I = function (e, t) { return function (i, n, a) { var s = t.levels[n], o = new RegExp("^(" + s + ")$"); if ("log" !== i && a.unshift(i.toUpperCase() + ":"), a.unshift(e + ":"), A && A.push([].concat(a)), r.a.console) { var l = r.a.console[i]; l || "debug" !== i || (l = r.a.console.info || r.a.console.log), l && s && o.test(i) && l[Array.isArray(a) ? "apply" : "call"](r.a.console, a) } } }; var x = function e(t) { var i, n = "info", r = function () { for (var e = arguments.length, t = new Array(e), r = 0; r < e; r++)t[r] = arguments[r]; i("log", n, t) }; return i = I(t, r), r.createLogger = function (i) { return e(t + ": " + i) }, r.levels = { all: "debug|log|warn|error", off: "", debug: "debug|log|warn|error", info: "log|warn|error", warn: "warn|error", error: "error", DEFAULT: n }, r.level = function (e) { if ("string" === typeof e) { if (!r.levels.hasOwnProperty(e)) throw new Error('"' + e + '" in not a valid log level'); n = e } return n }, (r.history = function () { return A ? [].concat(A) : [] }).filter = function (e) { return (A || []).filter((function (t) { return new RegExp(".*" + e + ".*").test(t[0]) })) }, r.history.clear = function () { A && (A.length = 0) }, r.history.disable = function () { null !== A && (A.length = 0, A = null) }, r.history.enable = function () { null === A && (A = []) }, r.error = function () { for (var e = arguments.length, t = new Array(e), r = 0; r < e; r++)t[r] = arguments[r]; return i("error", n, t) }, r.warn = function () { for (var e = arguments.length, t = new Array(e), r = 0; r < e; r++)t[r] = arguments[r]; return i("warn", n, t) }, r.debug = function () { for (var e = arguments.length, t = new Array(e), r = 0; r < e; r++)t[r] = arguments[r]; return i("debug", n, t) }, r }("VIDEOJS"), O = x.createLogger, D = Object.prototype.toString, M = function (e) { return U(e) ? Object.keys(e) : [] }; function R(e, t) { M(e).forEach((function (i) { return t(e[i], i) })) } function B(e) { for (var t = arguments.length, i = new Array(t > 1 ? t - 1 : 0), n = 1; n < t; n++)i[n - 1] = arguments[n]; return Object.assign ? Object.assign.apply(Object, [e].concat(i)) : (i.forEach((function (t) { t && R(t, (function (t, i) { e[i] = t })) })), e) } function U(e) { return !!e && "object" === typeof e } function j(e) { return U(e) && "[object Object]" === D.call(e) && e.constructor === Object } function N(e, t) { if (!e || !t) return ""; if ("function" === typeof r.a.getComputedStyle) { var i = r.a.getComputedStyle(e); return i ? i.getPropertyValue(t) || i[t] : "" } return "" } function F(e) { return "string" === typeof e && /\S/.test(e) } function H(e) { if (/\s/.test(e)) throw new Error("class has illegal whitespace characters") } function q() { return s.a === r.a.document } function V(e) { return U(e) && 1 === e.nodeType } function W() { try { return r.a.parent !== r.a.self } catch (e) { return !0 } } function z(e) { return function (t, i) { if (!F(t)) return s.a[e](null); F(i) && (i = s.a.querySelector(i)); var n = V(i) ? i : s.a; return n[e] && n[e](t) } } function G(e, t, i, n) { void 0 === e && (e = "div"), void 0 === t && (t = {}), void 0 === i && (i = {}); var r = s.a.createElement(e); return Object.getOwnPropertyNames(t).forEach((function (e) { var i = t[e]; -1 !== e.indexOf("aria-") || "role" === e || "type" === e ? (x.warn("Setting attributes in the second argument of createEl()\nhas been deprecated. Use the third argument instead.\ncreateEl(type, properties, attributes). Attempting to set " + e + " to " + i + "."), r.setAttribute(e, i)) : "textContent" === e ? K(r, i) : r[e] = i })), Object.getOwnPropertyNames(i).forEach((function (e) { r.setAttribute(e, i[e]) })), n && de(r, n), r } function K(e, t) { return "undefined" === typeof e.textContent ? e.innerText = t : e.textContent = t, e } function Y(e, t) { t.firstChild ? t.insertBefore(e, t.firstChild) : t.appendChild(e) } function X(e, t) { return H(t), e.classList ? e.classList.contains(t) : (i = t, new RegExp("(^|\\s)" + i + "($|\\s)")).test(e.className); var i } function $(e, t) { return e.classList ? e.classList.add(t) : X(e, t) || (e.className = (e.className + " " + t).trim()), e } function Q(e, t) { return e.classList ? e.classList.remove(t) : (H(t), e.className = e.className.split(/\s+/).filter((function (e) { return e !== t })).join(" ")), e } function J(e, t, i) { var n = X(e, t); if ("function" === typeof i && (i = i(e, t)), "boolean" !== typeof i && (i = !n), i !== n) return i ? $(e, t) : Q(e, t), e } function Z(e, t) { Object.getOwnPropertyNames(t).forEach((function (i) { var n = t[i]; null === n || "undefined" === typeof n || !1 === n ? e.removeAttribute(i) : e.setAttribute(i, !0 === n ? "" : n) })) } function ee(e) { var t = {}, i = ",autoplay,controls,playsinline,loop,muted,default,defaultMuted,"; if (e && e.attributes && e.attributes.length > 0) for (var n = e.attributes, r = n.length - 1; r >= 0; r--) { var a = n[r].name, s = n[r].value; "boolean" !== typeof e[a] && -1 === i.indexOf("," + a + ",") || (s = null !== s), t[a] = s } return t } function te(e, t) { return e.getAttribute(t) } function ie(e, t, i) { e.setAttribute(t, i) } function ne(e, t) { e.removeAttribute(t) } function re() { s.a.body.focus(), s.a.onselectstart = function () { return !1 } } function ae() { s.a.onselectstart = function () { return !0 } } function se(e) { if (e && e.getBoundingClientRect && e.parentNode) { var t = e.getBoundingClientRect(), i = {}; return ["bottom", "height", "left", "right", "top", "width"].forEach((function (e) { void 0 !== t[e] && (i[e] = t[e]) })), i.height || (i.height = parseFloat(N(e, "height"))), i.width || (i.width = parseFloat(N(e, "width"))), i } } function oe(e) { var t; if (e.getBoundingClientRect && e.parentNode && (t = e.getBoundingClientRect()), !t) return { left: 0, top: 0 }; var i = s.a.documentElement, n = s.a.body, a = i.clientLeft || n.clientLeft || 0, o = r.a.pageXOffset || n.scrollLeft, l = t.left + o - a, u = i.clientTop || n.clientTop || 0, c = r.a.pageYOffset || n.scrollTop, h = t.top + c - u; return { left: Math.round(l), top: Math.round(h) } } function le(e, t) { var i = {}, n = oe(e), r = e.offsetWidth, a = e.offsetHeight, s = n.top, o = n.left, l = t.pageY, u = t.pageX; return t.changedTouches && (u = t.changedTouches[0].pageX, l = t.changedTouches[0].pageY), i.y = Math.max(0, Math.min(1, (s - l + a) / a)), i.x = Math.max(0, Math.min(1, (u - o) / r)), i } function ue(e) { return U(e) && 3 === e.nodeType } function ce(e) { for (; e.firstChild;)e.removeChild(e.firstChild); return e } function he(e) { return "function" === typeof e && (e = e()), (Array.isArray(e) ? e : [e]).map((function (e) { return "function" === typeof e && (e = e()), V(e) || ue(e) ? e : "string" === typeof e && /\S/.test(e) ? s.a.createTextNode(e) : void 0 })).filter((function (e) { return e })) } function de(e, t) { return he(t).forEach((function (t) { return e.appendChild(t) })), e } function pe(e, t) { return de(ce(e), t) } function fe(e) { return void 0 === e.button && void 0 === e.buttons || (0 === e.button && void 0 === e.buttons || ("mouseup" === e.type && 0 === e.button && 0 === e.buttons || 0 === e.button && 1 === e.buttons)) } var me, ge = z("querySelector"), ve = z("querySelectorAll"), ye = Object.freeze({ isReal: q, isEl: V, isInFrame: W, createEl: G, textContent: K, prependTo: Y, hasClass: X, addClass: $, removeClass: Q, toggleClass: J, setAttributes: Z, getAttributes: ee, getAttribute: te, setAttribute: ie, removeAttribute: ne, blockTextSelection: re, unblockTextSelection: ae, getBoundingClientRect: se, findPosition: oe, getPointerPosition: le, isTextNode: ue, emptyEl: ce, normalizeContent: he, appendContent: de, insertContent: pe, isSingleLeftClick: fe, $: ge, $$: ve }), _e = !1, be = function () { if (q() && !1 !== me.options.autoSetup) { var e = Array.prototype.slice.call(s.a.getElementsByTagName("video")), t = Array.prototype.slice.call(s.a.getElementsByTagName("audio")), i = Array.prototype.slice.call(s.a.getElementsByTagName("video-js")), n = e.concat(t, i); if (n && n.length > 0) for (var r = 0, a = n.length; r < a; r++) { var o = n[r]; if (!o || !o.getAttribute) { Te(1); break } void 0 === o.player && null !== o.getAttribute("data-setup") && me(o) } else _e || Te(1) } }; function Te(e, t) { t && (me = t), r.a.setTimeout(be, e) } function ke() { _e = !0, r.a.removeEventListener("load", ke) } q() && ("complete" === s.a.readyState ? ke() : r.a.addEventListener("load", ke)); var Se, Ce = function (e) { var t = s.a.createElement("style"); return t.className = e, t }, Ee = function (e, t) { e.styleSheet ? e.styleSheet.cssText = t : e.textContent = t }, we = 3; function Pe() { return we++ } r.a.WeakMap || (Se = function () { function e() { this.vdata = "vdata" + Math.floor(r.a.performance && r.a.performance.now() || Date.now()), this.data = {} } var t = e.prototype; return t.set = function (e, t) { var i = e[this.vdata] || Pe(); return e[this.vdata] || (e[this.vdata] = i), this.data[i] = t, this }, t.get = function (e) { var t = e[this.vdata]; if (t) return this.data[t]; x("We have no data for this element", e) }, t.has = function (e) { return e[this.vdata] in this.data }, t.delete = function (e) { var t = e[this.vdata]; t && (delete this.data[t], delete e[this.vdata]) }, e }()); var Le = r.a.WeakMap ? new WeakMap : new Se; function Ae(e, t) { if (Le.has(e)) { var i = Le.get(e); 0 === i.handlers[t].length && (delete i.handlers[t], e.removeEventListener ? e.removeEventListener(t, i.dispatcher, !1) : e.detachEvent && e.detachEvent("on" + t, i.dispatcher)), Object.getOwnPropertyNames(i.handlers).length <= 0 && (delete i.handlers, delete i.dispatcher, delete i.disabled), 0 === Object.getOwnPropertyNames(i).length && Le.delete(e) } } function Ie(e, t, i, n) { i.forEach((function (i) { e(t, i, n) })) } function xe(e) { function t() { return !0 } function i() { return !1 } if (!e || !e.isPropagationStopped) { var n = e || r.a.event; for (var a in e = {}, n) "layerX" !== a && "layerY" !== a && "keyLocation" !== a && "webkitMovementX" !== a && "webkitMovementY" !== a && ("returnValue" === a && n.preventDefault || (e[a] = n[a])); if (e.target || (e.target = e.srcElement || s.a), e.relatedTarget || (e.relatedTarget = e.fromElement === e.target ? e.toElement : e.fromElement), e.preventDefault = function () { n.preventDefault && n.preventDefault(), e.returnValue = !1, n.returnValue = !1, e.defaultPrevented = !0 }, e.defaultPrevented = !1, e.stopPropagation = function () { n.stopPropagation && n.stopPropagation(), e.cancelBubble = !0, n.cancelBubble = !0, e.isPropagationStopped = t }, e.isPropagationStopped = i, e.stopImmediatePropagation = function () { n.stopImmediatePropagation && n.stopImmediatePropagation(), e.isImmediatePropagationStopped = t, e.stopPropagation() }, e.isImmediatePropagationStopped = i, null !== e.clientX && void 0 !== e.clientX) { var o = s.a.documentElement, l = s.a.body; e.pageX = e.clientX + (o && o.scrollLeft || l && l.scrollLeft || 0) - (o && o.clientLeft || l && l.clientLeft || 0), e.pageY = e.clientY + (o && o.scrollTop || l && l.scrollTop || 0) - (o && o.clientTop || l && l.clientTop || 0) } e.which = e.charCode || e.keyCode, null !== e.button && void 0 !== e.button && (e.button = 1 & e.button ? 0 : 4 & e.button ? 1 : 2 & e.button ? 2 : 0) } return e } var Oe = !1; !function () { try { var e = Object.defineProperty({}, "passive", { get: function () { Oe = !0 } }); r.a.addEventListener("test", null, e), r.a.removeEventListener("test", null, e) } catch (t) { } }(); var De = ["touchstart", "touchmove"]; function Me(e, t, i) { if (Array.isArray(t)) return Ie(Me, e, t, i); Le.has(e) || Le.set(e, {}); var n = Le.get(e); if (n.handlers || (n.handlers = {}), n.handlers[t] || (n.handlers[t] = []), i.guid || (i.guid = Pe()), n.handlers[t].push(i), n.dispatcher || (n.disabled = !1, n.dispatcher = function (t, i) { if (!n.disabled) { t = xe(t); var r = n.handlers[t.type]; if (r) for (var a = r.slice(0), s = 0, o = a.length; s < o && !t.isImmediatePropagationStopped(); s++)try { a[s].call(e, t, i) } catch (l) { x.error(l) } } }), 1 === n.handlers[t].length) if (e.addEventListener) { var r = !1; Oe && De.indexOf(t) > -1 && (r = { passive: !0 }), e.addEventListener(t, n.dispatcher, r) } else e.attachEvent && e.attachEvent("on" + t, n.dispatcher) } function Re(e, t, i) { if (Le.has(e)) { var n = Le.get(e); if (n.handlers) { if (Array.isArray(t)) return Ie(Re, e, t, i); var r = function (e, t) { n.handlers[t] = [], Ae(e, t) }; if (void 0 !== t) { var a = n.handlers[t]; if (a) if (i) { if (i.guid) for (var s = 0; s < a.length; s++)a[s].guid === i.guid && a.splice(s--, 1); Ae(e, t) } else r(e, t) } else for (var o in n.handlers) Object.prototype.hasOwnProperty.call(n.handlers || {}, o) && r(e, o) } } } function Be(e, t, i) { var n = Le.has(e) ? Le.get(e) : {}, r = e.parentNode || e.ownerDocument; if ("string" === typeof t ? t = { type: t, target: e } : t.target || (t.target = e), t = xe(t), n.dispatcher && n.dispatcher.call(e, t, i), r && !t.isPropagationStopped() && !0 === t.bubbles) Be.call(null, r, t, i); else if (!r && !t.defaultPrevented && t.target && t.target[t.type]) { Le.has(t.target) || Le.set(t.target, {}); var a = Le.get(t.target); t.target[t.type] && (a.disabled = !0, "function" === typeof t.target[t.type] && t.target[t.type](), a.disabled = !1) } return !t.defaultPrevented } function Ue(e, t, i) { if (Array.isArray(t)) return Ie(Ue, e, t, i); var n = function n() { Re(e, t, n), i.apply(this, arguments) }; n.guid = i.guid = i.guid || Pe(), Me(e, t, n) } function je(e, t, i) { var n = function n() { Re(e, t, n), i.apply(this, arguments) }; n.guid = i.guid = i.guid || Pe(), Me(e, t, n) } var Ne, Fe = Object.freeze({ fixEvent: xe, on: Me, off: Re, trigger: Be, one: Ue, any: je }), He = 30, qe = function (e, t, i) { t.guid || (t.guid = Pe()); var n = t.bind(e); return n.guid = i ? i + "_" + t.guid : t.guid, n }, Ve = function (e, t) { var i = r.a.performance.now(); return function () { var n = r.a.performance.now(); n - i >= t && (e.apply(void 0, arguments), i = n) } }, We = function (e, t, i, n) { var a; void 0 === n && (n = r.a); var s = function () { var r = this, s = arguments, o = function () { a = null, o = null, i || e.apply(r, s) }; !a && i && e.apply(r, s), n.clearTimeout(a), a = n.setTimeout(o, t) }; return s.cancel = function () { n.clearTimeout(a), a = null }, s }, ze = function () { }; ze.prototype.allowedEvents_ = {}, ze.prototype.on = function (e, t) { var i = this.addEventListener; this.addEventListener = function () { }, Me(this, e, t), this.addEventListener = i }, ze.prototype.addEventListener = ze.prototype.on, ze.prototype.off = function (e, t) { Re(this, e, t) }, ze.prototype.removeEventListener = ze.prototype.off, ze.prototype.one = function (e, t) { var i = this.addEventListener; this.addEventListener = function () { }, Ue(this, e, t), this.addEventListener = i }, ze.prototype.any = function (e, t) { var i = this.addEventListener; this.addEventListener = function () { }, je(this, e, t), this.addEventListener = i }, ze.prototype.trigger = function (e) { var t = e.type || e; "string" === typeof e && (e = { type: t }), e = xe(e), this.allowedEvents_[t] && this["on" + t] && this["on" + t](e), Be(this, e) }, ze.prototype.dispatchEvent = ze.prototype.trigger, ze.prototype.queueTrigger = function (e) { var t = this; Ne || (Ne = new Map); var i = e.type || e, n = Ne.get(this); n || (n = new Map, Ne.set(this, n)); var a = n.get(i); n.delete(i), r.a.clearTimeout(a); var s = r.a.setTimeout((function () { 0 === n.size && (n = null, Ne.delete(t)), t.trigger(e) }), 0); n.set(i, s) }; var Ge = function (e) { return e instanceof ze || !!e.eventBusEl_ && ["on", "one", "off", "trigger"].every((function (t) { return "function" === typeof e[t] })) }, Ke = function (e) { return "string" === typeof e && /\S/.test(e) || Array.isArray(e) && !!e.length }, Ye = function (e) { if (!e.nodeName && !Ge(e)) throw new Error("Invalid target; must be a DOM node or evented object.") }, Xe = function (e) { if (!Ke(e)) throw new Error("Invalid event type; must be a non-empty string or array.") }, $e = function (e) { if ("function" !== typeof e) throw new Error("Invalid listener; must be a function.") }, Qe = function (e, t) { var i, n, r, a = t.length < 3 || t[0] === e || t[0] === e.eventBusEl_; return a ? (i = e.eventBusEl_, t.length >= 3 && t.shift(), n = t[0], r = t[1]) : (i = t[0], n = t[1], r = t[2]), Ye(i), Xe(n), $e(r), { isTargetingSelf: a, target: i, type: n, listener: r = qe(e, r) } }, Je = function (e, t, i, n) { Ye(e), e.nodeName ? Fe[t](e, i, n) : e[t](i, n) }, Ze = { on: function () { for (var e = this, t = arguments.length, i = new Array(t), n = 0; n < t; n++)i[n] = arguments[n]; var r = Qe(this, i), a = r.isTargetingSelf, s = r.target, o = r.type, l = r.listener; if (Je(s, "on", o, l), !a) { var u = function () { return e.off(s, o, l) }; u.guid = l.guid; var c = function () { return e.off("dispose", u) }; c.guid = l.guid, Je(this, "on", "dispose", u), Je(s, "on", "dispose", c) } }, one: function () { for (var e = this, t = arguments.length, i = new Array(t), n = 0; n < t; n++)i[n] = arguments[n]; var r = Qe(this, i), a = r.isTargetingSelf, s = r.target, o = r.type, l = r.listener; if (a) Je(s, "one", o, l); else { var u = function t() { e.off(s, o, t); for (var i = arguments.length, n = new Array(i), r = 0; r < i; r++)n[r] = arguments[r]; l.apply(null, n) }; u.guid = l.guid, Je(s, "one", o, u) } }, any: function () { for (var e = this, t = arguments.length, i = new Array(t), n = 0; n < t; n++)i[n] = arguments[n]; var r = Qe(this, i), a = r.isTargetingSelf, s = r.target, o = r.type, l = r.listener; if (a) Je(s, "any", o, l); else { var u = function t() { e.off(s, o, t); for (var i = arguments.length, n = new Array(i), r = 0; r < i; r++)n[r] = arguments[r]; l.apply(null, n) }; u.guid = l.guid, Je(s, "any", o, u) } }, off: function (e, t, i) { if (!e || Ke(e)) Re(this.eventBusEl_, e, t); else { var n = e, r = t; Ye(n), Xe(r), $e(i), i = qe(this, i), this.off("dispose", i), n.nodeName ? (Re(n, r, i), Re(n, "dispose", i)) : Ge(n) && (n.off(r, i), n.off("dispose", i)) } }, trigger: function (e, t) { return Be(this.eventBusEl_, e, t) } }; function et(e, t) { void 0 === t && (t = {}); var i = t.eventBusKey; if (i) { if (!e[i].nodeName) throw new Error('The eventBusKey "' + i + '" does not refer to an element.'); e.eventBusEl_ = e[i] } else e.eventBusEl_ = G("span", { className: "vjs-event-bus" }); return B(e, Ze), e.eventedCallbacks && e.eventedCallbacks.forEach((function (e) { e() })), e.on("dispose", (function () { e.off(), r.a.setTimeout((function () { e.eventBusEl_ = null }), 0) })), e } var tt = { state: {}, setState: function (e) { var t, i = this; return "function" === typeof e && (e = e()), R(e, (function (e, n) { i.state[n] !== e && ((t = t || {})[n] = { from: i.state[n], to: e }), i.state[n] = e })), t && Ge(this) && this.trigger({ changes: t, type: "statechanged" }), t } }; function it(e, t) { return B(e, tt), e.state = B({}, e.state, t), "function" === typeof e.handleStateChanged && Ge(e) && e.on("statechanged", e.handleStateChanged), e } var nt = function (e) { return "string" !== typeof e ? e : e.replace(/./, (function (e) { return e.toLowerCase() })) }, rt = function (e) { return "string" !== typeof e ? e : e.replace(/./, (function (e) { return e.toUpperCase() })) }; function at() { for (var e = {}, t = arguments.length, i = new Array(t), n = 0; n < t; n++)i[n] = arguments[n]; return i.forEach((function (t) { t && R(t, (function (t, i) { j(t) ? (j(e[i]) || (e[i] = {}), e[i] = at(e[i], t)) : e[i] = t })) })), e } var st = function () { function e(e, t, i) { if (!e && this.play ? this.player_ = e = this : this.player_ = e, this.parentComponent_ = null, this.options_ = at({}, this.options_), t = this.options_ = at(this.options_, t), this.id_ = t.id || t.el && t.el.id, !this.id_) { var n = e && e.id && e.id() || "no_player"; this.id_ = n + "_component_" + Pe() } var a; this.name_ = t.name || null, t.el ? this.el_ = t.el : !1 !== t.createEl && (this.el_ = this.createEl()), !1 !== t.evented && et(this, { eventBusKey: this.el_ ? "el_" : null }), it(this, this.constructor.defaultState), this.children_ = [], this.childIndex_ = {}, this.childNameIndex_ = {}, r.a.Set || (a = function () { function e() { this.set_ = {} } var t = e.prototype; return t.has = function (e) { return e in this.set_ }, t.delete = function (e) { var t = this.has(e); return delete this.set_[e], t }, t.add = function (e) { return this.set_[e] = 1, this }, t.forEach = function (e, t) { for (var i in this.set_) e.call(t, i, i, this) }, e }()), this.setTimeoutIds_ = r.a.Set ? new Set : new a, this.setIntervalIds_ = r.a.Set ? new Set : new a, this.rafIds_ = r.a.Set ? new Set : new a, this.clearingTimersOnDispose_ = !1, !1 !== t.initChildren && this.initChildren(), this.ready(i), !1 !== t.reportTouchActivity && this.enableTouchActivity() } var t = e.prototype; return t.dispose = function () { if (this.trigger({ type: "dispose", bubbles: !1 }), this.children_) for (var e = this.children_.length - 1; e >= 0; e--)this.children_[e].dispose && this.children_[e].dispose(); this.children_ = null, this.childIndex_ = null, this.childNameIndex_ = null, this.parentComponent_ = null, this.el_ && (this.el_.parentNode && this.el_.parentNode.removeChild(this.el_), Le.has(this.el_) && Le.delete(this.el_), this.el_ = null), this.player_ = null }, t.player = function () { return this.player_ }, t.options = function (e) { return e ? (this.options_ = at(this.options_, e), this.options_) : this.options_ }, t.el = function () { return this.el_ }, t.createEl = function (e, t, i) { return G(e, t, i) }, t.localize = function (e, t, i) { void 0 === i && (i = e); var n = this.player_.language && this.player_.language(), r = this.player_.languages && this.player_.languages(), a = r && r[n], s = n && n.split("-")[0], o = r && r[s], l = i; return a && a[e] ? l = a[e] : o && o[e] && (l = o[e]), t && (l = l.replace(/\{(\d+)\}/g, (function (e, i) { var n = t[i - 1], r = n; return "undefined" === typeof n && (r = e), r }))), l }, t.contentEl = function () { return this.contentEl_ || this.el_ }, t.id = function () { return this.id_ }, t.name = function () { return this.name_ }, t.children = function () { return this.children_ }, t.getChildById = function (e) { return this.childIndex_[e] }, t.getChild = function (e) { if (e) return this.childNameIndex_[e] }, t.addChild = function (t, i, n) { var r, a; if (void 0 === i && (i = {}), void 0 === n && (n = this.children_.length), "string" === typeof t) { a = rt(t); var s = i.componentClass || a; i.name = a; var o = e.getComponent(s); if (!o) throw new Error("Component " + s + " does not exist"); if ("function" !== typeof o) return null; r = new o(this.player_ || this, i) } else r = t; if (r.parentComponent_ && r.parentComponent_.removeChild(r), this.children_.splice(n, 0, r), r.parentComponent_ = this, "function" === typeof r.id && (this.childIndex_[r.id()] = r), (a = a || r.name && rt(r.name())) && (this.childNameIndex_[a] = r, this.childNameIndex_[nt(a)] = r), "function" === typeof r.el && r.el()) { var l = this.contentEl().children[n] || null; this.contentEl().insertBefore(r.el(), l) } return r }, t.removeChild = function (e) { if ("string" === typeof e && (e = this.getChild(e)), e && this.children_) { for (var t = !1, i = this.children_.length - 1; i >= 0; i--)if (this.children_[i] === e) { t = !0, this.children_.splice(i, 1); break } if (t) { e.parentComponent_ = null, this.childIndex_[e.id()] = null, this.childNameIndex_[rt(e.name())] = null, this.childNameIndex_[nt(e.name())] = null; var n = e.el(); n && n.parentNode === this.contentEl() && this.contentEl().removeChild(e.el()) } } }, t.initChildren = function () { var t = this, i = this.options_.children; if (i) { var n, r = this.options_, a = e.getComponent("Tech"); (n = Array.isArray(i) ? i : Object.keys(i)).concat(Object.keys(this.options_).filter((function (e) { return !n.some((function (t) { return "string" === typeof t ? e === t : e === t.name })) }))).map((function (e) { var n, r; return "string" === typeof e ? r = i[n = e] || t.options_[n] || {} : (n = e.name, r = e), { name: n, opts: r } })).filter((function (t) { var i = e.getComponent(t.opts.componentClass || rt(t.name)); return i && !a.isTech(i) })).forEach((function (e) { var i = e.name, n = e.opts; if (void 0 !== r[i] && (n = r[i]), !1 !== n) { !0 === n && (n = {}), n.playerOptions = t.options_.playerOptions; var a = t.addChild(i, n); a && (t[i] = a) } })) } }, t.buildCSSClass = function () { return "" }, t.ready = function (e, t) { if (void 0 === t && (t = !1), e) return this.isReady_ ? void (t ? e.call(this) : this.setTimeout(e, 1)) : (this.readyQueue_ = this.readyQueue_ || [], void this.readyQueue_.push(e)) }, t.triggerReady = function () { this.isReady_ = !0, this.setTimeout((function () { var e = this.readyQueue_; this.readyQueue_ = [], e && e.length > 0 && e.forEach((function (e) { e.call(this) }), this), this.trigger("ready") }), 1) }, t.$ = function (e, t) { return ge(e, t || this.contentEl()) }, t.$$ = function (e, t) { return ve(e, t || this.contentEl()) }, t.hasClass = function (e) { return X(this.el_, e) }, t.addClass = function (e) { $(this.el_, e) }, t.removeClass = function (e) { Q(this.el_, e) }, t.toggleClass = function (e, t) { J(this.el_, e, t) }, t.show = function () { this.removeClass("vjs-hidden") }, t.hide = function () { this.addClass("vjs-hidden") }, t.lockShowing = function () { this.addClass("vjs-lock-showing") }, t.unlockShowing = function () { this.removeClass("vjs-lock-showing") }, t.getAttribute = function (e) { return te(this.el_, e) }, t.setAttribute = function (e, t) { ie(this.el_, e, t) }, t.removeAttribute = function (e) { ne(this.el_, e) }, t.width = function (e, t) { return this.dimension("width", e, t) }, t.height = function (e, t) { return this.dimension("height", e, t) }, t.dimensions = function (e, t) { this.width(e, !0), this.height(t) }, t.dimension = function (e, t, i) { if (void 0 !== t) return null !== t && t === t || (t = 0), -1 !== ("" + t).indexOf("%") || -1 !== ("" + t).indexOf("px") ? this.el_.style[e] = t : this.el_.style[e] = "auto" === t ? "" : t + "px", void (i || this.trigger("componentresize")); if (!this.el_) return 0; var n = this.el_.style[e], r = n.indexOf("px"); return -1 !== r ? parseInt(n.slice(0, r), 10) : parseInt(this.el_["offset" + rt(e)], 10) }, t.currentDimension = function (e) { var t = 0; if ("width" !== e && "height" !== e) throw new Error("currentDimension only accepts width or height value"); if (t = N(this.el_, e), 0 === (t = parseFloat(t)) || isNaN(t)) { var i = "offset" + rt(e); t = this.el_[i] } return t }, t.currentDimensions = function () { return { width: this.currentDimension("width"), height: this.currentDimension("height") } }, t.currentWidth = function () { return this.currentDimension("width") }, t.currentHeight = function () { return this.currentDimension("height") }, t.focus = function () { this.el_.focus() }, t.blur = function () { this.el_.blur() }, t.handleKeyDown = function (e) { this.player_ && (e.stopPropagation(), this.player_.handleKeyDown(e)) }, t.handleKeyPress = function (e) { this.handleKeyDown(e) }, t.emitTapEvents = function () { var e, t = 0, i = null; this.on("touchstart", (function (n) { 1 === n.touches.length && (i = { pageX: n.touches[0].pageX, pageY: n.touches[0].pageY }, t = r.a.performance.now(), e = !0) })), this.on("touchmove", (function (t) { if (t.touches.length > 1) e = !1; else if (i) { var n = t.touches[0].pageX - i.pageX, r = t.touches[0].pageY - i.pageY; Math.sqrt(n * n + r * r) > 10 && (e = !1) } })); var n = function () { e = !1 }; this.on("touchleave", n), this.on("touchcancel", n), this.on("touchend", (function (n) { (i = null, !0 === e) && (r.a.performance.now() - t < 200 && (n.preventDefault(), this.trigger("tap"))) })) }, t.enableTouchActivity = function () { if (this.player() && this.player().reportUserActivity) { var e, t = qe(this.player(), this.player().reportUserActivity); this.on("touchstart", (function () { t(), this.clearInterval(e), e = this.setInterval(t, 250) })); var i = function (i) { t(), this.clearInterval(e) }; this.on("touchmove", t), this.on("touchend", i), this.on("touchcancel", i) } }, t.setTimeout = function (e, t) { var i, n = this; return e = qe(this, e), this.clearTimersOnDispose_(), i = r.a.setTimeout((function () { n.setTimeoutIds_.has(i) && n.setTimeoutIds_.delete(i), e() }), t), this.setTimeoutIds_.add(i), i }, t.clearTimeout = function (e) { return this.setTimeoutIds_.has(e) && (this.setTimeoutIds_.delete(e), r.a.clearTimeout(e)), e }, t.setInterval = function (e, t) { e = qe(this, e), this.clearTimersOnDispose_(); var i = r.a.setInterval(e, t); return this.setIntervalIds_.add(i), i }, t.clearInterval = function (e) { return this.setIntervalIds_.has(e) && (this.setIntervalIds_.delete(e), r.a.clearInterval(e)), e }, t.requestAnimationFrame = function (e) { var t, i = this; return this.supportsRaf_ ? (this.clearTimersOnDispose_(), e = qe(this, e), t = r.a.requestAnimationFrame((function () { i.rafIds_.has(t) && i.rafIds_.delete(t), e() })), this.rafIds_.add(t), t) : this.setTimeout(e, 1e3 / 60) }, t.cancelAnimationFrame = function (e) { return this.supportsRaf_ ? (this.rafIds_.has(e) && (this.rafIds_.delete(e), r.a.cancelAnimationFrame(e)), e) : this.clearTimeout(e) }, t.clearTimersOnDispose_ = function () { var e = this; this.clearingTimersOnDispose_ || (this.clearingTimersOnDispose_ = !0, this.one("dispose", (function () { [["rafIds_", "cancelAnimationFrame"], ["setTimeoutIds_", "clearTimeout"], ["setIntervalIds_", "clearInterval"]].forEach((function (t) { var i = t[0], n = t[1]; e[i].forEach(e[n], e) })), e.clearingTimersOnDispose_ = !1 }))) }, e.registerComponent = function (t, i) { if ("string" !== typeof t || !t) throw new Error('Illegal component name, "' + t + '"; must be a non-empty string.'); var n, r = e.getComponent("Tech"), a = r && r.isTech(i), s = e === i || e.prototype.isPrototypeOf(i.prototype); if (a || !s) throw n = a ? "techs must be registered using Tech.registerTech()" : "must be a Component subclass", new Error('Illegal component, "' + t + '"; ' + n + "."); t = rt(t), e.components_ || (e.components_ = {}); var o = e.getComponent("Player"); if ("Player" === t && o && o.players) { var l = o.players, u = Object.keys(l); if (l && u.length > 0 && u.map((function (e) { return l[e] })).every(Boolean)) throw new Error("Can not register Player component after player has been created.") } return e.components_[t] = i, e.components_[nt(t)] = i, i }, e.getComponent = function (t) { if (t && e.components_) return e.components_[t] }, e }(); function ot(e, t) { e.prototype = Object.create(t.prototype), e.prototype.constructor = e, e.__proto__ = t } function lt(e, t) { return (lt = Object.setPrototypeOf || function (e, t) { return e.__proto__ = t, e })(e, t) } function ut(e, t, i) { return (ut = function () { if ("undefined" === typeof Reflect || !Reflect.construct) return !1; if (Reflect.construct.sham) return !1; if ("function" === typeof Proxy) return !0; try { return Date.prototype.toString.call(Reflect.construct(Date, [], (function () { }))), !0 } catch (e) { return !1 } }() ? Reflect.construct : function (e, t, i) { var n = [null]; n.push.apply(n, t); var r = new (Function.bind.apply(e, n)); return i && lt(r, i.prototype), r }).apply(null, arguments) } function ct(e) { if (void 0 === e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return e } st.prototype.supportsRaf_ = "function" === typeof r.a.requestAnimationFrame && "function" === typeof r.a.cancelAnimationFrame, st.registerComponent("Component", st); var ht = r.a.navigator && r.a.navigator.userAgent || "", dt = /AppleWebKit\/([\d.]+)/i.exec(ht), pt = dt ? parseFloat(dt.pop()) : null, ft = /iPad/i.test(ht), mt = /iPhone/i.test(ht) && !ft, gt = /iPod/i.test(ht), vt = mt || ft || gt, yt = function () { var e = ht.match(/OS (\d+)_/i); return e && e[1] ? e[1] : null }(), _t = /Android/i.test(ht), bt = function () { var e = ht.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i); if (!e) return null; var t = e[1] && parseFloat(e[1]), i = e[2] && parseFloat(e[2]); return t && i ? parseFloat(e[1] + "." + e[2]) : t || null }(), Tt = _t && bt < 5 && pt < 537, kt = /Firefox/i.test(ht), St = /Edge/i.test(ht), Ct = !St && (/Chrome/i.test(ht) || /CriOS/i.test(ht)), Et = function () { var e = ht.match(/(Chrome|CriOS)\/(\d+)/); return e && e[2] ? parseFloat(e[2]) : null }(), wt = function () { var e = /MSIE\s(\d+)\.\d/.exec(ht), t = e && parseFloat(e[1]); return !t && /Trident\/7.0/i.test(ht) && /rv:11.0/.test(ht) && (t = 11), t }(), Pt = /Safari/i.test(ht) && !Ct && !_t && !St, Lt = (Pt || vt) && !Ct, At = /Windows/i.test(ht), It = q() && ("ontouchstart" in r.a || r.a.navigator.maxTouchPoints || r.a.DocumentTouch && r.a.document instanceof r.a.DocumentTouch), xt = Object.freeze({ IS_IPAD: ft, IS_IPHONE: mt, IS_IPOD: gt, IS_IOS: vt, IOS_VERSION: yt, IS_ANDROID: _t, ANDROID_VERSION: bt, IS_NATIVE_ANDROID: Tt, IS_FIREFOX: kt, IS_EDGE: St, IS_CHROME: Ct, CHROME_VERSION: Et, IE_VERSION: wt, IS_SAFARI: Pt, IS_ANY_SAFARI: Lt, IS_WINDOWS: At, TOUCH_ENABLED: It }); function Ot(e, t, i, n) { return function (e, t, i) { if ("number" !== typeof t || t < 0 || t > i) throw new Error("Failed to execute '" + e + "' on 'TimeRanges': The index provided (" + t + ") is non-numeric or out of bounds (0-" + i + ").") }(e, n, i.length - 1), i[n][t] } function Dt(e) { return void 0 === e || 0 === e.length ? { length: 0, start: function () { throw new Error("This TimeRanges object is empty") }, end: function () { throw new Error("This TimeRanges object is empty") } } : { length: e.length, start: Ot.bind(null, "start", 0, e), end: Ot.bind(null, "end", 1, e) } } function Mt(e, t) { return Array.isArray(e) ? Dt(e) : void 0 === e || void 0 === t ? Dt() : Dt([[e, t]]) } function Rt(e, t) { var i, n, r = 0; if (!t) return 0; e && e.length || (e = Mt(0, 0)); for (var a = 0; a < e.length; a++)i = e.start(a), (n = e.end(a)) > t && (n = t), r += n - i; return r / t } for (var Bt, Ut = { prefixed: !0 }, jt = [["requestFullscreen", "exitFullscreen", "fullscreenElement", "fullscreenEnabled", "fullscreenchange", "fullscreenerror", "fullscreen"], ["webkitRequestFullscreen", "webkitExitFullscreen", "webkitFullscreenElement", "webkitFullscreenEnabled", "webkitfullscreenchange", "webkitfullscreenerror", "-webkit-full-screen"], ["mozRequestFullScreen", "mozCancelFullScreen", "mozFullScreenElement", "mozFullScreenEnabled", "mozfullscreenchange", "mozfullscreenerror", "-moz-full-screen"], ["msRequestFullscreen", "msExitFullscreen", "msFullscreenElement", "msFullscreenEnabled", "MSFullscreenChange", "MSFullscreenError", "-ms-fullscreen"]], Nt = jt[0], Ft = 0; Ft < jt.length; Ft++)if (jt[Ft][1] in s.a) { Bt = jt[Ft]; break } if (Bt) { for (var Ht = 0; Ht < Bt.length; Ht++)Ut[Nt[Ht]] = Bt[Ht]; Ut.prefixed = Bt[0] !== Nt[0] } function qt(e) { if (e instanceof qt) return e; "number" === typeof e ? this.code = e : "string" === typeof e ? this.message = e : U(e) && ("number" === typeof e.code && (this.code = e.code), B(this, e)), this.message || (this.message = qt.defaultMessages[this.code] || "") } qt.prototype.code = 0, qt.prototype.message = "", qt.prototype.status = null, qt.errorTypes = ["MEDIA_ERR_CUSTOM", "MEDIA_ERR_ABORTED", "MEDIA_ERR_NETWORK", "MEDIA_ERR_DECODE", "MEDIA_ERR_SRC_NOT_SUPPORTED", "MEDIA_ERR_ENCRYPTED"], qt.defaultMessages = { 1: "You aborted the media playback", 2: "A network error caused the media download to fail part-way.", 3: "The media playback was aborted due to a corruption problem or because the media used features your browser did not support.", 4: "The media could not be loaded, either because the server or network failed or because the format is not supported.", 5: "The media is encrypted and we do not have the keys to decrypt it." }; for (var Vt = 0; Vt < qt.errorTypes.length; Vt++)qt[qt.errorTypes[Vt]] = Vt, qt.prototype[qt.errorTypes[Vt]] = Vt; function Wt(e) { return void 0 !== e && null !== e && "function" === typeof e.then } function zt(e) { Wt(e) && e.then(null, (function (e) { })) } var Gt = function (e) { return ["kind", "label", "language", "id", "inBandMetadataTrackDispatchType", "mode", "src"].reduce((function (t, i, n) { return e[i] && (t[i] = e[i]), t }), { cues: e.cues && Array.prototype.map.call(e.cues, (function (e) { return { startTime: e.startTime, endTime: e.endTime, text: e.text, id: e.id } })) }) }, Kt = function (e) { var t = e.$$("track"), i = Array.prototype.map.call(t, (function (e) { return e.track })); return Array.prototype.map.call(t, (function (e) { var t = Gt(e.track); return e.src && (t.src = e.src), t })).concat(Array.prototype.filter.call(e.textTracks(), (function (e) { return -1 === i.indexOf(e) })).map(Gt)) }, Yt = function (e, t) { return e.forEach((function (e) { var i = t.addRemoteTextTrack(e).track; !e.src && e.cues && e.cues.forEach((function (e) { return i.addCue(e) })) })), t.textTracks() }, Xt = "vjs-modal-dialog", $t = function (e) { function t(t, i) { var n; return (n = e.call(this, t, i) || this).opened_ = n.hasBeenOpened_ = n.hasBeenFilled_ = !1, n.closeable(!n.options_.uncloseable), n.content(n.options_.content), n.contentEl_ = G("div", { className: Xt + "-content" }, { role: "document" }), n.descEl_ = G("p", { className: Xt + "-description vjs-control-text", id: n.el().getAttribute("aria-describedby") }), K(n.descEl_, n.description()), n.el_.appendChild(n.descEl_), n.el_.appendChild(n.contentEl_), n } ot(t, e); var i = t.prototype; return i.createEl = function () { return e.prototype.createEl.call(this, "div", { className: this.buildCSSClass(), tabIndex: -1 }, { "aria-describedby": this.id() + "_description", "aria-hidden": "true", "aria-label": this.label(), role: "dialog" }) }, i.dispose = function () { this.contentEl_ = null, this.descEl_ = null, this.previouslyActiveEl_ = null, e.prototype.dispose.call(this) }, i.buildCSSClass = function () { return Xt + " vjs-hidden " + e.prototype.buildCSSClass.call(this) }, i.label = function () { return this.localize(this.options_.label || "Modal Window") }, i.description = function () { var e = this.options_.description || this.localize("This is a modal window."); return this.closeable() && (e += " " + this.localize("This modal can be closed by pressing the Escape key or activating the close button.")), e }, i.open = function () { if (!this.opened_) { var e = this.player(); this.trigger("beforemodalopen"), this.opened_ = !0, (this.options_.fillAlways || !this.hasBeenOpened_ && !this.hasBeenFilled_) && this.fill(), this.wasPlaying_ = !e.paused(), this.options_.pauseOnOpen && this.wasPlaying_ && e.pause(), this.on("keydown", this.handleKeyDown), this.hadControls_ = e.controls(), e.controls(!1), this.show(), this.conditionalFocus_(), this.el().setAttribute("aria-hidden", "false"), this.trigger("modalopen"), this.hasBeenOpened_ = !0 } }, i.opened = function (e) { return "boolean" === typeof e && this[e ? "open" : "close"](), this.opened_ }, i.close = function () { if (this.opened_) { var e = this.player(); this.trigger("beforemodalclose"), this.opened_ = !1, this.wasPlaying_ && this.options_.pauseOnOpen && e.play(), this.off("keydown", this.handleKeyDown), this.hadControls_ && e.controls(!0), this.hide(), this.el().setAttribute("aria-hidden", "true"), this.trigger("modalclose"), this.conditionalBlur_(), this.options_.temporary && this.dispose() } }, i.closeable = function (e) { if ("boolean" === typeof e) { var t = this.closeable_ = !!e, i = this.getChild("closeButton"); if (t && !i) { var n = this.contentEl_; this.contentEl_ = this.el_, i = this.addChild("closeButton", { controlText: "Close Modal Dialog" }), this.contentEl_ = n, this.on(i, "close", this.close) } !t && i && (this.off(i, "close", this.close), this.removeChild(i), i.dispose()) } return this.closeable_ }, i.fill = function () { this.fillWith(this.content()) }, i.fillWith = function (e) { var t = this.contentEl(), i = t.parentNode, n = t.nextSibling; this.trigger("beforemodalfill"), this.hasBeenFilled_ = !0, i.removeChild(t), this.empty(), pe(t, e), this.trigger("modalfill"), n ? i.insertBefore(t, n) : i.appendChild(t); var r = this.getChild("closeButton"); r && i.appendChild(r.el_) }, i.empty = function () { this.trigger("beforemodalempty"), ce(this.contentEl()), this.trigger("modalempty") }, i.content = function (e) { return "undefined" !== typeof e && (this.content_ = e), this.content_ }, i.conditionalFocus_ = function () { var e = s.a.activeElement, t = this.player_.el_; this.previouslyActiveEl_ = null, (t.contains(e) || t === e) && (this.previouslyActiveEl_ = e, this.focus()) }, i.conditionalBlur_ = function () { this.previouslyActiveEl_ && (this.previouslyActiveEl_.focus(), this.previouslyActiveEl_ = null) }, i.handleKeyDown = function (e) { if (e.stopPropagation(), c.a.isEventKey(e, "Escape") && this.closeable()) return e.preventDefault(), void this.close(); if (c.a.isEventKey(e, "Tab")) { for (var t, i = this.focusableEls_(), n = this.el_.querySelector(":focus"), r = 0; r < i.length; r++)if (n === i[r]) { t = r; break } s.a.activeElement === this.el_ && (t = 0), e.shiftKey && 0 === t ? (i[i.length - 1].focus(), e.preventDefault()) : e.shiftKey || t !== i.length - 1 || (i[0].focus(), e.preventDefault()) } }, i.focusableEls_ = function () { var e = this.el_.querySelectorAll("*"); return Array.prototype.filter.call(e, (function (e) { return (e instanceof r.a.HTMLAnchorElement || e instanceof r.a.HTMLAreaElement) && e.hasAttribute("href") || (e instanceof r.a.HTMLInputElement || e instanceof r.a.HTMLSelectElement || e instanceof r.a.HTMLTextAreaElement || e instanceof r.a.HTMLButtonElement) && !e.hasAttribute("disabled") || e instanceof r.a.HTMLIFrameElement || e instanceof r.a.HTMLObjectElement || e instanceof r.a.HTMLEmbedElement || e.hasAttribute("tabindex") && -1 !== e.getAttribute("tabindex") || e.hasAttribute("contenteditable") })) }, t }(st); $t.prototype.options_ = { pauseOnOpen: !0, temporary: !0 }, st.registerComponent("ModalDialog", $t); var Qt = function (e) { function t(t) { var i; void 0 === t && (t = []), (i = e.call(this) || this).tracks_ = [], Object.defineProperty(ct(i), "length", { get: function () { return this.tracks_.length } }); for (var n = 0; n < t.length; n++)i.addTrack(t[n]); return i } ot(t, e); var i = t.prototype; return i.addTrack = function (e) { var t = this.tracks_.length; "" + t in this || Object.defineProperty(this, t, { get: function () { return this.tracks_[t] } }), -1 === this.tracks_.indexOf(e) && (this.tracks_.push(e), this.trigger({ track: e, type: "addtrack", target: this })) }, i.removeTrack = function (e) { for (var t, i = 0, n = this.length; i < n; i++)if (this[i] === e) { (t = this[i]).off && t.off(), this.tracks_.splice(i, 1); break } t && this.trigger({ track: t, type: "removetrack", target: this }) }, i.getTrackById = function (e) { for (var t = null, i = 0, n = this.length; i < n; i++) { var r = this[i]; if (r.id === e) { t = r; break } } return t }, t }(ze); for (var Jt in Qt.prototype.allowedEvents_ = { change: "change", addtrack: "addtrack", removetrack: "removetrack" }, Qt.prototype.allowedEvents_) Qt.prototype["on" + Jt] = null; var Zt = function (e, t) { for (var i = 0; i < e.length; i++)Object.keys(e[i]).length && t.id !== e[i].id && (e[i].enabled = !1) }, ei = function (e) { function t(t) { var i; void 0 === t && (t = []); for (var n = t.length - 1; n >= 0; n--)if (t[n].enabled) { Zt(t, t[n]); break } return (i = e.call(this, t) || this).changing_ = !1, i } ot(t, e); var i = t.prototype; return i.addTrack = function (t) { var i = this; t.enabled && Zt(this, t), e.prototype.addTrack.call(this, t), t.addEventListener && (t.enabledChange_ = function () { i.changing_ || (i.changing_ = !0, Zt(i, t), i.changing_ = !1, i.trigger("change")) }, t.addEventListener("enabledchange", t.enabledChange_)) }, i.removeTrack = function (t) { e.prototype.removeTrack.call(this, t), t.removeEventListener && t.enabledChange_ && (t.removeEventListener("enabledchange", t.enabledChange_), t.enabledChange_ = null) }, t }(Qt), ti = function (e, t) { for (var i = 0; i < e.length; i++)Object.keys(e[i]).length && t.id !== e[i].id && (e[i].selected = !1) }, ii = function (e) { function t(t) { var i; void 0 === t && (t = []); for (var n = t.length - 1; n >= 0; n--)if (t[n].selected) { ti(t, t[n]); break } return (i = e.call(this, t) || this).changing_ = !1, Object.defineProperty(ct(i), "selectedIndex", { get: function () { for (var e = 0; e < this.length; e++)if (this[e].selected) return e; return -1 }, set: function () { } }), i } ot(t, e); var i = t.prototype; return i.addTrack = function (t) { var i = this; t.selected && ti(this, t), e.prototype.addTrack.call(this, t), t.addEventListener && (t.selectedChange_ = function () { i.changing_ || (i.changing_ = !0, ti(i, t), i.changing_ = !1, i.trigger("change")) }, t.addEventListener("selectedchange", t.selectedChange_)) }, i.removeTrack = function (t) { e.prototype.removeTrack.call(this, t), t.removeEventListener && t.selectedChange_ && (t.removeEventListener("selectedchange", t.selectedChange_), t.selectedChange_ = null) }, t }(Qt), ni = function (e) { function t() { return e.apply(this, arguments) || this } ot(t, e); var i = t.prototype; return i.addTrack = function (t) { var i = this; e.prototype.addTrack.call(this, t), this.queueChange_ || (this.queueChange_ = function () { return i.queueTrigger("change") }), this.triggerSelectedlanguagechange || (this.triggerSelectedlanguagechange_ = function () { return i.trigger("selectedlanguagechange") }), t.addEventListener("modechange", this.queueChange_); -1 === ["metadata", "chapters"].indexOf(t.kind) && t.addEventListener("modechange", this.triggerSelectedlanguagechange_) }, i.removeTrack = function (t) { e.prototype.removeTrack.call(this, t), t.removeEventListener && (this.queueChange_ && t.removeEventListener("modechange", this.queueChange_), this.selectedlanguagechange_ && t.removeEventListener("modechange", this.triggerSelectedlanguagechange_)) }, t }(Qt), ri = function () { function e(e) { void 0 === e && (e = []), this.trackElements_ = [], Object.defineProperty(this, "length", { get: function () { return this.trackElements_.length } }); for (var t = 0, i = e.length; t < i; t++)this.addTrackElement_(e[t]) } var t = e.prototype; return t.addTrackElement_ = function (e) { var t = this.trackElements_.length; "" + t in this || Object.defineProperty(this, t, { get: function () { return this.trackElements_[t] } }), -1 === this.trackElements_.indexOf(e) && this.trackElements_.push(e) }, t.getTrackElementByTrack_ = function (e) { for (var t, i = 0, n = this.trackElements_.length; i < n; i++)if (e === this.trackElements_[i].track) { t = this.trackElements_[i]; break } return t }, t.removeTrackElement_ = function (e) { for (var t = 0, i = this.trackElements_.length; t < i; t++)if (e === this.trackElements_[t]) { this.trackElements_[t].track && "function" === typeof this.trackElements_[t].track.off && this.trackElements_[t].track.off(), "function" === typeof this.trackElements_[t].off && this.trackElements_[t].off(), this.trackElements_.splice(t, 1); break } }, e }(), ai = function () { function e(t) { e.prototype.setCues_.call(this, t), Object.defineProperty(this, "length", { get: function () { return this.length_ } }) } var t = e.prototype; return t.setCues_ = function (e) { var t = this.length || 0, i = 0, n = e.length; this.cues_ = e, this.length_ = e.length; var r = function (e) { "" + e in this || Object.defineProperty(this, "" + e, { get: function () { return this.cues_[e] } }) }; if (t < n) for (i = t; i < n; i++)r.call(this, i) }, t.getCueById = function (e) { for (var t = null, i = 0, n = this.length; i < n; i++) { var r = this[i]; if (r.id === e) { t = r; break } } return t }, e }(), si = { alternative: "alternative", captions: "captions", main: "main", sign: "sign", subtitles: "subtitles", commentary: "commentary" }, oi = { alternative: "alternative", descriptions: "descriptions", main: "main", "main-desc": "main-desc", translation: "translation", commentary: "commentary" }, li = { subtitles: "subtitles", captions: "captions", descriptions: "descriptions", chapters: "chapters", metadata: "metadata" }, ui = { disabled: "disabled", hidden: "hidden", showing: "showing" }, ci = function (e) { function t(t) { var i; void 0 === t && (t = {}), i = e.call(this) || this; var n = { id: t.id || "vjs_track_" + Pe(), kind: t.kind || "", label: t.label || "", language: t.language || "" }, r = function (e) { Object.defineProperty(ct(i), e, { get: function () { return n[e] }, set: function () { } }) }; for (var a in n) r(a); return i } return ot(t, e), t }(ze), hi = function (e) { var t = ["protocol", "hostname", "port", "pathname", "search", "hash", "host"], i = s.a.createElement("a"); i.href = e; var n, a = "" === i.host && "file:" !== i.protocol; a && ((n = s.a.createElement("div")).innerHTML = '<a href="' + e + '"></a>', i = n.firstChild, n.setAttribute("style", "display:none; position:absolute;"), s.a.body.appendChild(n)); for (var o = {}, l = 0; l < t.length; l++)o[t[l]] = i[t[l]]; return "http:" === o.protocol && (o.host = o.host.replace(/:80$/, "")), "https:" === o.protocol && (o.host = o.host.replace(/:443$/, "")), o.protocol || (o.protocol = r.a.location.protocol), a && s.a.body.removeChild(n), o }, di = function (e) { if (!e.match(/^https?:\/\//)) { var t = s.a.createElement("div"); t.innerHTML = '<a href="' + e + '">x</a>', e = t.firstChild.href } return e }, pi = function (e) { if ("string" === typeof e) { var t = /^(\/?)([\s\S]*?)((?:\.{1,2}|[^\/]+?)(\.([^\.\/\?]+)))(?:[\/]*|[\?].*)$/.exec(e); if (t) return t.pop().toLowerCase() } return "" }, fi = function (e) { var t = r.a.location, i = hi(e); return (":" === i.protocol ? t.protocol : i.protocol) + i.host !== t.protocol + t.host }, mi = Object.freeze({ parseUrl: hi, getAbsoluteURL: di, getFileExtension: pi, isCrossOrigin: fi }), gi = function (e, t) { var i = new r.a.WebVTT.Parser(r.a, r.a.vttjs, r.a.WebVTT.StringDecoder()), n = []; i.oncue = function (e) { t.addCue(e) }, i.onparsingerror = function (e) { n.push(e) }, i.onflush = function () { t.trigger({ type: "loadeddata", target: t }) }, i.parse(e), n.length > 0 && (r.a.console && r.a.console.groupCollapsed && r.a.console.groupCollapsed("Text Track parsing errors for " + t.src), n.forEach((function (e) { return x.error(e) })), r.a.console && r.a.console.groupEnd && r.a.console.groupEnd()), i.flush() }, vi = function (e, t) { var i = { uri: e }, n = fi(e); n && (i.cors = n), d()(i, qe(this, (function (e, i, n) { if (e) return x.error(e, i); t.loaded_ = !0, "function" !== typeof r.a.WebVTT ? t.tech_ && t.tech_.any(["vttjsloaded", "vttjserror"], (function (e) { if ("vttjserror" !== e.type) return gi(n, t); x.error("vttjs failed to load, stopping trying to process " + t.src) })) : gi(n, t) }))) }, yi = function (e) { function t(t) { var i; if (void 0 === t && (t = {}), !t.tech) throw new Error("A tech was not provided."); var n = at(t, { kind: li[t.kind] || "subtitles", language: t.language || t.srclang || "" }), r = ui[n.mode] || "disabled", a = n.default; "metadata" !== n.kind && "chapters" !== n.kind || (r = "hidden"), (i = e.call(this, n) || this).tech_ = n.tech, i.cues_ = [], i.activeCues_ = []; var s = new ai(i.cues_), o = new ai(i.activeCues_), l = !1, u = qe(ct(i), (function () { this.activeCues = this.activeCues, l && (this.trigger("cuechange"), l = !1) })); return "disabled" !== r && i.tech_.ready((function () { i.tech_.on("timeupdate", u) }), !0), Object.defineProperties(ct(i), { default: { get: function () { return a }, set: function () { } }, mode: { get: function () { return r }, set: function (e) { var t = this; ui[e] && ("disabled" !== (r = e) ? this.tech_.ready((function () { t.tech_.on("timeupdate", u) }), !0) : this.tech_.off("timeupdate", u), this.trigger("modechange")) } }, cues: { get: function () { return this.loaded_ ? s : null }, set: function () { } }, activeCues: { get: function () { if (!this.loaded_) return null; if (0 === this.cues.length) return o; for (var e = this.tech_.currentTime(), t = [], i = 0, n = this.cues.length; i < n; i++) { var r = this.cues[i]; r.startTime <= e && r.endTime >= e ? t.push(r) : r.startTime === r.endTime && r.startTime <= e && r.startTime + .5 >= e && t.push(r) } if (l = !1, t.length !== this.activeCues_.length) l = !0; else for (var a = 0; a < t.length; a++)-1 === this.activeCues_.indexOf(t[a]) && (l = !0); return this.activeCues_ = t, o.setCues_(this.activeCues_), o }, set: function () { } } }), n.src ? (i.src = n.src, vi(n.src, ct(i))) : i.loaded_ = !0, i } ot(t, e); var i = t.prototype; return i.addCue = function (e) { var t = e; if (r.a.vttjs && !(e instanceof r.a.vttjs.VTTCue)) { for (var i in t = new r.a.vttjs.VTTCue(e.startTime, e.endTime, e.text), e) i in t || (t[i] = e[i]); t.id = e.id, t.originalCue_ = e } for (var n = this.tech_.textTracks(), a = 0; a < n.length; a++)n[a] !== this && n[a].removeCue(t); this.cues_.push(t), this.cues.setCues_(this.cues_) }, i.removeCue = function (e) { for (var t = this.cues_.length; t--;) { var i = this.cues_[t]; if (i === e || i.originalCue_ && i.originalCue_ === e) { this.cues_.splice(t, 1), this.cues.setCues_(this.cues_); break } } }, t }(ci); yi.prototype.allowedEvents_ = { cuechange: "cuechange" }; var _i = function (e) { function t(t) { var i; void 0 === t && (t = {}); var n = at(t, { kind: oi[t.kind] || "" }); i = e.call(this, n) || this; var r = !1; return Object.defineProperty(ct(i), "enabled", { get: function () { return r }, set: function (e) { "boolean" === typeof e && e !== r && (r = e, this.trigger("enabledchange")) } }), n.enabled && (i.enabled = n.enabled), i.loaded_ = !0, i } return ot(t, e), t }(ci), bi = function (e) { function t(t) { var i; void 0 === t && (t = {}); var n = at(t, { kind: si[t.kind] || "" }); i = e.call(this, n) || this; var r = !1; return Object.defineProperty(ct(i), "selected", { get: function () { return r }, set: function (e) { "boolean" === typeof e && e !== r && (r = e, this.trigger("selectedchange")) } }), n.selected && (i.selected = n.selected), i } return ot(t, e), t }(ci), Ti = 0, ki = 2, Si = function (e) { function t(t) { var i, n; void 0 === t && (t = {}), i = e.call(this) || this; var r = new yi(t); return i.kind = r.kind, i.src = r.src, i.srclang = r.language, i.label = r.label, i.default = r.default, Object.defineProperties(ct(i), { readyState: { get: function () { return n } }, track: { get: function () { return r } } }), n = Ti, r.addEventListener("loadeddata", (function () { n = ki, i.trigger({ type: "load", target: ct(i) }) })), i } return ot(t, e), t }(ze); Si.prototype.allowedEvents_ = { load: "load" }, Si.NONE = Ti, Si.LOADING = 1, Si.LOADED = ki, Si.ERROR = 3; var Ci = { audio: { ListClass: ei, TrackClass: _i, capitalName: "Audio" }, video: { ListClass: ii, TrackClass: bi, capitalName: "Video" }, text: { ListClass: ni, TrackClass: yi, capitalName: "Text" } }; Object.keys(Ci).forEach((function (e) { Ci[e].getterName = e + "Tracks", Ci[e].privateName = e + "Tracks_" })); var Ei = { remoteText: { ListClass: ni, TrackClass: yi, capitalName: "RemoteText", getterName: "remoteTextTracks", privateName: "remoteTextTracks_" }, remoteTextEl: { ListClass: ri, TrackClass: Si, capitalName: "RemoteTextTrackEls", getterName: "remoteTextTrackEls", privateName: "remoteTextTrackEls_" } }, wi = at(Ci, Ei); Ei.names = Object.keys(Ei), Ci.names = Object.keys(Ci), wi.names = [].concat(Ei.names).concat(Ci.names); var Pi = function (e) { function t(t, i) { var n; return void 0 === t && (t = {}), void 0 === i && (i = function () { }), t.reportTouchActivity = !1, (n = e.call(this, null, t, i) || this).hasStarted_ = !1, n.on("playing", (function () { this.hasStarted_ = !0 })), n.on("loadstart", (function () { this.hasStarted_ = !1 })), wi.names.forEach((function (e) { var i = wi[e]; t && t[i.getterName] && (n[i.privateName] = t[i.getterName]) })), n.featuresProgressEvents || n.manualProgressOn(), n.featuresTimeupdateEvents || n.manualTimeUpdatesOn(), ["Text", "Audio", "Video"].forEach((function (e) { !1 === t["native" + e + "Tracks"] && (n["featuresNative" + e + "Tracks"] = !1) })), !1 === t.nativeCaptions || !1 === t.nativeTextTracks ? n.featuresNativeTextTracks = !1 : !0 !== t.nativeCaptions && !0 !== t.nativeTextTracks || (n.featuresNativeTextTracks = !0), n.featuresNativeTextTracks || n.emulateTextTracks(), n.autoRemoteTextTracks_ = new wi.text.ListClass, n.initTrackListeners(), t.nativeControlsForTouch || n.emitTapEvents(), n.constructor && (n.name_ = n.constructor.name || "Unknown Tech"), n } ot(t, e); var i = t.prototype; return i.triggerSourceset = function (e) { var t = this; this.isReady_ || this.one("ready", (function () { return t.setTimeout((function () { return t.triggerSourceset(e) }), 1) })), this.trigger({ src: e, type: "sourceset" }) }, i.manualProgressOn = function () { this.on("durationchange", this.onDurationChange), this.manualProgress = !0, this.one("ready", this.trackProgress) }, i.manualProgressOff = function () { this.manualProgress = !1, this.stopTrackingProgress(), this.off("durationchange", this.onDurationChange) }, i.trackProgress = function (e) { this.stopTrackingProgress(), this.progressInterval = this.setInterval(qe(this, (function () { var e = this.bufferedPercent(); this.bufferedPercent_ !== e && this.trigger("progress"), this.bufferedPercent_ = e, 1 === e && this.stopTrackingProgress() })), 500) }, i.onDurationChange = function (e) { this.duration_ = this.duration() }, i.buffered = function () { return Mt(0, 0) }, i.bufferedPercent = function () { return Rt(this.buffered(), this.duration_) }, i.stopTrackingProgress = function () { this.clearInterval(this.progressInterval) }, i.manualTimeUpdatesOn = function () { this.manualTimeUpdates = !0, this.on("play", this.trackCurrentTime), this.on("pause", this.stopTrackingCurrentTime) }, i.manualTimeUpdatesOff = function () { this.manualTimeUpdates = !1, this.stopTrackingCurrentTime(), this.off("play", this.trackCurrentTime), this.off("pause", this.stopTrackingCurrentTime) }, i.trackCurrentTime = function () { this.currentTimeInterval && this.stopTrackingCurrentTime(), this.currentTimeInterval = this.setInterval((function () { this.trigger({ type: "timeupdate", target: this, manuallyTriggered: !0 }) }), 250) }, i.stopTrackingCurrentTime = function () { this.clearInterval(this.currentTimeInterval), this.trigger({ type: "timeupdate", target: this, manuallyTriggered: !0 }) }, i.dispose = function () { this.clearTracks(Ci.names), this.manualProgress && this.manualProgressOff(), this.manualTimeUpdates && this.manualTimeUpdatesOff(), e.prototype.dispose.call(this) }, i.clearTracks = function (e) { var t = this; (e = [].concat(e)).forEach((function (e) { for (var i = t[e + "Tracks"]() || [], n = i.length; n--;) { var r = i[n]; "text" === e && t.removeRemoteTextTrack(r), i.removeTrack(r) } })) }, i.cleanupAutoTextTracks = function () { for (var e = this.autoRemoteTextTracks_ || [], t = e.length; t--;) { var i = e[t]; this.removeRemoteTextTrack(i) } }, i.reset = function () { }, i.error = function (e) { return void 0 !== e && (this.error_ = new qt(e), this.trigger("error")), this.error_ }, i.played = function () { return this.hasStarted_ ? Mt(0, 0) : Mt() }, i.setCurrentTime = function () { this.manualTimeUpdates && this.trigger({ type: "timeupdate", target: this, manuallyTriggered: !0 }) }, i.initTrackListeners = function () { var e = this; Ci.names.forEach((function (t) { var i = Ci[t], n = function () { e.trigger(t + "trackchange") }, r = e[i.getterName](); r.addEventListener("removetrack", n), r.addEventListener("addtrack", n), e.on("dispose", (function () { r.removeEventListener("removetrack", n), r.removeEventListener("addtrack", n) })) })) }, i.addWebVttScript_ = function () { var e = this; if (!r.a.WebVTT) if (s.a.body.contains(this.el())) { if (!this.options_["vtt.js"] && j(f.a) && Object.keys(f.a).length > 0) return void this.trigger("vttjsloaded"); var t = s.a.createElement("script"); t.src = this.options_["vtt.js"] || "https://vjs.zencdn.net/vttjs/0.14.1/vtt.min.js", t.onload = function () { e.trigger("vttjsloaded") }, t.onerror = function () { e.trigger("vttjserror") }, this.on("dispose", (function () { t.onload = null, t.onerror = null })), r.a.WebVTT = !0, this.el().parentNode.appendChild(t) } else this.ready(this.addWebVttScript_) }, i.emulateTextTracks = function () { var e = this, t = this.textTracks(), i = this.remoteTextTracks(), n = function (e) { return t.addTrack(e.track) }, r = function (e) { return t.removeTrack(e.track) }; i.on("addtrack", n), i.on("removetrack", r), this.addWebVttScript_(); var a = function () { return e.trigger("texttrackchange") }, s = function () { a(); for (var e = 0; e < t.length; e++) { var i = t[e]; i.removeEventListener("cuechange", a), "showing" === i.mode && i.addEventListener("cuechange", a) } }; s(), t.addEventListener("change", s), t.addEventListener("addtrack", s), t.addEventListener("removetrack", s), this.on("dispose", (function () { i.off("addtrack", n), i.off("removetrack", r), t.removeEventListener("change", s), t.removeEventListener("addtrack", s), t.removeEventListener("removetrack", s); for (var e = 0; e < t.length; e++) { t[e].removeEventListener("cuechange", a) } })) }, i.addTextTrack = function (e, t, i) { if (!e) throw new Error("TextTrack kind is required but was not provided"); return function (e, t, i, n, r) { void 0 === r && (r = {}); var a = e.textTracks(); r.kind = t, i && (r.label = i), n && (r.language = n), r.tech = e; var s = new wi.text.TrackClass(r); return a.addTrack(s), s }(this, e, t, i) }, i.createRemoteTextTrack = function (e) { var t = at(e, { tech: this }); return new Ei.remoteTextEl.TrackClass(t) }, i.addRemoteTextTrack = function (e, t) { var i = this; void 0 === e && (e = {}); var n = this.createRemoteTextTrack(e); return !0 !== t && !1 !== t && (x.warn('Calling addRemoteTextTrack without explicitly setting the "manualCleanup" parameter to `true` is deprecated and default to `false` in future version of video.js'), t = !0), this.remoteTextTrackEls().addTrackElement_(n), this.remoteTextTracks().addTrack(n.track), !0 !== t && this.ready((function () { return i.autoRemoteTextTracks_.addTrack(n.track) })), n }, i.removeRemoteTextTrack = function (e) { var t = this.remoteTextTrackEls().getTrackElementByTrack_(e); this.remoteTextTrackEls().removeTrackElement_(t), this.remoteTextTracks().removeTrack(e), this.autoRemoteTextTracks_.removeTrack(e) }, i.getVideoPlaybackQuality = function () { return {} }, i.requestPictureInPicture = function () { var e = this.options_.Promise || r.a.Promise; if (e) return e.reject() }, i.setPoster = function () { }, i.playsinline = function () { }, i.setPlaysinline = function () { }, i.overrideNativeAudioTracks = function () { }, i.overrideNativeVideoTracks = function () { }, i.canPlayType = function () { return "" }, t.canPlayType = function () { return "" }, t.canPlaySource = function (e, i) { return t.canPlayType(e.type) }, t.isTech = function (e) { return e.prototype instanceof t || e instanceof t || e === t }, t.registerTech = function (e, i) { if (t.techs_ || (t.techs_ = {}), !t.isTech(i)) throw new Error("Tech " + e + " must be a Tech"); if (!t.canPlayType) throw new Error("Techs must have a static canPlayType method on them"); if (!t.canPlaySource) throw new Error("Techs must have a static canPlaySource method on them"); return e = rt(e), t.techs_[e] = i, t.techs_[nt(e)] = i, "Tech" !== e && t.defaultTechOrder_.push(e), i }, t.getTech = function (e) { if (e) return t.techs_ && t.techs_[e] ? t.techs_[e] : (e = rt(e), r.a && r.a.videojs && r.a.videojs[e] ? (x.warn("The " + e + " tech was added to the videojs object when it should be registered using videojs.registerTech(name, tech)"), r.a.videojs[e]) : void 0) }, t }(st); wi.names.forEach((function (e) { var t = wi[e]; Pi.prototype[t.getterName] = function () { return this[t.privateName] = this[t.privateName] || new t.ListClass, this[t.privateName] } })), Pi.prototype.featuresVolumeControl = !0, Pi.prototype.featuresMuteControl = !0, Pi.prototype.featuresFullscreenResize = !1, Pi.prototype.featuresPlaybackRate = !1, Pi.prototype.featuresProgressEvents = !1, Pi.prototype.featuresSourceset = !1, Pi.prototype.featuresTimeupdateEvents = !1, Pi.prototype.featuresNativeTextTracks = !1, Pi.withSourceHandlers = function (e) { e.registerSourceHandler = function (t, i) { var n = e.sourceHandlers; n || (n = e.sourceHandlers = []), void 0 === i && (i = n.length), n.splice(i, 0, t) }, e.canPlayType = function (t) { for (var i, n = e.sourceHandlers || [], r = 0; r < n.length; r++)if (i = n[r].canPlayType(t)) return i; return "" }, e.selectSourceHandler = function (t, i) { for (var n = e.sourceHandlers || [], r = 0; r < n.length; r++)if (n[r].canHandleSource(t, i)) return n[r]; return null }, e.canPlaySource = function (t, i) { var n = e.selectSourceHandler(t, i); return n ? n.canHandleSource(t, i) : "" };["seekable", "seeking", "duration"].forEach((function (e) { var t = this[e]; "function" === typeof t && (this[e] = function () { return this.sourceHandler_ && this.sourceHandler_[e] ? this.sourceHandler_[e].apply(this.sourceHandler_, arguments) : t.apply(this, arguments) }) }), e.prototype), e.prototype.setSource = function (t) { var i = e.selectSourceHandler(t, this.options_); i || (e.nativeSourceHandler ? i = e.nativeSourceHandler : x.error("No source handler found for the current source.")), this.disposeSourceHandler(), this.off("dispose", this.disposeSourceHandler), i !== e.nativeSourceHandler && (this.currentSource_ = t), this.sourceHandler_ = i.handleSource(t, this, this.options_), this.one("dispose", this.disposeSourceHandler) }, e.prototype.disposeSourceHandler = function () { this.currentSource_ && (this.clearTracks(["audio", "video"]), this.currentSource_ = null), this.cleanupAutoTextTracks(), this.sourceHandler_ && (this.sourceHandler_.dispose && this.sourceHandler_.dispose(), this.sourceHandler_ = null) } }, st.registerComponent("Tech", Pi), Pi.registerTech("Tech", Pi), Pi.defaultTechOrder_ = []; var Li = {}, Ai = {}, Ii = {}; function xi(e, t, i) { e.setTimeout((function () { return function e(t, i, n, r, a, s) { void 0 === t && (t = {}); void 0 === i && (i = []); void 0 === a && (a = []); void 0 === s && (s = !1); var o = i, l = o[0], u = o.slice(1); if ("string" === typeof l) e(t, Li[l], n, r, a, s); else if (l) { var c = function (e, t) { var i = Ai[e.id()], n = null; if (void 0 === i || null === i) return n = t(e), Ai[e.id()] = [[t, n]], n; for (var r = 0; r < i.length; r++) { var a = i[r], s = a[0], o = a[1]; s === t && (n = o) } null === n && (n = t(e), i.push([t, n])); return n }(r, l); if (!c.setSource) return a.push(c), e(t, u, n, r, a, s); c.setSource(B({}, t), (function (i, o) { if (i) return e(t, u, n, r, a, s); a.push(c), e(o, t.type === o.type ? u : Li[o.type], n, r, a, s) })) } else u.length ? e(t, u, n, r, a, s) : s ? n(t, a) : e(t, Li["*"], n, r, a, !0) }(t, Li[t.type], i, e) }), 1) } function Oi(e, t, i, n) { void 0 === n && (n = null); var r = "call" + rt(i), a = e.reduce(Bi(r), n), s = a === Ii, o = s ? null : t[i](a); return function (e, t, i, n) { for (var r = e.length - 1; r >= 0; r--) { var a = e[r]; a[t] && a[t](n, i) } }(e, i, o, s), o } var Di = { buffered: 1, currentTime: 1, duration: 1, seekable: 1, played: 1, paused: 1, volume: 1 }, Mi = { setCurrentTime: 1, setVolume: 1 }, Ri = { play: 1, pause: 1 }; function Bi(e) { return function (t, i) { return t === Ii ? Ii : i[e] ? i[e](t) : t } } var Ui = { opus: "video/ogg", ogv: "video/ogg", mp4: "video/mp4", mov: "video/mp4", m4v: "video/mp4", mkv: "video/x-matroska", m4a: "audio/mp4", mp3: "audio/mpeg", aac: "audio/aac", oga: "audio/ogg", m3u8: "application/x-mpegURL", jpg: "image/jpeg", jpeg: "image/jpeg", gif: "image/gif", png: "image/png", svg: "image/svg+xml", webp: "image/webp" }, ji = function (e) { void 0 === e && (e = ""); var t = pi(e); return Ui[t.toLowerCase()] || "" }; function Ni(e) { if (!e.type) { var t = ji(e.src); t && (e.type = t) } return e } var Fi = function (e) { function t(t, i, n) { var r, a = at({ createEl: !1 }, i); if (r = e.call(this, t, a, n) || this, i.playerOptions.sources && 0 !== i.playerOptions.sources.length) t.src(i.playerOptions.sources); else for (var s = 0, o = i.playerOptions.techOrder; s < o.length; s++) { var l = rt(o[s]), u = Pi.getTech(l); if (l || (u = st.getComponent(l)), u && u.isSupported()) { t.loadTech_(l); break } } return r } return ot(t, e), t }(st); st.registerComponent("MediaLoader", Fi); var Hi = function (e) { function t(t, i) { var n; return (n = e.call(this, t, i) || this).emitTapEvents(), n.enable(), n } ot(t, e); var i = t.prototype; return i.createEl = function (t, i, n) { void 0 === t && (t = "div"), void 0 === i && (i = {}), void 0 === n && (n = {}), i = B({ innerHTML: '<span aria-hidden="true" class="vjs-icon-placeholder"></span>', className: this.buildCSSClass(), tabIndex: 0 }, i), "button" === t && x.error("Creating a ClickableComponent with an HTML element of " + t + " is not supported; use a Button instead."), n = B({ role: "button" }, n), this.tabIndex_ = i.tabIndex; var r = e.prototype.createEl.call(this, t, i, n); return this.createControlTextEl(r), r }, i.dispose = function () { this.controlTextEl_ = null, e.prototype.dispose.call(this) }, i.createControlTextEl = function (e) { return this.controlTextEl_ = G("span", { className: "vjs-control-text" }, { "aria-live": "polite" }), e && e.appendChild(this.controlTextEl_), this.controlText(this.controlText_, e), this.controlTextEl_ }, i.controlText = function (e, t) { if (void 0 === t && (t = this.el()), void 0 === e) return this.controlText_ || "Need Text"; var i = this.localize(e); this.controlText_ = e, K(this.controlTextEl_, i), this.nonIconControl || t.setAttribute("title", i) }, i.buildCSSClass = function () { return "vjs-control vjs-button " + e.prototype.buildCSSClass.call(this) }, i.enable = function () { this.enabled_ || (this.enabled_ = !0, this.removeClass("vjs-disabled"), this.el_.setAttribute("aria-disabled", "false"), "undefined" !== typeof this.tabIndex_ && this.el_.setAttribute("tabIndex", this.tabIndex_), this.on(["tap", "click"], this.handleClick), this.on("keydown", this.handleKeyDown)) }, i.disable = function () { this.enabled_ = !1, this.addClass("vjs-disabled"), this.el_.setAttribute("aria-disabled", "true"), "undefined" !== typeof this.tabIndex_ && this.el_.removeAttribute("tabIndex"), this.off("mouseover", this.handleMouseOver), this.off("mouseout", this.handleMouseOut), this.off(["tap", "click"], this.handleClick), this.off("keydown", this.handleKeyDown) }, i.handleClick = function (e) { }, i.handleKeyDown = function (t) { c.a.isEventKey(t, "Space") || c.a.isEventKey(t, "Enter") ? (t.preventDefault(), t.stopPropagation(), this.trigger("click")) : e.prototype.handleKeyDown.call(this, t) }, t }(st); st.registerComponent("ClickableComponent", Hi); var qi = function (e) { function t(t, i) { var n; return (n = e.call(this, t, i) || this).update(), t.on("posterchange", qe(ct(n), n.update)), n } ot(t, e); var i = t.prototype; return i.dispose = function () { this.player().off("posterchange", this.update), e.prototype.dispose.call(this) }, i.createEl = function () { return G("div", { className: "vjs-poster", tabIndex: -1 }) }, i.update = function (e) { var t = this.player().poster(); this.setSrc(t), t ? this.show() : this.hide() }, i.setSrc = function (e) { var t = ""; e && (t = 'url("' + e + '")'), this.el_.style.backgroundImage = t }, i.handleClick = function (e) { this.player_.controls() && (this.player_.tech(!0) && this.player_.tech(!0).focus(), this.player_.paused() ? zt(this.player_.play()) : this.player_.pause()) }, t }(Hi); st.registerComponent("PosterImage", qi); var Vi = { monospace: "monospace", sansSerif: "sans-serif", serif: "serif", monospaceSansSerif: '"Andale Mono", "Lucida Console", monospace', monospaceSerif: '"Courier New", monospace', proportionalSansSerif: "sans-serif", proportionalSerif: "serif", casual: '"Comic Sans MS", Impact, fantasy', script: '"Monotype Corsiva", cursive', smallcaps: '"Andale Mono", "Lucida Console", monospace, sans-serif' }; function Wi(e, t) { var i; if (4 === e.length) i = e[1] + e[1] + e[2] + e[2] + e[3] + e[3]; else { if (7 !== e.length) throw new Error("Invalid color code provided, " + e + "; must be formatted as e.g. #f0e or #f604e2."); i = e.slice(1) } return "rgba(" + parseInt(i.slice(0, 2), 16) + "," + parseInt(i.slice(2, 4), 16) + "," + parseInt(i.slice(4, 6), 16) + "," + t + ")" } function zi(e, t, i) { try { e.style[t] = i } catch (n) { return } } var Gi = function (e) { function t(t, i, n) { var a; a = e.call(this, t, i, n) || this; var s = qe(ct(a), a.updateDisplay); return t.on("loadstart", qe(ct(a), a.toggleDisplay)), t.on("texttrackchange", s), t.on("loadedmetadata", qe(ct(a), a.preselectTrack)), t.ready(qe(ct(a), (function () { if (t.tech_ && t.tech_.featuresNativeTextTracks) this.hide(); else { t.on("fullscreenchange", s), t.on("playerresize", s), r.a.addEventListener("orientationchange", s), t.on("dispose", (function () { return r.a.removeEventListener("orientationchange", s) })); for (var e = this.options_.playerOptions.tracks || [], i = 0; i < e.length; i++)this.player_.addRemoteTextTrack(e[i], !0); this.preselectTrack() } }))), a } ot(t, e); var i = t.prototype; return i.preselectTrack = function () { for (var e, t, i, n = { captions: 1, subtitles: 1 }, r = this.player_.textTracks(), a = this.player_.cache_.selectedLanguage, s = 0; s < r.length; s++) { var o = r[s]; a && a.enabled && a.language && a.language === o.language && o.kind in n ? o.kind === a.kind ? i = o : i || (i = o) : a && !a.enabled ? (i = null, e = null, t = null) : o.default && ("descriptions" !== o.kind || e ? o.kind in n && !t && (t = o) : e = o) } i ? i.mode = "showing" : t ? t.mode = "showing" : e && (e.mode = "showing") }, i.toggleDisplay = function () { this.player_.tech_ && this.player_.tech_.featuresNativeTextTracks ? this.hide() : this.show() }, i.createEl = function () { return e.prototype.createEl.call(this, "div", { className: "vjs-text-track-display" }, { "aria-live": "off", "aria-atomic": "true" }) }, i.clearDisplay = function () { "function" === typeof r.a.WebVTT && r.a.WebVTT.processCues(r.a, [], this.el_) }, i.updateDisplay = function () { var e = this.player_.textTracks(), t = this.options_.allowMultipleShowingTracks; if (this.clearDisplay(), t) { for (var i = [], n = 0; n < e.length; ++n) { var r = e[n]; "showing" === r.mode && i.push(r) } this.updateForTrack(i) } else { for (var a = null, s = null, o = e.length; o--;) { var l = e[o]; "showing" === l.mode && ("descriptions" === l.kind ? a = l : s = l) } s ? ("off" !== this.getAttribute("aria-live") && this.setAttribute("aria-live", "off"), this.updateForTrack(s)) : a && ("assertive" !== this.getAttribute("aria-live") && this.setAttribute("aria-live", "assertive"), this.updateForTrack(a)) } }, i.updateDisplayState = function (e) { for (var t = this.player_.textTrackSettings.getValues(), i = e.activeCues, n = i.length; n--;) { var a = i[n]; if (a) { var s = a.displayState; if (t.color && (s.firstChild.style.color = t.color), t.textOpacity && zi(s.firstChild, "color", Wi(t.color || "#fff", t.textOpacity)), t.backgroundColor && (s.firstChild.style.backgroundColor = t.backgroundColor), t.backgroundOpacity && zi(s.firstChild, "backgroundColor", Wi(t.backgroundColor || "#000", t.backgroundOpacity)), t.windowColor && (t.windowOpacity ? zi(s, "backgroundColor", Wi(t.windowColor, t.windowOpacity)) : s.style.backgroundColor = t.windowColor), t.edgeStyle && ("dropshadow" === t.edgeStyle ? s.firstChild.style.textShadow = "2px 2px 3px #222, 2px 2px 4px #222, 2px 2px 5px #222" : "raised" === t.edgeStyle ? s.firstChild.style.textShadow = "1px 1px #222, 2px 2px #222, 3px 3px #222" : "depressed" === t.edgeStyle ? s.firstChild.style.textShadow = "1px 1px #ccc, 0 1px #ccc, -1px -1px #222, 0 -1px #222" : "uniform" === t.edgeStyle && (s.firstChild.style.textShadow = "0 0 4px #222, 0 0 4px #222, 0 0 4px #222, 0 0 4px #222")), t.fontPercent && 1 !== t.fontPercent) { var o = r.a.parseFloat(s.style.fontSize); s.style.fontSize = o * t.fontPercent + "px", s.style.height = "auto", s.style.top = "auto", s.style.bottom = "2px" } t.fontFamily && "default" !== t.fontFamily && ("small-caps" === t.fontFamily ? s.firstChild.style.fontVariant = "small-caps" : s.firstChild.style.fontFamily = Vi[t.fontFamily]) } } }, i.updateForTrack = function (e) { if (Array.isArray(e) || (e = [e]), "function" === typeof r.a.WebVTT && !e.every((function (e) { return !e.activeCues }))) { for (var t = [], i = 0; i < e.length; ++i)for (var n = e[i], a = 0; a < n.activeCues.length; ++a)t.push(n.activeCues[a]); r.a.WebVTT.processCues(r.a, t, this.el_); for (var s = 0; s < e.length; ++s) { for (var o = e[s], l = 0; l < o.activeCues.length; ++l) { var u = o.activeCues[l].displayState; $(u, "vjs-text-track-cue"), $(u, "vjs-text-track-cue-" + (o.language ? o.language : s)) } this.player_.textTrackSettings && this.updateDisplayState(o) } } }, t }(st); st.registerComponent("TextTrackDisplay", Gi); var Ki = function (e) { function t() { return e.apply(this, arguments) || this } return ot(t, e), t.prototype.createEl = function () { var t = this.player_.isAudio(), i = this.localize(t ? "Audio Player" : "Video Player"), n = G("span", { className: "vjs-control-text", innerHTML: this.localize("{1} is loading.", [i]) }), r = e.prototype.createEl.call(this, "div", { className: "vjs-loading-spinner", dir: "ltr" }); return r.appendChild(n), r }, t }(st); st.registerComponent("LoadingSpinner", Ki); var Yi = function (e) { function t() { return e.apply(this, arguments) || this } ot(t, e); var i = t.prototype; return i.createEl = function (e, t, i) { void 0 === t && (t = {}), void 0 === i && (i = {}), t = B({ innerHTML: '<span aria-hidden="true" class="vjs-icon-placeholder"></span>', className: this.buildCSSClass() }, t), i = B({ type: "button" }, i); var n = st.prototype.createEl.call(this, "button", t, i); return this.createControlTextEl(n), n }, i.addChild = function (e, t) { void 0 === t && (t = {}); var i = this.constructor.name; return x.warn("Adding an actionable (user controllable) child to a Button (" + i + ") is not supported; use a ClickableComponent instead."), st.prototype.addChild.call(this, e, t) }, i.enable = function () { e.prototype.enable.call(this), this.el_.removeAttribute("disabled") }, i.disable = function () { e.prototype.disable.call(this), this.el_.setAttribute("disabled", "disabled") }, i.handleKeyDown = function (t) { c.a.isEventKey(t, "Space") || c.a.isEventKey(t, "Enter") ? t.stopPropagation() : e.prototype.handleKeyDown.call(this, t) }, t }(Hi); st.registerComponent("Button", Yi); var Xi = function (e) { function t(t, i) { var n; return (n = e.call(this, t, i) || this).mouseused_ = !1, n.on("mousedown", n.handleMouseDown), n } ot(t, e); var i = t.prototype; return i.buildCSSClass = function () { return "vjs-big-play-button" }, i.handleClick = function (e) { var t = this.player_.play(); if (this.mouseused_ && e.clientX && e.clientY) return zt(t), void (this.player_.tech(!0) && this.player_.tech(!0).focus()); var i = this.player_.getChild("controlBar"), n = i && i.getChild("playToggle"); if (n) { var r = function () { return n.focus() }; Wt(t) ? t.then(r, (function () { })) : this.setTimeout(r, 1) } else this.player_.tech(!0).focus() }, i.handleKeyDown = function (t) { this.mouseused_ = !1, e.prototype.handleKeyDown.call(this, t) }, i.handleMouseDown = function (e) { this.mouseused_ = !0 }, t }(Yi); Xi.prototype.controlText_ = "Play Video", st.registerComponent("BigPlayButton", Xi); var $i = function (e) { function t(t, i) { var n; return (n = e.call(this, t, i) || this).controlText(i && i.controlText || n.localize("Close")), n } ot(t, e); var i = t.prototype; return i.buildCSSClass = function () { return "vjs-close-button " + e.prototype.buildCSSClass.call(this) }, i.handleClick = function (e) { this.trigger({ type: "close", bubbles: !1 }) }, i.handleKeyDown = function (t) { c.a.isEventKey(t, "Esc") ? (t.preventDefault(), t.stopPropagation(), this.trigger("click")) : e.prototype.handleKeyDown.call(this, t) }, t }(Yi); st.registerComponent("CloseButton", $i); var Qi = function (e) { function t(t, i) { var n; return void 0 === i && (i = {}), n = e.call(this, t, i) || this, i.replay = void 0 === i.replay || i.replay, n.on(t, "play", n.handlePlay), n.on(t, "pause", n.handlePause), i.replay && n.on(t, "ended", n.handleEnded), n } ot(t, e); var i = t.prototype; return i.buildCSSClass = function () { return "vjs-play-control " + e.prototype.buildCSSClass.call(this) }, i.handleClick = function (e) { this.player_.paused() ? this.player_.play() : this.player_.pause() }, i.handleSeeked = function (e) { this.removeClass("vjs-ended"), this.player_.paused() ? this.handlePause(e) : this.handlePlay(e) }, i.handlePlay = function (e) { this.removeClass("vjs-ended"), this.removeClass("vjs-paused"), this.addClass("vjs-playing"), this.controlText("Pause") }, i.handlePause = function (e) { this.removeClass("vjs-playing"), this.addClass("vjs-paused"), this.controlText("Play") }, i.handleEnded = function (e) { this.removeClass("vjs-playing"), this.addClass("vjs-ended"), this.controlText("Replay"), this.one(this.player_, "seeked", this.handleSeeked) }, t }(Yi); Qi.prototype.controlText_ = "Play", st.registerComponent("PlayToggle", Qi); var Ji = function (e, t) { e = e < 0 ? 0 : e; var i = Math.floor(e % 60), n = Math.floor(e / 60 % 60), r = Math.floor(e / 3600), a = Math.floor(t / 60 % 60), s = Math.floor(t / 3600); return (isNaN(e) || e === 1 / 0) && (r = n = i = "-"), (r = r > 0 || s > 0 ? r + ":" : "") + (n = ((r || a >= 10) && n < 10 ? "0" + n : n) + ":") + (i = i < 10 ? "0" + i : i) }, Zi = Ji; function en(e, t) { return void 0 === t && (t = e), Zi(e, t) } var tn = function (e) { function t(t, i) { var n; return (n = e.call(this, t, i) || this).throttledUpdateContent = Ve(qe(ct(n), n.updateContent), He), n.on(t, "timeupdate", n.throttledUpdateContent), n } ot(t, e); var i = t.prototype; return i.createEl = function () { var t = this.buildCSSClass(), i = e.prototype.createEl.call(this, "div", { className: t + " vjs-time-control vjs-control", innerHTML: '<span class="vjs-control-text" role="presentation">' + this.localize(this.labelText_) + "\xa0</span>" }); return this.contentEl_ = G("span", { className: t + "-display" }, { "aria-live": "off", role: "presentation" }), this.updateTextNode_(), i.appendChild(this.contentEl_), i }, i.dispose = function () { this.contentEl_ = null, this.textNode_ = null, e.prototype.dispose.call(this) }, i.updateTextNode_ = function () { if (this.contentEl_) { for (; this.contentEl_.firstChild;)this.contentEl_.removeChild(this.contentEl_.firstChild); this.textNode_ = s.a.createTextNode(this.formattedTime_ || this.formatTime_(0)), this.contentEl_.appendChild(this.textNode_) } }, i.formatTime_ = function (e) { return en(e) }, i.updateFormattedTime_ = function (e) { var t = this.formatTime_(e); t !== this.formattedTime_ && (this.formattedTime_ = t, this.requestAnimationFrame(this.updateTextNode_)) }, i.updateContent = function (e) { }, t }(st); tn.prototype.labelText_ = "Time", tn.prototype.controlText_ = "Time", st.registerComponent("TimeDisplay", tn); var nn = function (e) { function t(t, i) { var n; return (n = e.call(this, t, i) || this).on(t, "ended", n.handleEnded), n } ot(t, e); var i = t.prototype; return i.buildCSSClass = function () { return "vjs-current-time" }, i.updateContent = function (e) { var t = this.player_.scrubbing() ? this.player_.getCache().currentTime : this.player_.currentTime(); this.updateFormattedTime_(t) }, i.handleEnded = function (e) { this.player_.duration() && this.updateFormattedTime_(this.player_.duration()) }, t }(tn); nn.prototype.labelText_ = "Current Time", nn.prototype.controlText_ = "Current Time", st.registerComponent("CurrentTimeDisplay", nn); var rn = function (e) { function t(t, i) { var n; return (n = e.call(this, t, i) || this).on(t, "durationchange", n.updateContent), n.on(t, "loadstart", n.updateContent), n.on(t, "loadedmetadata", n.throttledUpdateContent), n } ot(t, e); var i = t.prototype; return i.buildCSSClass = function () { return "vjs-duration" }, i.updateContent = function (e) { var t = this.player_.duration(); this.duration_ !== t && (this.duration_ = t, this.updateFormattedTime_(t)) }, t }(tn); rn.prototype.labelText_ = "Duration", rn.prototype.controlText_ = "Duration", st.registerComponent("DurationDisplay", rn); var an = function (e) { function t() { return e.apply(this, arguments) || this } return ot(t, e), t.prototype.createEl = function () { return e.prototype.createEl.call(this, "div", { className: "vjs-time-control vjs-time-divider", innerHTML: "<div><span>/</span></div>" }, { "aria-hidden": !0 }) }, t }(st); st.registerComponent("TimeDivider", an); var sn = function (e) { function t(t, i) { var n; return (n = e.call(this, t, i) || this).on(t, "durationchange", n.throttledUpdateContent), n.on(t, "ended", n.handleEnded), n } ot(t, e); var i = t.prototype; return i.buildCSSClass = function () { return "vjs-remaining-time" }, i.createEl = function () { var t = e.prototype.createEl.call(this); return t.insertBefore(G("span", {}, { "aria-hidden": !0 }, "-"), this.contentEl_), t }, i.updateContent = function (e) { "number" === typeof this.player_.duration() && (this.player_.remainingTimeDisplay ? this.updateFormattedTime_(this.player_.remainingTimeDisplay()) : this.updateFormattedTime_(this.player_.remainingTime())) }, i.handleEnded = function (e) { this.player_.duration() && this.updateFormattedTime_(0) }, t }(tn); sn.prototype.labelText_ = "Remaining Time", sn.prototype.controlText_ = "Remaining Time", st.registerComponent("RemainingTimeDisplay", sn); var on = function (e) { function t(t, i) { var n; return (n = e.call(this, t, i) || this).updateShowing(), n.on(n.player(), "durationchange", n.updateShowing), n } ot(t, e); var i = t.prototype; return i.createEl = function () { var t = e.prototype.createEl.call(this, "div", { className: "vjs-live-control vjs-control" }); return this.contentEl_ = G("div", { className: "vjs-live-display", innerHTML: '<span class="vjs-control-text">' + this.localize("Stream Type") + "\xa0</span>" + this.localize("LIVE") }, { "aria-live": "off" }), t.appendChild(this.contentEl_), t }, i.dispose = function () { this.contentEl_ = null, e.prototype.dispose.call(this) }, i.updateShowing = function (e) { this.player().duration() === 1 / 0 ? this.show() : this.hide() }, t }(st); st.registerComponent("LiveDisplay", on); var ln = function (e) { function t(t, i) { var n; return (n = e.call(this, t, i) || this).updateLiveEdgeStatus(), n.player_.liveTracker && n.on(n.player_.liveTracker, "liveedgechange", n.updateLiveEdgeStatus), n } ot(t, e); var i = t.prototype; return i.createEl = function () { var t = e.prototype.createEl.call(this, "button", { className: "vjs-seek-to-live-control vjs-control" }); return this.textEl_ = G("span", { className: "vjs-seek-to-live-text", innerHTML: this.localize("LIVE") }, { "aria-hidden": "true" }), t.appendChild(this.textEl_), t }, i.updateLiveEdgeStatus = function (e) { !this.player_.liveTracker || this.player_.liveTracker.atLiveEdge() ? (this.setAttribute("aria-disabled", !0), this.addClass("vjs-at-live-edge"), this.controlText("Seek to live, currently playing live")) : (this.setAttribute("aria-disabled", !1), this.removeClass("vjs-at-live-edge"), this.controlText("Seek to live, currently behind live")) }, i.handleClick = function () { this.player_.liveTracker.seekToLiveEdge() }, i.dispose = function () { this.player_.liveTracker && this.off(this.player_.liveTracker, "liveedgechange", this.updateLiveEdgeStatus), this.textEl_ = null, e.prototype.dispose.call(this) }, t }(Yi); ln.prototype.controlText_ = "Seek to live, currently playing live", st.registerComponent("SeekToLive", ln); var un = function (e) { function t(t, i) { var n; return (n = e.call(this, t, i) || this).bar = n.getChild(n.options_.barName), n.vertical(!!n.options_.vertical), n.enable(), n } ot(t, e); var i = t.prototype; return i.enabled = function () { return this.enabled_ }, i.enable = function () { this.enabled() || (this.on("mousedown", this.handleMouseDown), this.on("touchstart", this.handleMouseDown), this.on("keydown", this.handleKeyDown), this.on("click", this.handleClick), this.on(this.player_, "controlsvisible", this.update), this.playerEvent && this.on(this.player_, this.playerEvent, this.update), this.removeClass("disabled"), this.setAttribute("tabindex", 0), this.enabled_ = !0) }, i.disable = function () { if (this.enabled()) { var e = this.bar.el_.ownerDocument; this.off("mousedown", this.handleMouseDown), this.off("touchstart", this.handleMouseDown), this.off("keydown", this.handleKeyDown), this.off("click", this.handleClick), this.off(this.player_, "controlsvisible", this.update), this.off(e, "mousemove", this.handleMouseMove), this.off(e, "mouseup", this.handleMouseUp), this.off(e, "touchmove", this.handleMouseMove), this.off(e, "touchend", this.handleMouseUp), this.removeAttribute("tabindex"), this.addClass("disabled"), this.playerEvent && this.off(this.player_, this.playerEvent, this.update), this.enabled_ = !1 } }, i.createEl = function (t, i, n) { return void 0 === i && (i = {}), void 0 === n && (n = {}), i.className = i.className + " vjs-slider", i = B({ tabIndex: 0 }, i), n = B({ role: "slider", "aria-valuenow": 0, "aria-valuemin": 0, "aria-valuemax": 100, tabIndex: 0 }, n), e.prototype.createEl.call(this, t, i, n) }, i.handleMouseDown = function (e) { var t = this.bar.el_.ownerDocument; "mousedown" === e.type && e.preventDefault(), "touchstart" !== e.type || Ct || e.preventDefault(), re(), this.addClass("vjs-sliding"), this.trigger("slideractive"), this.on(t, "mousemove", this.handleMouseMove), this.on(t, "mouseup", this.handleMouseUp), this.on(t, "touchmove", this.handleMouseMove), this.on(t, "touchend", this.handleMouseUp), this.handleMouseMove(e) }, i.handleMouseMove = function (e) { }, i.handleMouseUp = function () { var e = this.bar.el_.ownerDocument; ae(), this.removeClass("vjs-sliding"), this.trigger("sliderinactive"), this.off(e, "mousemove", this.handleMouseMove), this.off(e, "mouseup", this.handleMouseUp), this.off(e, "touchmove", this.handleMouseMove), this.off(e, "touchend", this.handleMouseUp), this.update() }, i.update = function () { if (this.el_) { var e = this.getPercent(), t = this.bar; if (t) { ("number" !== typeof e || e !== e || e < 0 || e === 1 / 0) && (e = 0); var i = (100 * e).toFixed(2) + "%", n = t.el().style, r = this.vertical() ? "height" : "width"; return n[r] !== i && (n[r] = i), e } } }, i.calculateDistance = function (e) { var t = le(this.el_, e); return this.vertical() ? t.y : t.x }, i.handleKeyDown = function (t) { c.a.isEventKey(t, "Left") || c.a.isEventKey(t, "Down") ? (t.preventDefault(), t.stopPropagation(), this.stepBack()) : c.a.isEventKey(t, "Right") || c.a.isEventKey(t, "Up") ? (t.preventDefault(), t.stopPropagation(), this.stepForward()) : e.prototype.handleKeyDown.call(this, t) }, i.handleClick = function (e) { e.stopPropagation(), e.preventDefault() }, i.vertical = function (e) { if (void 0 === e) return this.vertical_ || !1; this.vertical_ = !!e, this.vertical_ ? this.addClass("vjs-slider-vertical") : this.addClass("vjs-slider-horizontal") }, t }(st); st.registerComponent("Slider", un); var cn = function (e) { function t(t, i) { var n; return (n = e.call(this, t, i) || this).partEls_ = [], n.on(t, "progress", n.update), n } ot(t, e); var i = t.prototype; return i.createEl = function () { return e.prototype.createEl.call(this, "div", { className: "vjs-load-progress", innerHTML: '<span class="vjs-control-text"><span>' + this.localize("Loaded") + '</span>: <span class="vjs-control-text-loaded-percentage">0%</span></span>' }) }, i.dispose = function () { this.partEls_ = null, e.prototype.dispose.call(this) }, i.update = function (e) { var t = this.player_.liveTracker, i = this.player_.buffered(), n = t && t.isLive() ? t.seekableEnd() : this.player_.duration(), r = this.player_.bufferedEnd(), a = this.partEls_, s = this.$(".vjs-control-text-loaded-percentage"), o = function (e, t, i) { var n = e / t || 0; return n = 100 * (n >= 1 ? 1 : n), i && (n = n.toFixed(2)), n + "%" }; this.el_.style.width = o(r, n), K(s, o(r, n, !0)); for (var l = 0; l < i.length; l++) { var u = i.start(l), c = i.end(l), h = a[l]; h || (h = this.el_.appendChild(G()), a[l] = h), h.style.left = o(u, r), h.style.width = o(c - u, r) } for (var d = a.length; d > i.length; d--)this.el_.removeChild(a[d - 1]); a.length = i.length }, t }(st); st.registerComponent("LoadProgressBar", cn); var hn = function (e) { function t(t, i) { var n; return (n = e.call(this, t, i) || this).update = Ve(qe(ct(n), n.update), He), n } ot(t, e); var i = t.prototype; return i.createEl = function () { return e.prototype.createEl.call(this, "div", { className: "vjs-time-tooltip" }, { "aria-hidden": "true" }) }, i.update = function (e, t, i) { var n = se(this.el_), r = se(this.player_.el()), a = e.width * t; if (r && n) { var s = e.left - r.left + a, o = e.width - a + (r.right - e.right), l = n.width / 2; s < l ? l += l - s : o < l && (l = o), l < 0 ? l = 0 : l > n.width && (l = n.width), this.el_.style.right = "-" + l + "px", this.write(i) } }, i.write = function (e) { K(this.el_, e) }, i.updateTime = function (e, t, i, n) { var r = this; this.rafId_ && this.cancelAnimationFrame(this.rafId_), this.rafId_ = this.requestAnimationFrame((function () { var a, s = r.player_.duration(); if (r.player_.liveTracker && r.player_.liveTracker.isLive()) { var o = r.player_.liveTracker.liveWindow(), l = o - t * o; a = (l < 1 ? "" : "-") + en(l, o) } else a = en(i, s); r.update(e, t, a), n && n() })) }, t }(st); st.registerComponent("TimeTooltip", hn); var dn = function (e) { function t(t, i) { var n; return (n = e.call(this, t, i) || this).update = Ve(qe(ct(n), n.update), He), n } ot(t, e); var i = t.prototype; return i.createEl = function () { return e.prototype.createEl.call(this, "div", { className: "vjs-play-progress vjs-slider-bar" }, { "aria-hidden": "true" }) }, i.update = function (e, t) { var i = this.getChild("timeTooltip"); if (i) { var n = this.player_.scrubbing() ? this.player_.getCache().currentTime : this.player_.currentTime(); i.updateTime(e, t, n) } }, t }(st); dn.prototype.options_ = { children: [] }, vt || _t || dn.prototype.options_.children.push("timeTooltip"), st.registerComponent("PlayProgressBar", dn); var pn = function (e) { function t(t, i) { var n; return (n = e.call(this, t, i) || this).update = Ve(qe(ct(n), n.update), He), n } ot(t, e); var i = t.prototype; return i.createEl = function () { return e.prototype.createEl.call(this, "div", { className: "vjs-mouse-display" }) }, i.update = function (e, t) { var i = this, n = t * this.player_.duration(); this.getChild("timeTooltip").updateTime(e, t, n, (function () { i.el_.style.left = e.width * t + "px" })) }, t }(st); pn.prototype.options_ = { children: ["timeTooltip"] }, st.registerComponent("MouseTimeDisplay", pn); var fn = function (e) { function t(t, i) { var n; return (n = e.call(this, t, i) || this).setEventHandlers_(), n } ot(t, e); var i = t.prototype; return i.setEventHandlers_ = function () { this.update = Ve(qe(this, this.update), 30), this.on(this.player_, "timeupdate", this.update), this.on(this.player_, "ended", this.handleEnded), this.on(this.player_, "durationchange", this.update), this.player_.liveTracker && this.on(this.player_.liveTracker, "liveedgechange", this.update), this.updateInterval = null, this.on(this.player_, ["playing"], this.enableInterval_), this.on(this.player_, ["ended", "pause", "waiting"], this.disableInterval_), "hidden" in s.a && "visibilityState" in s.a && this.on(s.a, "visibilitychange", this.toggleVisibility_) }, i.toggleVisibility_ = function (e) { s.a.hidden ? this.disableInterval_(e) : (this.enableInterval_(), this.requestAnimationFrame(this.update)) }, i.enableInterval_ = function () { var e = this; this.clearInterval(this.updateInterval), this.updateInterval = this.setInterval((function () { e.requestAnimationFrame(e.update) }), 30) }, i.disableInterval_ = function (e) { this.player_.liveTracker && this.player_.liveTracker.isLive() && "ended" !== e.type || this.clearInterval(this.updateInterval) }, i.createEl = function () { return e.prototype.createEl.call(this, "div", { className: "vjs-progress-holder" }, { "aria-label": this.localize("Progress Bar") }) }, i.update_ = function (e, t) { var i = this.player_.liveTracker, n = this.player_.duration(); i && i.isLive() && (n = this.player_.liveTracker.liveCurrentTime()), this.el_.setAttribute("aria-valuenow", (100 * t).toFixed(2)), this.el_.setAttribute("aria-valuetext", this.localize("progress bar timing: currentTime={1} duration={2}", [en(e, n), en(n, n)], "{1} of {2}")), this.bar && this.bar.update(se(this.el_), t) }, i.update = function (t) { if (null !== this.el().offsetParent) { var i = e.prototype.update.call(this); return this.update_(this.getCurrentTime_(), i), i } }, i.getCurrentTime_ = function () { return this.player_.scrubbing() ? this.player_.getCache().currentTime : this.player_.currentTime() }, i.handleEnded = function (e) { this.update_(this.player_.duration(), 1) }, i.getPercent = function () { var e, t = this.getCurrentTime_(), i = this.player_.liveTracker; return i && i.isLive() ? (e = (t - i.seekableStart()) / i.liveWindow(), i.atLiveEdge() && (e = 1)) : e = t / this.player_.duration(), e >= 1 ? 1 : e || 0 }, i.handleMouseDown = function (t) { fe(t) && (t.stopPropagation(), this.player_.scrubbing(!0), this.videoWasPlaying = !this.player_.paused(), this.player_.pause(), e.prototype.handleMouseDown.call(this, t)) }, i.handleMouseMove = function (e) { if (fe(e)) { var t, i = this.calculateDistance(e), n = this.player_.liveTracker; if (n && n.isLive()) { var r = n.seekableStart(), a = n.liveCurrentTime(); if ((t = r + i * n.liveWindow()) >= a && (t = a), t <= r && (t = r + .1), t === 1 / 0) return } else (t = i * this.player_.duration()) === this.player_.duration() && (t -= .1); this.player_.currentTime(t) } }, i.enable = function () { e.prototype.enable.call(this); var t = this.getChild("mouseTimeDisplay"); t && t.show() }, i.disable = function () { e.prototype.disable.call(this); var t = this.getChild("mouseTimeDisplay"); t && t.hide() }, i.handleMouseUp = function (t) { e.prototype.handleMouseUp.call(this, t), t && t.stopPropagation(), this.player_.scrubbing(!1), this.player_.trigger({ type: "timeupdate", target: this, manuallyTriggered: !0 }), this.videoWasPlaying && zt(this.player_.play()) }, i.stepForward = function () { this.player_.currentTime(this.player_.currentTime() + 5) }, i.stepBack = function () { this.player_.currentTime(this.player_.currentTime() - 5) }, i.handleAction = function (e) { this.player_.paused() ? this.player_.play() : this.player_.pause() }, i.handleKeyDown = function (t) { if (c.a.isEventKey(t, "Space") || c.a.isEventKey(t, "Enter")) t.preventDefault(), t.stopPropagation(), this.handleAction(t); else if (c.a.isEventKey(t, "Home")) t.preventDefault(), t.stopPropagation(), this.player_.currentTime(0); else if (c.a.isEventKey(t, "End")) t.preventDefault(), t.stopPropagation(), this.player_.currentTime(this.player_.duration()); else if (/^[0-9]$/.test(c()(t))) { t.preventDefault(), t.stopPropagation(); var i = 10 * (c.a.codes[c()(t)] - c.a.codes[0]) / 100; this.player_.currentTime(this.player_.duration() * i) } else c.a.isEventKey(t, "PgDn") ? (t.preventDefault(), t.stopPropagation(), this.player_.currentTime(this.player_.currentTime() - 60)) : c.a.isEventKey(t, "PgUp") ? (t.preventDefault(), t.stopPropagation(), this.player_.currentTime(this.player_.currentTime() + 60)) : e.prototype.handleKeyDown.call(this, t) }, t }(un); fn.prototype.options_ = { children: ["loadProgressBar", "playProgressBar"], barName: "playProgressBar" }, vt || _t || fn.prototype.options_.children.splice(1, 0, "mouseTimeDisplay"), st.registerComponent("SeekBar", fn); var mn = function (e) { function t(t, i) { var n; return (n = e.call(this, t, i) || this).handleMouseMove = Ve(qe(ct(n), n.handleMouseMove), He), n.throttledHandleMouseSeek = Ve(qe(ct(n), n.handleMouseSeek), He), n.enable(), n } ot(t, e); var i = t.prototype; return i.createEl = function () { return e.prototype.createEl.call(this, "div", { className: "vjs-progress-control vjs-control" }) }, i.handleMouseMove = function (e) { var t = this.getChild("seekBar"); if (t) { var i = t.getChild("mouseTimeDisplay"), n = t.el(), r = se(n), a = le(n, e).x; a > 1 ? a = 1 : a < 0 && (a = 0), i && i.update(r, a) } }, i.handleMouseSeek = function (e) { var t = this.getChild("seekBar"); t && t.handleMouseMove(e) }, i.enabled = function () { return this.enabled_ }, i.disable = function () { this.children().forEach((function (e) { return e.disable && e.disable() })), this.enabled() && (this.off(["mousedown", "touchstart"], this.handleMouseDown), this.off(this.el_, "mousemove", this.handleMouseMove), this.handleMouseUp(), this.addClass("disabled"), this.enabled_ = !1) }, i.enable = function () { this.children().forEach((function (e) { return e.enable && e.enable() })), this.enabled() || (this.on(["mousedown", "touchstart"], this.handleMouseDown), this.on(this.el_, "mousemove", this.handleMouseMove), this.removeClass("disabled"), this.enabled_ = !0) }, i.handleMouseDown = function (e) { var t = this.el_.ownerDocument, i = this.getChild("seekBar"); i && i.handleMouseDown(e), this.on(t, "mousemove", this.throttledHandleMouseSeek), this.on(t, "touchmove", this.throttledHandleMouseSeek), this.on(t, "mouseup", this.handleMouseUp), this.on(t, "touchend", this.handleMouseUp) }, i.handleMouseUp = function (e) { var t = this.el_.ownerDocument, i = this.getChild("seekBar"); i && i.handleMouseUp(e), this.off(t, "mousemove", this.throttledHandleMouseSeek), this.off(t, "touchmove", this.throttledHandleMouseSeek), this.off(t, "mouseup", this.handleMouseUp), this.off(t, "touchend", this.handleMouseUp) }, t }(st); mn.prototype.options_ = { children: ["seekBar"] }, st.registerComponent("ProgressControl", mn); var gn = function (e) { function t(t, i) { var n; return (n = e.call(this, t, i) || this).on(t, ["enterpictureinpicture", "leavepictureinpicture"], n.handlePictureInPictureChange), s.a.pictureInPictureEnabled || n.disable(), n } ot(t, e); var i = t.prototype; return i.buildCSSClass = function () { return "vjs-picture-in-picture-control " + e.prototype.buildCSSClass.call(this) }, i.handlePictureInPictureChange = function (e) { this.player_.isInPictureInPicture() ? this.controlText("Exit Picture-in-Picture") : this.controlText("Picture-in-Picture") }, i.handleClick = function (e) { this.player_.isInPictureInPicture() ? this.player_.exitPictureInPicture() : this.player_.requestPictureInPicture() }, t }(Yi); gn.prototype.controlText_ = "Picture-in-Picture", st.registerComponent("PictureInPictureToggle", gn); var vn = function (e) { function t(t, i) { var n; return (n = e.call(this, t, i) || this).on(t, "fullscreenchange", n.handleFullscreenChange), !1 === s.a[t.fsApi_.fullscreenEnabled] && n.disable(), n } ot(t, e); var i = t.prototype; return i.buildCSSClass = function () { return "vjs-fullscreen-control " + e.prototype.buildCSSClass.call(this) }, i.handleFullscreenChange = function (e) { this.player_.isFullscreen() ? this.controlText("Non-Fullscreen") : this.controlText("Fullscreen") }, i.handleClick = function (e) { this.player_.isFullscreen() ? this.player_.exitFullscreen() : this.player_.requestFullscreen() }, t }(Yi); vn.prototype.controlText_ = "Fullscreen", st.registerComponent("FullscreenToggle", vn); var yn = function (e, t) { t.tech_ && !t.tech_.featuresVolumeControl && e.addClass("vjs-hidden"), e.on(t, "loadstart", (function () { t.tech_.featuresVolumeControl ? e.removeClass("vjs-hidden") : e.addClass("vjs-hidden") })) }, _n = function (e) { function t() { return e.apply(this, arguments) || this } return ot(t, e), t.prototype.createEl = function () { return e.prototype.createEl.call(this, "div", { className: "vjs-volume-level", innerHTML: '<span class="vjs-control-text"></span>' }) }, t }(st); st.registerComponent("VolumeLevel", _n); var bn = function (e) { function t(t, i) { var n; return (n = e.call(this, t, i) || this).on("slideractive", n.updateLastVolume_), n.on(t, "volumechange", n.updateARIAAttributes), t.ready((function () { return n.updateARIAAttributes() })), n } ot(t, e); var i = t.prototype; return i.createEl = function () { return e.prototype.createEl.call(this, "div", { className: "vjs-volume-bar vjs-slider-bar" }, { "aria-label": this.localize("Volume Level"), "aria-live": "polite" }) }, i.handleMouseDown = function (t) { fe(t) && e.prototype.handleMouseDown.call(this, t) }, i.handleMouseMove = function (e) { fe(e) && (this.checkMuted(), this.player_.volume(this.calculateDistance(e))) }, i.checkMuted = function () { this.player_.muted() && this.player_.muted(!1) }, i.getPercent = function () { return this.player_.muted() ? 0 : this.player_.volume() }, i.stepForward = function () { this.checkMuted(), this.player_.volume(this.player_.volume() + .1) }, i.stepBack = function () { this.checkMuted(), this.player_.volume(this.player_.volume() - .1) }, i.updateARIAAttributes = function (e) { var t = this.player_.muted() ? 0 : this.volumeAsPercentage_(); this.el_.setAttribute("aria-valuenow", t), this.el_.setAttribute("aria-valuetext", t + "%") }, i.volumeAsPercentage_ = function () { return Math.round(100 * this.player_.volume()) }, i.updateLastVolume_ = function () { var e = this, t = this.player_.volume(); this.one("sliderinactive", (function () { 0 === e.player_.volume() && e.player_.lastVolume_(t) })) }, t }(un); bn.prototype.options_ = { children: ["volumeLevel"], barName: "volumeLevel" }, bn.prototype.playerEvent = "volumechange", st.registerComponent("VolumeBar", bn); var Tn = function (e) { function t(t, i) { var n; return void 0 === i && (i = {}), i.vertical = i.vertical || !1, ("undefined" === typeof i.volumeBar || j(i.volumeBar)) && (i.volumeBar = i.volumeBar || {}, i.volumeBar.vertical = i.vertical), n = e.call(this, t, i) || this, yn(ct(n), t), n.throttledHandleMouseMove = Ve(qe(ct(n), n.handleMouseMove), He), n.on("mousedown", n.handleMouseDown), n.on("touchstart", n.handleMouseDown), n.on(n.volumeBar, ["focus", "slideractive"], (function () { n.volumeBar.addClass("vjs-slider-active"), n.addClass("vjs-slider-active"), n.trigger("slideractive") })), n.on(n.volumeBar, ["blur", "sliderinactive"], (function () { n.volumeBar.removeClass("vjs-slider-active"), n.removeClass("vjs-slider-active"), n.trigger("sliderinactive") })), n } ot(t, e); var i = t.prototype; return i.createEl = function () { var t = "vjs-volume-horizontal"; return this.options_.vertical && (t = "vjs-volume-vertical"), e.prototype.createEl.call(this, "div", { className: "vjs-volume-control vjs-control " + t }) }, i.handleMouseDown = function (e) { var t = this.el_.ownerDocument; this.on(t, "mousemove", this.throttledHandleMouseMove), this.on(t, "touchmove", this.throttledHandleMouseMove), this.on(t, "mouseup", this.handleMouseUp), this.on(t, "touchend", this.handleMouseUp) }, i.handleMouseUp = function (e) { var t = this.el_.ownerDocument; this.off(t, "mousemove", this.throttledHandleMouseMove), this.off(t, "touchmove", this.throttledHandleMouseMove), this.off(t, "mouseup", this.handleMouseUp), this.off(t, "touchend", this.handleMouseUp) }, i.handleMouseMove = function (e) { this.volumeBar.handleMouseMove(e) }, t }(st); Tn.prototype.options_ = { children: ["volumeBar"] }, st.registerComponent("VolumeControl", Tn); var kn = function (e, t) { t.tech_ && !t.tech_.featuresMuteControl && e.addClass("vjs-hidden"), e.on(t, "loadstart", (function () { t.tech_.featuresMuteControl ? e.removeClass("vjs-hidden") : e.addClass("vjs-hidden") })) }, Sn = function (e) { function t(t, i) { var n; return n = e.call(this, t, i) || this, kn(ct(n), t), n.on(t, ["loadstart", "volumechange"], n.update), n } ot(t, e); var i = t.prototype; return i.buildCSSClass = function () { return "vjs-mute-control " + e.prototype.buildCSSClass.call(this) }, i.handleClick = function (e) { var t = this.player_.volume(), i = this.player_.lastVolume_(); if (0 === t) { var n = i < .1 ? .1 : i; this.player_.volume(n), this.player_.muted(!1) } else this.player_.muted(!this.player_.muted()) }, i.update = function (e) { this.updateIcon_(), this.updateControlText_() }, i.updateIcon_ = function () { var e = this.player_.volume(), t = 3; vt && this.player_.tech_ && this.player_.tech_.el_ && this.player_.muted(this.player_.tech_.el_.muted), 0 === e || this.player_.muted() ? t = 0 : e < .33 ? t = 1 : e < .67 && (t = 2); for (var i = 0; i < 4; i++)Q(this.el_, "vjs-vol-" + i); $(this.el_, "vjs-vol-" + t) }, i.updateControlText_ = function () { var e = this.player_.muted() || 0 === this.player_.volume() ? "Unmute" : "Mute"; this.controlText() !== e && this.controlText(e) }, t }(Yi); Sn.prototype.controlText_ = "Mute", st.registerComponent("MuteToggle", Sn); var Cn = function (e) { function t(t, i) { var n; return void 0 === i && (i = {}), "undefined" !== typeof i.inline ? i.inline = i.inline : i.inline = !0, ("undefined" === typeof i.volumeControl || j(i.volumeControl)) && (i.volumeControl = i.volumeControl || {}, i.volumeControl.vertical = !i.inline), (n = e.call(this, t, i) || this).on(t, ["loadstart"], n.volumePanelState_), n.on(n.muteToggle, "keyup", n.handleKeyPress), n.on(n.volumeControl, "keyup", n.handleVolumeControlKeyUp), n.on("keydown", n.handleKeyPress), n.on("mouseover", n.handleMouseOver), n.on("mouseout", n.handleMouseOut), n.on(n.volumeControl, ["slideractive"], n.sliderActive_), n.on(n.volumeControl, ["sliderinactive"], n.sliderInactive_), n } ot(t, e); var i = t.prototype; return i.sliderActive_ = function () { this.addClass("vjs-slider-active") }, i.sliderInactive_ = function () { this.removeClass("vjs-slider-active") }, i.volumePanelState_ = function () { this.volumeControl.hasClass("vjs-hidden") && this.muteToggle.hasClass("vjs-hidden") && this.addClass("vjs-hidden"), this.volumeControl.hasClass("vjs-hidden") && !this.muteToggle.hasClass("vjs-hidden") && this.addClass("vjs-mute-toggle-only") }, i.createEl = function () { var t = "vjs-volume-panel-horizontal"; return this.options_.inline || (t = "vjs-volume-panel-vertical"), e.prototype.createEl.call(this, "div", { className: "vjs-volume-panel vjs-control " + t }) }, i.dispose = function () { this.handleMouseOut(), e.prototype.dispose.call(this) }, i.handleVolumeControlKeyUp = function (e) { c.a.isEventKey(e, "Esc") && this.muteToggle.focus() }, i.handleMouseOver = function (e) { this.addClass("vjs-hover"), Me(s.a, "keyup", qe(this, this.handleKeyPress)) }, i.handleMouseOut = function (e) { this.removeClass("vjs-hover"), Re(s.a, "keyup", qe(this, this.handleKeyPress)) }, i.handleKeyPress = function (e) { c.a.isEventKey(e, "Esc") && this.handleMouseOut() }, t }(st); Cn.prototype.options_ = { children: ["muteToggle", "volumeControl"] }, st.registerComponent("VolumePanel", Cn); var En = function (e) { function t(t, i) { var n; return n = e.call(this, t, i) || this, i && (n.menuButton_ = i.menuButton), n.focusedChild_ = -1, n.on("keydown", n.handleKeyDown), n.boundHandleBlur_ = qe(ct(n), n.handleBlur), n.boundHandleTapClick_ = qe(ct(n), n.handleTapClick), n } ot(t, e); var i = t.prototype; return i.addEventListenerForItem = function (e) { e instanceof st && (this.on(e, "blur", this.boundHandleBlur_), this.on(e, ["tap", "click"], this.boundHandleTapClick_)) }, i.removeEventListenerForItem = function (e) { e instanceof st && (this.off(e, "blur", this.boundHandleBlur_), this.off(e, ["tap", "click"], this.boundHandleTapClick_)) }, i.removeChild = function (t) { "string" === typeof t && (t = this.getChild(t)), this.removeEventListenerForItem(t), e.prototype.removeChild.call(this, t) }, i.addItem = function (e) { var t = this.addChild(e); t && this.addEventListenerForItem(t) }, i.createEl = function () { var t = this.options_.contentElType || "ul"; this.contentEl_ = G(t, { className: "vjs-menu-content" }), this.contentEl_.setAttribute("role", "menu"); var i = e.prototype.createEl.call(this, "div", { append: this.contentEl_, className: "vjs-menu" }); return i.appendChild(this.contentEl_), Me(i, "click", (function (e) { e.preventDefault(), e.stopImmediatePropagation() })), i }, i.dispose = function () { this.contentEl_ = null, this.boundHandleBlur_ = null, this.boundHandleTapClick_ = null, e.prototype.dispose.call(this) }, i.handleBlur = function (e) { var t = e.relatedTarget || s.a.activeElement; if (!this.children().some((function (e) { return e.el() === t }))) { var i = this.menuButton_; i && i.buttonPressed_ && t !== i.el().firstChild && i.unpressButton() } }, i.handleTapClick = function (e) { if (this.menuButton_) { this.menuButton_.unpressButton(); var t = this.children(); if (!Array.isArray(t)) return; var i = t.filter((function (t) { return t.el() === e.target }))[0]; if (!i) return; "CaptionSettingsMenuItem" !== i.name() && this.menuButton_.focus() } }, i.handleKeyDown = function (e) { c.a.isEventKey(e, "Left") || c.a.isEventKey(e, "Down") ? (e.preventDefault(), e.stopPropagation(), this.stepForward()) : (c.a.isEventKey(e, "Right") || c.a.isEventKey(e, "Up")) && (e.preventDefault(), e.stopPropagation(), this.stepBack()) }, i.stepForward = function () { var e = 0; void 0 !== this.focusedChild_ && (e = this.focusedChild_ + 1), this.focus(e) }, i.stepBack = function () { var e = 0; void 0 !== this.focusedChild_ && (e = this.focusedChild_ - 1), this.focus(e) }, i.focus = function (e) { void 0 === e && (e = 0); var t = this.children().slice(); t.length && t[0].className && /vjs-menu-title/.test(t[0].className) && t.shift(), t.length > 0 && (e < 0 ? e = 0 : e >= t.length && (e = t.length - 1), this.focusedChild_ = e, t[e].el_.focus()) }, t }(st); st.registerComponent("Menu", En); var wn = function (e) { function t(t, i) { var n; void 0 === i && (i = {}), (n = e.call(this, t, i) || this).menuButton_ = new Yi(t, i), n.menuButton_.controlText(n.controlText_), n.menuButton_.el_.setAttribute("aria-haspopup", "true"); var r = Yi.prototype.buildCSSClass(); return n.menuButton_.el_.className = n.buildCSSClass() + " " + r, n.menuButton_.removeClass("vjs-control"), n.addChild(n.menuButton_), n.update(), n.enabled_ = !0, n.on(n.menuButton_, "tap", n.handleClick), n.on(n.menuButton_, "click", n.handleClick), n.on(n.menuButton_, "keydown", n.handleKeyDown), n.on(n.menuButton_, "mouseenter", (function () { n.addClass("vjs-hover"), n.menu.show(), Me(s.a, "keyup", qe(ct(n), n.handleMenuKeyUp)) })), n.on("mouseleave", n.handleMouseLeave), n.on("keydown", n.handleSubmenuKeyDown), n } ot(t, e); var i = t.prototype; return i.update = function () { var e = this.createMenu(); this.menu && (this.menu.dispose(), this.removeChild(this.menu)), this.menu = e, this.addChild(e), this.buttonPressed_ = !1, this.menuButton_.el_.setAttribute("aria-expanded", "false"), this.items && this.items.length <= this.hideThreshold_ ? this.hide() : this.show() }, i.createMenu = function () { var e = new En(this.player_, { menuButton: this }); if (this.hideThreshold_ = 0, this.options_.title) { var t = G("li", { className: "vjs-menu-title", innerHTML: rt(this.options_.title), tabIndex: -1 }); this.hideThreshold_ += 1; var i = new st(this.player_, { el: t }); e.addItem(i) } if (this.items = this.createItems(), this.items) for (var n = 0; n < this.items.length; n++)e.addItem(this.items[n]); return e }, i.createItems = function () { }, i.createEl = function () { return e.prototype.createEl.call(this, "div", { className: this.buildWrapperCSSClass() }, {}) }, i.buildWrapperCSSClass = function () { var t = "vjs-menu-button"; return !0 === this.options_.inline ? t += "-inline" : t += "-popup", "vjs-menu-button " + t + " " + Yi.prototype.buildCSSClass() + " " + e.prototype.buildCSSClass.call(this) }, i.buildCSSClass = function () { var t = "vjs-menu-button"; return !0 === this.options_.inline ? t += "-inline" : t += "-popup", "vjs-menu-button " + t + " " + e.prototype.buildCSSClass.call(this) }, i.controlText = function (e, t) { return void 0 === t && (t = this.menuButton_.el()), this.menuButton_.controlText(e, t) }, i.dispose = function () { this.handleMouseLeave(), e.prototype.dispose.call(this) }, i.handleClick = function (e) { this.buttonPressed_ ? this.unpressButton() : this.pressButton() }, i.handleMouseLeave = function (e) { this.removeClass("vjs-hover"), Re(s.a, "keyup", qe(this, this.handleMenuKeyUp)) }, i.focus = function () { this.menuButton_.focus() }, i.blur = function () { this.menuButton_.blur() }, i.handleKeyDown = function (e) { c.a.isEventKey(e, "Esc") || c.a.isEventKey(e, "Tab") ? (this.buttonPressed_ && this.unpressButton(), c.a.isEventKey(e, "Tab") || (e.preventDefault(), this.menuButton_.focus())) : (c.a.isEventKey(e, "Up") || c.a.isEventKey(e, "Down")) && (this.buttonPressed_ || (e.preventDefault(), this.pressButton())) }, i.handleMenuKeyUp = function (e) { (c.a.isEventKey(e, "Esc") || c.a.isEventKey(e, "Tab")) && this.removeClass("vjs-hover") }, i.handleSubmenuKeyPress = function (e) { this.handleSubmenuKeyDown(e) }, i.handleSubmenuKeyDown = function (e) { (c.a.isEventKey(e, "Esc") || c.a.isEventKey(e, "Tab")) && (this.buttonPressed_ && this.unpressButton(), c.a.isEventKey(e, "Tab") || (e.preventDefault(), this.menuButton_.focus())) }, i.pressButton = function () { if (this.enabled_) { if (this.buttonPressed_ = !0, this.menu.show(), this.menu.lockShowing(), this.menuButton_.el_.setAttribute("aria-expanded", "true"), vt && W()) return; this.menu.focus() } }, i.unpressButton = function () { this.enabled_ && (this.buttonPressed_ = !1, this.menu.unlockShowing(), this.menu.hide(), this.menuButton_.el_.setAttribute("aria-expanded", "false")) }, i.disable = function () { this.unpressButton(), this.enabled_ = !1, this.addClass("vjs-disabled"), this.menuButton_.disable() }, i.enable = function () { this.enabled_ = !0, this.removeClass("vjs-disabled"), this.menuButton_.enable() }, t }(st); st.registerComponent("MenuButton", wn); var Pn = function (e) { function t(t, i) { var n, r = i.tracks; if ((n = e.call(this, t, i) || this).items.length <= 1 && n.hide(), !r) return ct(n); var a = qe(ct(n), n.update); return r.addEventListener("removetrack", a), r.addEventListener("addtrack", a), n.player_.on("ready", a), n.player_.on("dispose", (function () { r.removeEventListener("removetrack", a), r.removeEventListener("addtrack", a) })), n } return ot(t, e), t }(wn); st.registerComponent("TrackButton", Pn); var Ln = ["Tab", "Esc", "Up", "Down", "Right", "Left"], An = function (e) { function t(t, i) { var n; return (n = e.call(this, t, i) || this).selectable = i.selectable, n.isSelected_ = i.selected || !1, n.multiSelectable = i.multiSelectable, n.selected(n.isSelected_), n.selectable ? n.multiSelectable ? n.el_.setAttribute("role", "menuitemcheckbox") : n.el_.setAttribute("role", "menuitemradio") : n.el_.setAttribute("role", "menuitem"), n } ot(t, e); var i = t.prototype; return i.createEl = function (t, i, n) { return this.nonIconControl = !0, e.prototype.createEl.call(this, "li", B({ className: "vjs-menu-item", innerHTML: '<span class="vjs-menu-item-text">' + this.localize(this.options_.label) + "</span>", tabIndex: -1 }, i), n) }, i.handleKeyDown = function (t) { Ln.some((function (e) { return c.a.isEventKey(t, e) })) || e.prototype.handleKeyDown.call(this, t) }, i.handleClick = function (e) { this.selected(!0) }, i.selected = function (e) { this.selectable && (e ? (this.addClass("vjs-selected"), this.el_.setAttribute("aria-checked", "true"), this.controlText(", selected"), this.isSelected_ = !0) : (this.removeClass("vjs-selected"), this.el_.setAttribute("aria-checked", "false"), this.controlText(""), this.isSelected_ = !1)) }, t }(Hi); st.registerComponent("MenuItem", An); var In = function (e) { function t(t, i) { var n, a = i.track, o = t.textTracks(); i.label = a.label || a.language || "Unknown", i.selected = "showing" === a.mode, (n = e.call(this, t, i) || this).track = a, n.kinds = (i.kinds || [i.kind || n.track.kind]).filter(Boolean); var l, u = function () { for (var e = arguments.length, t = new Array(e), i = 0; i < e; i++)t[i] = arguments[i]; n.handleTracksChange.apply(ct(n), t) }, c = function () { for (var e = arguments.length, t = new Array(e), i = 0; i < e; i++)t[i] = arguments[i]; n.handleSelectedLanguageChange.apply(ct(n), t) }; (t.on(["loadstart", "texttrackchange"], u), o.addEventListener("change", u), o.addEventListener("selectedlanguagechange", c), n.on("dispose", (function () { t.off(["loadstart", "texttrackchange"], u), o.removeEventListener("change", u), o.removeEventListener("selectedlanguagechange", c) })), void 0 === o.onchange) && n.on(["tap", "click"], (function () { if ("object" !== typeof r.a.Event) try { l = new r.a.Event("change") } catch (e) { } l || (l = s.a.createEvent("Event")).initEvent("change", !0, !0), o.dispatchEvent(l) })); return n.handleTracksChange(), n } ot(t, e); var i = t.prototype; return i.handleClick = function (t) { var i = this.track, n = this.player_.textTracks(); if (e.prototype.handleClick.call(this, t), n) for (var r = 0; r < n.length; r++) { var a = n[r]; -1 !== this.kinds.indexOf(a.kind) && (a === i ? "showing" !== a.mode && (a.mode = "showing") : "disabled" !== a.mode && (a.mode = "disabled")) } }, i.handleTracksChange = function (e) { var t = "showing" === this.track.mode; t !== this.isSelected_ && this.selected(t) }, i.handleSelectedLanguageChange = function (e) { if ("showing" === this.track.mode) { var t = this.player_.cache_.selectedLanguage; if (t && t.enabled && t.language === this.track.language && t.kind !== this.track.kind) return; this.player_.cache_.selectedLanguage = { enabled: !0, language: this.track.language, kind: this.track.kind } } }, i.dispose = function () { this.track = null, e.prototype.dispose.call(this) }, t }(An); st.registerComponent("TextTrackMenuItem", In); var xn = function (e) { function t(t, i) { return i.track = { player: t, kind: i.kind, kinds: i.kinds, default: !1, mode: "disabled" }, i.kinds || (i.kinds = [i.kind]), i.label ? i.track.label = i.label : i.track.label = i.kinds.join(" and ") + " off", i.selectable = !0, i.multiSelectable = !1, e.call(this, t, i) || this } ot(t, e); var i = t.prototype; return i.handleTracksChange = function (e) { for (var t = this.player().textTracks(), i = !0, n = 0, r = t.length; n < r; n++) { var a = t[n]; if (this.options_.kinds.indexOf(a.kind) > -1 && "showing" === a.mode) { i = !1; break } } i !== this.isSelected_ && this.selected(i) }, i.handleSelectedLanguageChange = function (e) { for (var t = this.player().textTracks(), i = !0, n = 0, r = t.length; n < r; n++) { var a = t[n]; if (["captions", "descriptions", "subtitles"].indexOf(a.kind) > -1 && "showing" === a.mode) { i = !1; break } } i && (this.player_.cache_.selectedLanguage = { enabled: !1 }) }, t }(In); st.registerComponent("OffTextTrackMenuItem", xn); var On = function (e) { function t(t, i) { return void 0 === i && (i = {}), i.tracks = t.textTracks(), e.call(this, t, i) || this } return ot(t, e), t.prototype.createItems = function (e, t) { var i; void 0 === e && (e = []), void 0 === t && (t = In), this.label_ && (i = this.label_ + " off"), e.push(new xn(this.player_, { kinds: this.kinds_, kind: this.kind_, label: i })), this.hideThreshold_ += 1; var n = this.player_.textTracks(); Array.isArray(this.kinds_) || (this.kinds_ = [this.kind_]); for (var r = 0; r < n.length; r++) { var a = n[r]; if (this.kinds_.indexOf(a.kind) > -1) { var s = new t(this.player_, { track: a, kinds: this.kinds_, kind: this.kind_, selectable: !0, multiSelectable: !1 }); s.addClass("vjs-" + a.kind + "-menu-item"), e.push(s) } } return e }, t }(Pn); st.registerComponent("TextTrackButton", On); var Dn = function (e) { function t(t, i) { var n, r = i.track, a = i.cue, s = t.currentTime(); return i.selectable = !0, i.multiSelectable = !1, i.label = a.text, i.selected = a.startTime <= s && s < a.endTime, (n = e.call(this, t, i) || this).track = r, n.cue = a, r.addEventListener("cuechange", qe(ct(n), n.update)), n } ot(t, e); var i = t.prototype; return i.handleClick = function (t) { e.prototype.handleClick.call(this), this.player_.currentTime(this.cue.startTime), this.update(this.cue.startTime) }, i.update = function (e) { var t = this.cue, i = this.player_.currentTime(); this.selected(t.startTime <= i && i < t.endTime) }, t }(An); st.registerComponent("ChaptersTrackMenuItem", Dn); var Mn = function (e) { function t(t, i, n) { return e.call(this, t, i, n) || this } ot(t, e); var i = t.prototype; return i.buildCSSClass = function () { return "vjs-chapters-button " + e.prototype.buildCSSClass.call(this) }, i.buildWrapperCSSClass = function () { return "vjs-chapters-button " + e.prototype.buildWrapperCSSClass.call(this) }, i.update = function (t) { this.track_ && (!t || "addtrack" !== t.type && "removetrack" !== t.type) || this.setTrack(this.findChaptersTrack()), e.prototype.update.call(this) }, i.setTrack = function (e) { if (this.track_ !== e) { if (this.updateHandler_ || (this.updateHandler_ = this.update.bind(this)), this.track_) { var t = this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_); t && t.removeEventListener("load", this.updateHandler_), this.track_ = null } if (this.track_ = e, this.track_) { this.track_.mode = "hidden"; var i = this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_); i && i.addEventListener("load", this.updateHandler_) } } }, i.findChaptersTrack = function () { for (var e = this.player_.textTracks() || [], t = e.length - 1; t >= 0; t--) { var i = e[t]; if (i.kind === this.kind_) return i } }, i.getMenuCaption = function () { return this.track_ && this.track_.label ? this.track_.label : this.localize(rt(this.kind_)) }, i.createMenu = function () { return this.options_.title = this.getMenuCaption(), e.prototype.createMenu.call(this) }, i.createItems = function () { var e = []; if (!this.track_) return e; var t = this.track_.cues; if (!t) return e; for (var i = 0, n = t.length; i < n; i++) { var r = t[i], a = new Dn(this.player_, { track: this.track_, cue: r }); e.push(a) } return e }, t }(On); Mn.prototype.kind_ = "chapters", Mn.prototype.controlText_ = "Chapters", st.registerComponent("ChaptersButton", Mn); var Rn = function (e) { function t(t, i, n) { var r; r = e.call(this, t, i, n) || this; var a = t.textTracks(), s = qe(ct(r), r.handleTracksChange); return a.addEventListener("change", s), r.on("dispose", (function () { a.removeEventListener("change", s) })), r } ot(t, e); var i = t.prototype; return i.handleTracksChange = function (e) { for (var t = this.player().textTracks(), i = !1, n = 0, r = t.length; n < r; n++) { var a = t[n]; if (a.kind !== this.kind_ && "showing" === a.mode) { i = !0; break } } i ? this.disable() : this.enable() }, i.buildCSSClass = function () { return "vjs-descriptions-button " + e.prototype.buildCSSClass.call(this) }, i.buildWrapperCSSClass = function () { return "vjs-descriptions-button " + e.prototype.buildWrapperCSSClass.call(this) }, t }(On); Rn.prototype.kind_ = "descriptions", Rn.prototype.controlText_ = "Descriptions", st.registerComponent("DescriptionsButton", Rn); var Bn = function (e) { function t(t, i, n) { return e.call(this, t, i, n) || this } ot(t, e); var i = t.prototype; return i.buildCSSClass = function () { return "vjs-subtitles-button " + e.prototype.buildCSSClass.call(this) }, i.buildWrapperCSSClass = function () { return "vjs-subtitles-button " + e.prototype.buildWrapperCSSClass.call(this) }, t }(On); Bn.prototype.kind_ = "subtitles", Bn.prototype.controlText_ = "Subtitles", st.registerComponent("SubtitlesButton", Bn); var Un = function (e) { function t(t, i) { var n; return i.track = { player: t, kind: i.kind, label: i.kind + " settings", selectable: !1, default: !1, mode: "disabled" }, i.selectable = !1, i.name = "CaptionSettingsMenuItem", (n = e.call(this, t, i) || this).addClass("vjs-texttrack-settings"), n.controlText(", opens " + i.kind + " settings dialog"), n } return ot(t, e), t.prototype.handleClick = function (e) { this.player().getChild("textTrackSettings").open() }, t }(In); st.registerComponent("CaptionSettingsMenuItem", Un); var jn = function (e) { function t(t, i, n) { return e.call(this, t, i, n) || this } ot(t, e); var i = t.prototype; return i.buildCSSClass = function () { return "vjs-captions-button " + e.prototype.buildCSSClass.call(this) }, i.buildWrapperCSSClass = function () { return "vjs-captions-button " + e.prototype.buildWrapperCSSClass.call(this) }, i.createItems = function () { var t = []; return this.player().tech_ && this.player().tech_.featuresNativeTextTracks || !this.player().getChild("textTrackSettings") || (t.push(new Un(this.player_, { kind: this.kind_ })), this.hideThreshold_ += 1), e.prototype.createItems.call(this, t) }, t }(On); jn.prototype.kind_ = "captions", jn.prototype.controlText_ = "Captions", st.registerComponent("CaptionsButton", jn); var Nn = function (e) { function t() { return e.apply(this, arguments) || this } return ot(t, e), t.prototype.createEl = function (t, i, n) { var r = '<span class="vjs-menu-item-text">' + this.localize(this.options_.label); return "captions" === this.options_.track.kind && (r += '\n        <span aria-hidden="true" class="vjs-icon-placeholder"></span>\n        <span class="vjs-control-text"> ' + this.localize("Captions") + "</span>\n      "), r += "</span>", e.prototype.createEl.call(this, t, B({ innerHTML: r }, i), n) }, t }(In); st.registerComponent("SubsCapsMenuItem", Nn); var Fn = function (e) { function t(t, i) { var n; return void 0 === i && (i = {}), (n = e.call(this, t, i) || this).label_ = "subtitles", ["en", "en-us", "en-ca", "fr-ca"].indexOf(n.player_.language_) > -1 && (n.label_ = "captions"), n.menuButton_.controlText(rt(n.label_)), n } ot(t, e); var i = t.prototype; return i.buildCSSClass = function () { return "vjs-subs-caps-button " + e.prototype.buildCSSClass.call(this) }, i.buildWrapperCSSClass = function () { return "vjs-subs-caps-button " + e.prototype.buildWrapperCSSClass.call(this) }, i.createItems = function () { var t = []; return this.player().tech_ && this.player().tech_.featuresNativeTextTracks || !this.player().getChild("textTrackSettings") || (t.push(new Un(this.player_, { kind: this.label_ })), this.hideThreshold_ += 1), t = e.prototype.createItems.call(this, t, Nn) }, t }(On); Fn.prototype.kinds_ = ["captions", "subtitles"], Fn.prototype.controlText_ = "Subtitles", st.registerComponent("SubsCapsButton", Fn); var Hn = function (e) { function t(t, i) { var n, r = i.track, a = t.audioTracks(); i.label = r.label || r.language || "Unknown", i.selected = r.enabled, (n = e.call(this, t, i) || this).track = r, n.addClass("vjs-" + r.kind + "-menu-item"); var s = function () { for (var e = arguments.length, t = new Array(e), i = 0; i < e; i++)t[i] = arguments[i]; n.handleTracksChange.apply(ct(n), t) }; return a.addEventListener("change", s), n.on("dispose", (function () { a.removeEventListener("change", s) })), n } ot(t, e); var i = t.prototype; return i.createEl = function (t, i, n) { var r = '<span class="vjs-menu-item-text">' + this.localize(this.options_.label); return "main-desc" === this.options_.track.kind && (r += '\n        <span aria-hidden="true" class="vjs-icon-placeholder"></span>\n        <span class="vjs-control-text"> ' + this.localize("Descriptions") + "</span>\n      "), r += "</span>", e.prototype.createEl.call(this, t, B({ innerHTML: r }, i), n) }, i.handleClick = function (t) { var i = this.player_.audioTracks(); e.prototype.handleClick.call(this, t); for (var n = 0; n < i.length; n++) { var r = i[n]; r.enabled = r === this.track } }, i.handleTracksChange = function (e) { this.selected(this.track.enabled) }, t }(An); st.registerComponent("AudioTrackMenuItem", Hn); var qn = function (e) { function t(t, i) { return void 0 === i && (i = {}), i.tracks = t.audioTracks(), e.call(this, t, i) || this } ot(t, e); var i = t.prototype; return i.buildCSSClass = function () { return "vjs-audio-button " + e.prototype.buildCSSClass.call(this) }, i.buildWrapperCSSClass = function () { return "vjs-audio-button " + e.prototype.buildWrapperCSSClass.call(this) }, i.createItems = function (e) { void 0 === e && (e = []), this.hideThreshold_ = 1; for (var t = this.player_.audioTracks(), i = 0; i < t.length; i++) { var n = t[i]; e.push(new Hn(this.player_, { track: n, selectable: !0, multiSelectable: !1 })) } return e }, t }(Pn); qn.prototype.controlText_ = "Audio Track", st.registerComponent("AudioTrackButton", qn); var Vn = function (e) { function t(t, i) { var n, r = i.rate, a = parseFloat(r, 10); return i.label = r, i.selected = 1 === a, i.selectable = !0, i.multiSelectable = !1, (n = e.call(this, t, i) || this).label = r, n.rate = a, n.on(t, "ratechange", n.update), n } ot(t, e); var i = t.prototype; return i.handleClick = function (t) { e.prototype.handleClick.call(this), this.player().playbackRate(this.rate) }, i.update = function (e) { this.selected(this.player().playbackRate() === this.rate) }, t }(An); Vn.prototype.contentElType = "button", st.registerComponent("PlaybackRateMenuItem", Vn); var Wn = function (e) { function t(t, i) { var n; return (n = e.call(this, t, i) || this).updateVisibility(), n.updateLabel(), n.on(t, "loadstart", n.updateVisibility), n.on(t, "ratechange", n.updateLabel), n } ot(t, e); var i = t.prototype; return i.createEl = function () { var t = e.prototype.createEl.call(this); return this.labelEl_ = G("div", { className: "vjs-playback-rate-value", innerHTML: "1x" }), t.appendChild(this.labelEl_), t }, i.dispose = function () { this.labelEl_ = null, e.prototype.dispose.call(this) }, i.buildCSSClass = function () { return "vjs-playback-rate " + e.prototype.buildCSSClass.call(this) }, i.buildWrapperCSSClass = function () { return "vjs-playback-rate " + e.prototype.buildWrapperCSSClass.call(this) }, i.createMenu = function () { var e = new En(this.player()), t = this.playbackRates(); if (t) for (var i = t.length - 1; i >= 0; i--)e.addChild(new Vn(this.player(), { rate: t[i] + "x" })); return e }, i.updateARIAAttributes = function () { this.el().setAttribute("aria-valuenow", this.player().playbackRate()) }, i.handleClick = function (e) { for (var t = this.player().playbackRate(), i = this.playbackRates(), n = i[0], r = 0; r < i.length; r++)if (i[r] > t) { n = i[r]; break } this.player().playbackRate(n) }, i.playbackRates = function () { return this.options_.playbackRates || this.options_.playerOptions && this.options_.playerOptions.playbackRates }, i.playbackRateSupported = function () { return this.player().tech_ && this.player().tech_.featuresPlaybackRate && this.playbackRates() && this.playbackRates().length > 0 }, i.updateVisibility = function (e) { this.playbackRateSupported() ? this.removeClass("vjs-hidden") : this.addClass("vjs-hidden") }, i.updateLabel = function (e) { this.playbackRateSupported() && (this.labelEl_.innerHTML = this.player().playbackRate() + "x") }, t }(wn); Wn.prototype.controlText_ = "Playback Rate", st.registerComponent("PlaybackRateMenuButton", Wn); var zn = function (e) { function t() { return e.apply(this, arguments) || this } ot(t, e); var i = t.prototype; return i.buildCSSClass = function () { return "vjs-spacer " + e.prototype.buildCSSClass.call(this) }, i.createEl = function () { return e.prototype.createEl.call(this, "div", { className: this.buildCSSClass() }) }, t }(st); st.registerComponent("Spacer", zn); var Gn = function (e) { function t() { return e.apply(this, arguments) || this } ot(t, e); var i = t.prototype; return i.buildCSSClass = function () { return "vjs-custom-control-spacer " + e.prototype.buildCSSClass.call(this) }, i.createEl = function () { var t = e.prototype.createEl.call(this, { className: this.buildCSSClass() }); return t.innerHTML = "\xa0", t }, t }(zn); st.registerComponent("CustomControlSpacer", Gn); var Kn = function (e) { function t() { return e.apply(this, arguments) || this } return ot(t, e), t.prototype.createEl = function () { return e.prototype.createEl.call(this, "div", { className: "vjs-control-bar", dir: "ltr" }) }, t }(st); Kn.prototype.options_ = { children: ["playToggle", "volumePanel", "currentTimeDisplay", "timeDivider", "durationDisplay", "progressControl", "liveDisplay", "seekToLive", "remainingTimeDisplay", "customControlSpacer", "playbackRateMenuButton", "chaptersButton", "descriptionsButton", "subsCapsButton", "audioTrackButton", "fullscreenToggle"] }, "exitPictureInPicture" in s.a && Kn.prototype.options_.children.splice(Kn.prototype.options_.children.length - 1, 0, "pictureInPictureToggle"), st.registerComponent("ControlBar", Kn); var Yn = function (e) { function t(t, i) { var n; return (n = e.call(this, t, i) || this).on(t, "error", n.open), n } ot(t, e); var i = t.prototype; return i.buildCSSClass = function () { return "vjs-error-display " + e.prototype.buildCSSClass.call(this) }, i.content = function () { var e = this.player().error(); return e ? this.localize(e.message) : "" }, t }($t); Yn.prototype.options_ = at($t.prototype.options_, { pauseOnOpen: !1, fillAlways: !0, temporary: !1, uncloseable: !0 }), st.registerComponent("ErrorDisplay", Yn); var Xn = ["#000", "Black"], $n = ["#00F", "Blue"], Qn = ["#0FF", "Cyan"], Jn = ["#0F0", "Green"], Zn = ["#F0F", "Magenta"], er = ["#F00", "Red"], tr = ["#FFF", "White"], ir = ["#FF0", "Yellow"], nr = ["1", "Opaque"], rr = ["0.5", "Semi-Transparent"], ar = ["0", "Transparent"], sr = { backgroundColor: { selector: ".vjs-bg-color > select", id: "captions-background-color-%s", label: "Color", options: [Xn, tr, er, Jn, $n, ir, Zn, Qn] }, backgroundOpacity: { selector: ".vjs-bg-opacity > select", id: "captions-background-opacity-%s", label: "Transparency", options: [nr, rr, ar] }, color: { selector: ".vjs-fg-color > select", id: "captions-foreground-color-%s", label: "Color", options: [tr, Xn, er, Jn, $n, ir, Zn, Qn] }, edgeStyle: { selector: ".vjs-edge-style > select", id: "%s", label: "Text Edge Style", options: [["none", "None"], ["raised", "Raised"], ["depressed", "Depressed"], ["uniform", "Uniform"], ["dropshadow", "Dropshadow"]] }, fontFamily: { selector: ".vjs-font-family > select", id: "captions-font-family-%s", label: "Font Family", options: [["proportionalSansSerif", "Proportional Sans-Serif"], ["monospaceSansSerif", "Monospace Sans-Serif"], ["proportionalSerif", "Proportional Serif"], ["monospaceSerif", "Monospace Serif"], ["casual", "Casual"], ["script", "Script"], ["small-caps", "Small Caps"]] }, fontPercent: { selector: ".vjs-font-percent > select", id: "captions-font-size-%s", label: "Font Size", options: [["0.50", "50%"], ["0.75", "75%"], ["1.00", "100%"], ["1.25", "125%"], ["1.50", "150%"], ["1.75", "175%"], ["2.00", "200%"], ["3.00", "300%"], ["4.00", "400%"]], default: 2, parser: function (e) { return "1.00" === e ? null : Number(e) } }, textOpacity: { selector: ".vjs-text-opacity > select", id: "captions-foreground-opacity-%s", label: "Transparency", options: [nr, rr] }, windowColor: { selector: ".vjs-window-color > select", id: "captions-window-color-%s", label: "Color" }, windowOpacity: { selector: ".vjs-window-opacity > select", id: "captions-window-opacity-%s", label: "Transparency", options: [ar, rr, nr] } }; function or(e, t) { if (t && (e = t(e)), e && "none" !== e) return e } sr.windowColor.options = sr.backgroundColor.options; var lr = function (e) { function t(t, i) { var n; return i.temporary = !1, (n = e.call(this, t, i) || this).updateDisplay = qe(ct(n), n.updateDisplay), n.fill(), n.hasBeenOpened_ = n.hasBeenFilled_ = !0, n.endDialog = G("p", { className: "vjs-control-text", textContent: n.localize("End of dialog window.") }), n.el().appendChild(n.endDialog), n.setDefaults(), void 0 === i.persistTextTrackSettings && (n.options_.persistTextTrackSettings = n.options_.playerOptions.persistTextTrackSettings), n.on(n.$(".vjs-done-button"), "click", (function () { n.saveSettings(), n.close() })), n.on(n.$(".vjs-default-button"), "click", (function () { n.setDefaults(), n.updateDisplay() })), R(sr, (function (e) { n.on(n.$(e.selector), "change", n.updateDisplay) })), n.options_.persistTextTrackSettings && n.restoreSettings(), n } ot(t, e); var i = t.prototype; return i.dispose = function () { this.endDialog = null, e.prototype.dispose.call(this) }, i.createElSelect_ = function (e, t, i) { var n = this; void 0 === t && (t = ""), void 0 === i && (i = "label"); var r = sr[e], a = r.id.replace("%s", this.id_), s = [t, a].join(" ").trim(); return ["<" + i + ' id="' + a + '" class="' + ("label" === i ? "vjs-label" : "") + '">', this.localize(r.label), "</" + i + ">", '<select aria-labelledby="' + s + '">'].concat(r.options.map((function (e) { var t = a + "-" + e[1].replace(/\W+/g, ""); return ['<option id="' + t + '" value="' + e[0] + '" ', 'aria-labelledby="' + s + " " + t + '">', n.localize(e[1]), "</option>"].join("") }))).concat("</select>").join("") }, i.createElFgColor_ = function () { var e = "captions-text-legend-" + this.id_; return ['<fieldset class="vjs-fg-color vjs-track-setting">', '<legend id="' + e + '">', this.localize("Text"), "</legend>", this.createElSelect_("color", e), '<span class="vjs-text-opacity vjs-opacity">', this.createElSelect_("textOpacity", e), "</span>", "</fieldset>"].join("") }, i.createElBgColor_ = function () { var e = "captions-background-" + this.id_; return ['<fieldset class="vjs-bg-color vjs-track-setting">', '<legend id="' + e + '">', this.localize("Background"), "</legend>", this.createElSelect_("backgroundColor", e), '<span class="vjs-bg-opacity vjs-opacity">', this.createElSelect_("backgroundOpacity", e), "</span>", "</fieldset>"].join("") }, i.createElWinColor_ = function () { var e = "captions-window-" + this.id_; return ['<fieldset class="vjs-window-color vjs-track-setting">', '<legend id="' + e + '">', this.localize("Window"), "</legend>", this.createElSelect_("windowColor", e), '<span class="vjs-window-opacity vjs-opacity">', this.createElSelect_("windowOpacity", e), "</span>", "</fieldset>"].join("") }, i.createElColors_ = function () { return G("div", { className: "vjs-track-settings-colors", innerHTML: [this.createElFgColor_(), this.createElBgColor_(), this.createElWinColor_()].join("") }) }, i.createElFont_ = function () { return G("div", { className: "vjs-track-settings-font", innerHTML: ['<fieldset class="vjs-font-percent vjs-track-setting">', this.createElSelect_("fontPercent", "", "legend"), "</fieldset>", '<fieldset class="vjs-edge-style vjs-track-setting">', this.createElSelect_("edgeStyle", "", "legend"), "</fieldset>", '<fieldset class="vjs-font-family vjs-track-setting">', this.createElSelect_("fontFamily", "", "legend"), "</fieldset>"].join("") }) }, i.createElControls_ = function () { var e = this.localize("restore all settings to the default values"); return G("div", { className: "vjs-track-settings-controls", innerHTML: ['<button type="button" class="vjs-default-button" title="' + e + '">', this.localize("Reset"), '<span class="vjs-control-text"> ' + e + "</span>", "</button>", '<button type="button" class="vjs-done-button">' + this.localize("Done") + "</button>"].join("") }) }, i.content = function () { return [this.createElColors_(), this.createElFont_(), this.createElControls_()] }, i.label = function () { return this.localize("Caption Settings Dialog") }, i.description = function () { return this.localize("Beginning of dialog window. Escape will cancel and close the window.") }, i.buildCSSClass = function () { return e.prototype.buildCSSClass.call(this) + " vjs-text-track-settings" }, i.getValues = function () { var e, t, i, n = this; return t = function (e, t, i) { var r, a, s = (r = n.$(t.selector), a = t.parser, or(r.options[r.options.selectedIndex].value, a)); return void 0 !== s && (e[i] = s), e }, void 0 === (i = {}) && (i = 0), M(e = sr).reduce((function (i, n) { return t(i, e[n], n) }), i) }, i.setValues = function (e) { var t = this; R(sr, (function (i, n) { !function (e, t, i) { if (t) for (var n = 0; n < e.options.length; n++)if (or(e.options[n].value, i) === t) { e.selectedIndex = n; break } }(t.$(i.selector), e[n], i.parser) })) }, i.setDefaults = function () { var e = this; R(sr, (function (t) { var i = t.hasOwnProperty("default") ? t.default : 0; e.$(t.selector).selectedIndex = i })) }, i.restoreSettings = function () { var e; try { e = JSON.parse(r.a.localStorage.getItem("vjs-text-track-settings")) } catch (t) { x.warn(t) } e && this.setValues(e) }, i.saveSettings = function () { if (this.options_.persistTextTrackSettings) { var e = this.getValues(); try { Object.keys(e).length ? r.a.localStorage.setItem("vjs-text-track-settings", JSON.stringify(e)) : r.a.localStorage.removeItem("vjs-text-track-settings") } catch (t) { x.warn(t) } } }, i.updateDisplay = function () { var e = this.player_.getChild("textTrackDisplay"); e && e.updateDisplay() }, i.conditionalBlur_ = function () { this.previouslyActiveEl_ = null; var e = this.player_.controlBar, t = e && e.subsCapsButton, i = e && e.captionsButton; t ? t.focus() : i && i.focus() }, t }($t); st.registerComponent("TextTrackSettings", lr); var ur = function (e) { function t(t, i) { var n, a = i.ResizeObserver || r.a.ResizeObserver; null === i.ResizeObserver && (a = !1); var s = at({ createEl: !a, reportTouchActivity: !1 }, i); return (n = e.call(this, t, s) || this).ResizeObserver = i.ResizeObserver || r.a.ResizeObserver, n.loadListener_ = null, n.resizeObserver_ = null, n.debouncedHandler_ = We((function () { n.resizeHandler() }), 100, !1, ct(n)), a ? (n.resizeObserver_ = new n.ResizeObserver(n.debouncedHandler_), n.resizeObserver_.observe(t.el())) : (n.loadListener_ = function () { if (n.el_ && n.el_.contentWindow) { var e = n.debouncedHandler_, t = n.unloadListener_ = function () { Re(this, "resize", e), Re(this, "unload", t), t = null }; Me(n.el_.contentWindow, "unload", t), Me(n.el_.contentWindow, "resize", e) } }, n.one("load", n.loadListener_)), n } ot(t, e); var i = t.prototype; return i.createEl = function () { return e.prototype.createEl.call(this, "iframe", { className: "vjs-resize-manager", tabIndex: -1 }, { "aria-hidden": "true" }) }, i.resizeHandler = function () { this.player_ && this.player_.trigger && this.player_.trigger("playerresize") }, i.dispose = function () { this.debouncedHandler_ && this.debouncedHandler_.cancel(), this.resizeObserver_ && (this.player_.el() && this.resizeObserver_.unobserve(this.player_.el()), this.resizeObserver_.disconnect()), this.loadListener_ && this.off("load", this.loadListener_), this.el_ && this.el_.contentWindow && this.unloadListener_ && this.unloadListener_.call(this.el_.contentWindow), this.ResizeObserver = null, this.resizeObserver = null, this.debouncedHandler_ = null, this.loadListener_ = null, e.prototype.dispose.call(this) }, t }(st); st.registerComponent("ResizeManager", ur); var cr = function (e) { function t(t, i) { var n, r = at({ createEl: !1 }, i); return (n = e.call(this, t, r) || this).reset_(), n.on(n.player_, "durationchange", n.handleDurationchange), wt && "hidden" in s.a && "visibilityState" in s.a && n.on(s.a, "visibilitychange", n.handleVisibilityChange), n } ot(t, e); var i = t.prototype; return i.handleVisibilityChange = function () { this.player_.duration() === 1 / 0 && (s.a.hidden ? this.stopTracking() : this.startTracking()) }, i.isBehind_ = function () { if (!this.timeupdateSeen_) return !1; var e = this.liveCurrentTime(), t = this.player_.currentTime(), i = 2 * this.seekableIncrement_ + .07; return e !== 1 / 0 && e - i >= t }, i.trackLive_ = function () { this.pastSeekEnd_ = this.pastSeekEnd_; var e = this.player_.seekable(); if (e && e.length) { var t = this.seekableEnd(); t !== this.lastSeekEnd_ && (this.lastSeekEnd_ && (this.seekableIncrementList_ = this.seekableIncrementList_.slice(-11), this.seekableIncrementList_.push(Math.abs(t - this.lastSeekEnd_)), this.seekableIncrementList_.length > 3 && (this.seekableIncrement_ = function (e) { var t = Math.floor(e.length / 2), i = [].concat(e).sort((function (e, t) { return e - t })); return e.length % 2 !== 0 ? i[t] : (i[t - 1] + i[t]) / 2 }(this.seekableIncrementList_))), this.pastSeekEnd_ = 0, this.lastSeekEnd_ = t, this.trigger("seekableendchange")), this.pastSeekEnd_ = this.pastSeekEnd() + .03, this.isBehind_() !== this.behindLiveEdge() && (this.behindLiveEdge_ = this.isBehind_(), this.trigger("liveedgechange")) } }, i.handleDurationchange = function () { this.player_.duration() === 1 / 0 ? this.startTracking() : this.stopTracking() }, i.startTracking = function () { var e = this; this.isTracking() || (this.timeupdateSeen_ || (this.timeupdateSeen_ = this.player_.hasStarted()), this.trackingInterval_ = this.setInterval(this.trackLive_, 30), this.trackLive_(), this.on(this.player_, "play", this.trackLive_), this.on(this.player_, "pause", this.trackLive_), this.timeupdateSeen_ || (this.one(this.player_, "play", this.handlePlay), this.handleTimeupdate = function () { e.timeupdateSeen_ = !0, e.handleTimeupdate = null }, this.one(this.player_, "timeupdate", this.handleTimeupdate))) }, i.handlePlay = function () { this.one(this.player_, "timeupdate", this.seekToLiveEdge) }, i.reset_ = function () { this.pastSeekEnd_ = 0, this.lastSeekEnd_ = null, this.behindLiveEdge_ = null, this.timeupdateSeen_ = !1, this.clearInterval(this.trackingInterval_), this.trackingInterval_ = null, this.seekableIncrement_ = 12, this.seekableIncrementList_ = [], this.off(this.player_, "play", this.trackLive_), this.off(this.player_, "pause", this.trackLive_), this.off(this.player_, "play", this.handlePlay), this.off(this.player_, "timeupdate", this.seekToLiveEdge), this.handleTimeupdate && (this.off(this.player_, "timeupdate", this.handleTimeupdate), this.handleTimeupdate = null) }, i.stopTracking = function () { this.isTracking() && this.reset_() }, i.seekableEnd = function () { for (var e = this.player_.seekable(), t = [], i = e ? e.length : 0; i--;)t.push(e.end(i)); return t.length ? t.sort()[t.length - 1] : 1 / 0 }, i.seekableStart = function () { for (var e = this.player_.seekable(), t = [], i = e ? e.length : 0; i--;)t.push(e.start(i)); return t.length ? t.sort()[0] : 0 }, i.liveWindow = function () { var e = this.liveCurrentTime(); return e === 1 / 0 ? 1 / 0 : e - this.seekableStart() }, i.isLive = function () { return this.isTracking() }, i.atLiveEdge = function () { return !this.behindLiveEdge() }, i.liveCurrentTime = function () { return this.pastSeekEnd() + this.seekableEnd() }, i.pastSeekEnd = function () { return this.pastSeekEnd_ }, i.behindLiveEdge = function () { return this.behindLiveEdge_ }, i.isTracking = function () { return "number" === typeof this.trackingInterval_ }, i.seekToLiveEdge = function () { this.atLiveEdge() || (this.player_.currentTime(this.liveCurrentTime()), this.player_.paused() && this.player_.play()) }, i.dispose = function () { this.stopTracking(), e.prototype.dispose.call(this) }, t }(st); st.registerComponent("LiveTracker", cr); var hr = function (e) { var t = e.el(); if (t.hasAttribute("src")) return e.triggerSourceset(t.src), !0; var i = e.$$("source"), n = [], r = ""; if (!i.length) return !1; for (var a = 0; a < i.length; a++) { var s = i[a].src; s && -1 === n.indexOf(s) && n.push(s) } return !!n.length && (1 === n.length && (r = n[0]), e.triggerSourceset(r), !0) }, dr = Object.defineProperty({}, "innerHTML", { get: function () { return this.cloneNode(!0).innerHTML }, set: function (e) { var t = s.a.createElement(this.nodeName.toLowerCase()); t.innerHTML = e; for (var i = s.a.createDocumentFragment(); t.childNodes.length;)i.appendChild(t.childNodes[0]); return this.innerText = "", r.a.Element.prototype.appendChild.call(this, i), this.innerHTML } }), pr = function (e, t) { for (var i = {}, n = 0; n < e.length && !((i = Object.getOwnPropertyDescriptor(e[n], t)) && i.set && i.get); n++); return i.enumerable = !0, i.configurable = !0, i }, fr = function (e) { var t = e.el(); if (!t.resetSourceWatch_) { var i = {}, n = function (e) { return pr([e.el(), r.a.HTMLMediaElement.prototype, r.a.Element.prototype, dr], "innerHTML") }(e), a = function (i) { return function () { for (var n = arguments.length, r = new Array(n), a = 0; a < n; a++)r[a] = arguments[a]; var s = i.apply(t, r); return hr(e), s } };["append", "appendChild", "insertAdjacentHTML"].forEach((function (e) { t[e] && (i[e] = t[e], t[e] = a(i[e])) })), Object.defineProperty(t, "innerHTML", at(n, { set: a(n.set) })), t.resetSourceWatch_ = function () { t.resetSourceWatch_ = null, Object.keys(i).forEach((function (e) { t[e] = i[e] })), Object.defineProperty(t, "innerHTML", n) }, e.one("sourceset", t.resetSourceWatch_) } }, mr = Object.defineProperty({}, "src", { get: function () { return this.hasAttribute("src") ? di(r.a.Element.prototype.getAttribute.call(this, "src")) : "" }, set: function (e) { return r.a.Element.prototype.setAttribute.call(this, "src", e), e } }), gr = function (e) { if (e.featuresSourceset) { var t = e.el(); if (!t.resetSourceset_) { var i = function (e) { return pr([e.el(), r.a.HTMLMediaElement.prototype, mr], "src") }(e), n = t.setAttribute, a = t.load; Object.defineProperty(t, "src", at(i, { set: function (n) { var r = i.set.call(t, n); return e.triggerSourceset(t.src), r } })), t.setAttribute = function (i, r) { var a = n.call(t, i, r); return /src/i.test(i) && e.triggerSourceset(t.src), a }, t.load = function () { var i = a.call(t); return hr(e) || (e.triggerSourceset(""), fr(e)), i }, t.currentSrc ? e.triggerSourceset(t.currentSrc) : hr(e) || fr(e), t.resetSourceset_ = function () { t.resetSourceset_ = null, t.load = a, t.setAttribute = n, Object.defineProperty(t, "src", i), t.resetSourceWatch_ && t.resetSourceWatch_() } } } }, vr = function (e) { function t(t, i) { var n; n = e.call(this, t, i) || this; var r = t.source, a = !1; if (r && (n.el_.currentSrc !== r.src || t.tag && 3 === t.tag.initNetworkState_) ? n.setSource(r) : n.handleLateInit_(n.el_), t.enableSourceset && n.setupSourcesetHandling_(), n.el_.hasChildNodes()) { for (var s = n.el_.childNodes, o = s.length, l = []; o--;) { var u = s[o]; "track" === u.nodeName.toLowerCase() && (n.featuresNativeTextTracks ? (n.remoteTextTrackEls().addTrackElement_(u), n.remoteTextTracks().addTrack(u.track), n.textTracks().addTrack(u.track), a || n.el_.hasAttribute("crossorigin") || !fi(u.src) || (a = !0)) : l.push(u)) } for (var c = 0; c < l.length; c++)n.el_.removeChild(l[c]) } return n.proxyNativeTracks_(), n.featuresNativeTextTracks && a && x.warn("Text Tracks are being loaded from another origin but the crossorigin attribute isn't used.\nThis may prevent text tracks from loading."), n.restoreMetadataTracksInIOSNativePlayer_(), (It || mt || Tt) && !0 === t.nativeControlsForTouch && n.setControls(!0), n.proxyWebkitFullscreen_(), n.triggerReady(), n } ot(t, e); var i = t.prototype; return i.dispose = function () { this.el_ && this.el_.resetSourceset_ && this.el_.resetSourceset_(), t.disposeMediaElement(this.el_), this.options_ = null, e.prototype.dispose.call(this) }, i.setupSourcesetHandling_ = function () { gr(this) }, i.restoreMetadataTracksInIOSNativePlayer_ = function () { var e, t = this.textTracks(), i = function () { e = []; for (var i = 0; i < t.length; i++) { var n = t[i]; "metadata" === n.kind && e.push({ track: n, storedMode: n.mode }) } }; i(), t.addEventListener("change", i), this.on("dispose", (function () { return t.removeEventListener("change", i) })); var n = function i() { for (var n = 0; n < e.length; n++) { var r = e[n]; "disabled" === r.track.mode && r.track.mode !== r.storedMode && (r.track.mode = r.storedMode) } t.removeEventListener("change", i) }; this.on("webkitbeginfullscreen", (function () { t.removeEventListener("change", i), t.removeEventListener("change", n), t.addEventListener("change", n) })), this.on("webkitendfullscreen", (function () { t.removeEventListener("change", i), t.addEventListener("change", i), t.removeEventListener("change", n) })) }, i.overrideNative_ = function (e, t) { var i = this; if (t === this["featuresNative" + e + "Tracks"]) { var n = e.toLowerCase(); this[n + "TracksListeners_"] && Object.keys(this[n + "TracksListeners_"]).forEach((function (e) { i.el()[n + "Tracks"].removeEventListener(e, i[n + "TracksListeners_"][e]) })), this["featuresNative" + e + "Tracks"] = !t, this[n + "TracksListeners_"] = null, this.proxyNativeTracksForType_(n) } }, i.overrideNativeAudioTracks = function (e) { this.overrideNative_("Audio", e) }, i.overrideNativeVideoTracks = function (e) { this.overrideNative_("Video", e) }, i.proxyNativeTracksForType_ = function (e) { var t = this, i = Ci[e], n = this.el()[i.getterName], r = this[i.getterName](); if (this["featuresNative" + i.capitalName + "Tracks"] && n && n.addEventListener) { var a = { change: function (e) { r.trigger({ type: "change", target: r, currentTarget: r, srcElement: r }) }, addtrack: function (e) { r.addTrack(e.track) }, removetrack: function (e) { r.removeTrack(e.track) } }, s = function () { for (var e = [], t = 0; t < r.length; t++) { for (var i = !1, a = 0; a < n.length; a++)if (n[a] === r[t]) { i = !0; break } i || e.push(r[t]) } for (; e.length;)r.removeTrack(e.shift()) }; this[i.getterName + "Listeners_"] = a, Object.keys(a).forEach((function (e) { var i = a[e]; n.addEventListener(e, i), t.on("dispose", (function (t) { return n.removeEventListener(e, i) })) })), this.on("loadstart", s), this.on("dispose", (function (e) { return t.off("loadstart", s) })) } }, i.proxyNativeTracks_ = function () { var e = this; Ci.names.forEach((function (t) { e.proxyNativeTracksForType_(t) })) }, i.createEl = function () { var e = this.options_.tag; if (!e || !this.options_.playerElIngest && !this.movingMediaElementInDOM) { if (e) { var i = e.cloneNode(!0); e.parentNode && e.parentNode.insertBefore(i, e), t.disposeMediaElement(e), e = i } else { e = s.a.createElement("video"); var n = at({}, this.options_.tag && ee(this.options_.tag)); It && !0 === this.options_.nativeControlsForTouch || delete n.controls, Z(e, B(n, { id: this.options_.techId, class: "vjs-tech" })) } e.playerId = this.options_.playerId } "undefined" !== typeof this.options_.preload && ie(e, "preload", this.options_.preload); for (var r = ["loop", "muted", "playsinline", "autoplay"], a = 0; a < r.length; a++) { var o = r[a], l = this.options_[o]; "undefined" !== typeof l && (l ? ie(e, o, o) : ne(e, o), e[o] = l) } return e }, i.handleLateInit_ = function (e) { if (0 !== e.networkState && 3 !== e.networkState) { if (0 === e.readyState) { var t = !1, i = function () { t = !0 }; this.on("loadstart", i); var n = function () { t || this.trigger("loadstart") }; return this.on("loadedmetadata", n), void this.ready((function () { this.off("loadstart", i), this.off("loadedmetadata", n), t || this.trigger("loadstart") })) } var r = ["loadstart"]; r.push("loadedmetadata"), e.readyState >= 2 && r.push("loadeddata"), e.readyState >= 3 && r.push("canplay"), e.readyState >= 4 && r.push("canplaythrough"), this.ready((function () { r.forEach((function (e) { this.trigger(e) }), this) })) } }, i.setCurrentTime = function (e) { try { this.el_.currentTime = e } catch (t) { x(t, "Video is not ready. (Video.js)") } }, i.duration = function () { var e = this; if (this.el_.duration === 1 / 0 && _t && Ct && 0 === this.el_.currentTime) { return this.on("timeupdate", (function t() { e.el_.currentTime > 0 && (e.el_.duration === 1 / 0 && e.trigger("durationchange"), e.off("timeupdate", t)) })), NaN } return this.el_.duration || NaN }, i.width = function () { return this.el_.offsetWidth }, i.height = function () { return this.el_.offsetHeight }, i.proxyWebkitFullscreen_ = function () { var e = this; if ("webkitDisplayingFullscreen" in this.el_) { var t = function () { this.trigger("fullscreenchange", { isFullscreen: !1 }) }, i = function () { "webkitPresentationMode" in this.el_ && "picture-in-picture" !== this.el_.webkitPresentationMode && (this.one("webkitendfullscreen", t), this.trigger("fullscreenchange", { isFullscreen: !0 })) }; this.on("webkitbeginfullscreen", i), this.on("dispose", (function () { e.off("webkitbeginfullscreen", i), e.off("webkitendfullscreen", t) })) } }, i.supportsFullScreen = function () { if ("function" === typeof this.el_.webkitEnterFullScreen) { var e = r.a.navigator && r.a.navigator.userAgent || ""; if (/Android/.test(e) || !/Chrome|Mac OS X 10.5/.test(e)) return !0 } return !1 }, i.enterFullScreen = function () { var e = this.el_; e.paused && e.networkState <= e.HAVE_METADATA ? (this.el_.play(), this.setTimeout((function () { e.pause(), e.webkitEnterFullScreen() }), 0)) : e.webkitEnterFullScreen() }, i.exitFullScreen = function () { this.el_.webkitExitFullScreen() }, i.requestPictureInPicture = function () { return this.el_.requestPictureInPicture() }, i.src = function (e) { if (void 0 === e) return this.el_.src; this.setSrc(e) }, i.reset = function () { t.resetMediaElement(this.el_) }, i.currentSrc = function () { return this.currentSource_ ? this.currentSource_.src : this.el_.currentSrc }, i.setControls = function (e) { this.el_.controls = !!e }, i.addTextTrack = function (t, i, n) { return this.featuresNativeTextTracks ? this.el_.addTextTrack(t, i, n) : e.prototype.addTextTrack.call(this, t, i, n) }, i.createRemoteTextTrack = function (t) { if (!this.featuresNativeTextTracks) return e.prototype.createRemoteTextTrack.call(this, t); var i = s.a.createElement("track"); return t.kind && (i.kind = t.kind), t.label && (i.label = t.label), (t.language || t.srclang) && (i.srclang = t.language || t.srclang), t.default && (i.default = t.default), t.id && (i.id = t.id), t.src && (i.src = t.src), i }, i.addRemoteTextTrack = function (t, i) { var n = e.prototype.addRemoteTextTrack.call(this, t, i); return this.featuresNativeTextTracks && this.el().appendChild(n), n }, i.removeRemoteTextTrack = function (t) { if (e.prototype.removeRemoteTextTrack.call(this, t), this.featuresNativeTextTracks) for (var i = this.$$("track"), n = i.length; n--;)t !== i[n] && t !== i[n].track || this.el().removeChild(i[n]) }, i.getVideoPlaybackQuality = function () { if ("function" === typeof this.el().getVideoPlaybackQuality) return this.el().getVideoPlaybackQuality(); var e = {}; return "undefined" !== typeof this.el().webkitDroppedFrameCount && "undefined" !== typeof this.el().webkitDecodedFrameCount && (e.droppedVideoFrames = this.el().webkitDroppedFrameCount, e.totalVideoFrames = this.el().webkitDecodedFrameCount), r.a.performance && "function" === typeof r.a.performance.now ? e.creationTime = r.a.performance.now() : r.a.performance && r.a.performance.timing && "number" === typeof r.a.performance.timing.navigationStart && (e.creationTime = r.a.Date.now() - r.a.performance.timing.navigationStart), e }, t }(Pi); if (q()) { vr.TEST_VID = s.a.createElement("video"); var yr = s.a.createElement("track"); yr.kind = "captions", yr.srclang = "en", yr.label = "English", vr.TEST_VID.appendChild(yr) } vr.isSupported = function () { try { vr.TEST_VID.volume = .5 } catch (e) { return !1 } return !(!vr.TEST_VID || !vr.TEST_VID.canPlayType) }, vr.canPlayType = function (e) { return vr.TEST_VID.canPlayType(e) }, vr.canPlaySource = function (e, t) { return vr.canPlayType(e.type) }, vr.canControlVolume = function () { try { var e = vr.TEST_VID.volume; return vr.TEST_VID.volume = e / 2 + .1, e !== vr.TEST_VID.volume } catch (t) { return !1 } }, vr.canMuteVolume = function () { try { var e = vr.TEST_VID.muted; return vr.TEST_VID.muted = !e, vr.TEST_VID.muted ? ie(vr.TEST_VID, "muted", "muted") : ne(vr.TEST_VID, "muted"), e !== vr.TEST_VID.muted } catch (t) { return !1 } }, vr.canControlPlaybackRate = function () { if (_t && Ct && Et < 58) return !1; try { var e = vr.TEST_VID.playbackRate; return vr.TEST_VID.playbackRate = e / 2 + .1, e !== vr.TEST_VID.playbackRate } catch (t) { return !1 } }, vr.canOverrideAttributes = function () { try { var e = function () { }; Object.defineProperty(s.a.createElement("video"), "src", { get: e, set: e }), Object.defineProperty(s.a.createElement("audio"), "src", { get: e, set: e }), Object.defineProperty(s.a.createElement("video"), "innerHTML", { get: e, set: e }), Object.defineProperty(s.a.createElement("audio"), "innerHTML", { get: e, set: e }) } catch (t) { return !1 } return !0 }, vr.supportsNativeTextTracks = function () { return Lt || vt && Ct }, vr.supportsNativeVideoTracks = function () { return !(!vr.TEST_VID || !vr.TEST_VID.videoTracks) }, vr.supportsNativeAudioTracks = function () { return !(!vr.TEST_VID || !vr.TEST_VID.audioTracks) }, vr.Events = ["loadstart", "suspend", "abort", "error", "emptied", "stalled", "loadedmetadata", "loadeddata", "canplay", "canplaythrough", "playing", "waiting", "seeking", "seeked", "ended", "durationchange", "timeupdate", "progress", "play", "pause", "ratechange", "resize", "volumechange"], vr.prototype.featuresVolumeControl = vr.canControlVolume(), vr.prototype.featuresMuteControl = vr.canMuteVolume(), vr.prototype.featuresPlaybackRate = vr.canControlPlaybackRate(), vr.prototype.featuresSourceset = vr.canOverrideAttributes(), vr.prototype.movingMediaElementInDOM = !vt, vr.prototype.featuresFullscreenResize = !0, vr.prototype.featuresProgressEvents = !0, vr.prototype.featuresTimeupdateEvents = !0, vr.prototype.featuresNativeTextTracks = vr.supportsNativeTextTracks(), vr.prototype.featuresNativeVideoTracks = vr.supportsNativeVideoTracks(), vr.prototype.featuresNativeAudioTracks = vr.supportsNativeAudioTracks(); var _r = vr.TEST_VID && vr.TEST_VID.constructor.prototype.canPlayType, br = /^application\/(?:x-|vnd\.apple\.)mpegurl/i; vr.patchCanPlayType = function () { bt >= 4 && !kt && !Ct && (vr.TEST_VID.constructor.prototype.canPlayType = function (e) { return e && br.test(e) ? "maybe" : _r.call(this, e) }) }, vr.unpatchCanPlayType = function () { var e = vr.TEST_VID.constructor.prototype.canPlayType; return vr.TEST_VID.constructor.prototype.canPlayType = _r, e }, vr.patchCanPlayType(), vr.disposeMediaElement = function (e) { if (e) { for (e.parentNode && e.parentNode.removeChild(e); e.hasChildNodes();)e.removeChild(e.firstChild); e.removeAttribute("src"), "function" === typeof e.load && function () { try { e.load() } catch (t) { } }() } }, vr.resetMediaElement = function (e) { if (e) { for (var t = e.querySelectorAll("source"), i = t.length; i--;)e.removeChild(t[i]); e.removeAttribute("src"), "function" === typeof e.load && function () { try { e.load() } catch (t) { } }() } }, ["muted", "defaultMuted", "autoplay", "controls", "loop", "playsinline"].forEach((function (e) { vr.prototype[e] = function () { return this.el_[e] || this.el_.hasAttribute(e) } })), ["muted", "defaultMuted", "autoplay", "loop", "playsinline"].forEach((function (e) { vr.prototype["set" + rt(e)] = function (t) { this.el_[e] = t, t ? this.el_.setAttribute(e, e) : this.el_.removeAttribute(e) } })), ["paused", "currentTime", "buffered", "volume", "poster", "preload", "error", "seeking", "seekable", "ended", "playbackRate", "defaultPlaybackRate", "played", "networkState", "readyState", "videoWidth", "videoHeight"].forEach((function (e) { vr.prototype[e] = function () { return this.el_[e] } })), ["volume", "src", "poster", "preload", "playbackRate", "defaultPlaybackRate"].forEach((function (e) { vr.prototype["set" + rt(e)] = function (t) { this.el_[e] = t } })), ["pause", "load", "play"].forEach((function (e) { vr.prototype[e] = function () { return this.el_[e]() } })), Pi.withSourceHandlers(vr), vr.nativeSourceHandler = {}, vr.nativeSourceHandler.canPlayType = function (e) { try { return vr.TEST_VID.canPlayType(e) } catch (t) { return "" } }, vr.nativeSourceHandler.canHandleSource = function (e, t) { if (e.type) return vr.nativeSourceHandler.canPlayType(e.type); if (e.src) { var i = pi(e.src); return vr.nativeSourceHandler.canPlayType("video/" + i) } return "" }, vr.nativeSourceHandler.handleSource = function (e, t, i) { t.setSrc(e.src) }, vr.nativeSourceHandler.dispose = function () { }, vr.registerSourceHandler(vr.nativeSourceHandler), Pi.registerTech("Html5", vr); var Tr = ["progress", "abort", "suspend", "emptied", "stalled", "loadedmetadata", "loadeddata", "timeupdate", "resize", "volumechange", "texttrackchange"], kr = { canplay: "CanPlay", canplaythrough: "CanPlayThrough", playing: "Playing", seeked: "Seeked" }, Sr = ["tiny", "xsmall", "small", "medium", "large", "xlarge", "huge"], Cr = {}; Sr.forEach((function (e) { var t = "x" === e.charAt(0) ? "x-" + e.substring(1) : e; Cr[e] = "vjs-layout-" + t })); var Er = { tiny: 210, xsmall: 320, small: 425, medium: 768, large: 1440, xlarge: 2560, huge: 1 / 0 }, wr = function (e) { function t(i, n, r) { var a; if (i.id = i.id || n.id || "vjs_video_" + Pe(), (n = B(t.getTagSettings(i), n)).initChildren = !1, n.createEl = !1, n.evented = !1, n.reportTouchActivity = !1, !n.language) if ("function" === typeof i.closest) { var s = i.closest("[lang]"); s && s.getAttribute && (n.language = s.getAttribute("lang")) } else for (var o = i; o && 1 === o.nodeType;) { if (ee(o).hasOwnProperty("lang")) { n.language = o.getAttribute("lang"); break } o = o.parentNode } if ((a = e.call(this, null, n, r) || this).boundDocumentFullscreenChange_ = qe(ct(a), a.documentFullscreenChange_), a.boundFullWindowOnEscKey_ = qe(ct(a), a.fullWindowOnEscKey), a.log = O(a.id_), a.fsApi_ = Ut, a.isPosterFromTech_ = !1, a.queuedCallbacks_ = [], a.isReady_ = !1, a.hasStarted_ = !1, a.userActive_ = !1, !a.options_ || !a.options_.techOrder || !a.options_.techOrder.length) throw new Error("No techOrder specified. Did you overwrite videojs.options instead of just changing the properties you want to override?"); if (a.tag = i, a.tagAttributes = i && ee(i), a.language(a.options_.language), n.languages) { var l = {}; Object.getOwnPropertyNames(n.languages).forEach((function (e) { l[e.toLowerCase()] = n.languages[e] })), a.languages_ = l } else a.languages_ = t.prototype.options_.languages; a.resetCache_(), a.poster_ = n.poster || "", a.controls_ = !!n.controls, i.controls = !1, i.removeAttribute("controls"), a.changingSrc_ = !1, a.playCallbacks_ = [], a.playTerminatedQueue_ = [], i.hasAttribute("autoplay") ? a.autoplay(!0) : a.autoplay(a.options_.autoplay), n.plugins && Object.keys(n.plugins).forEach((function (e) { if ("function" !== typeof a[e]) throw new Error('plugin "' + e + '" does not exist') })), a.scrubbing_ = !1, a.el_ = a.createEl(), et(ct(a), { eventBusKey: "el_" }), a.fluid_ && a.on("playerreset", a.updateStyleEl_); var u = at(a.options_); n.plugins && Object.keys(n.plugins).forEach((function (e) { a[e](n.plugins[e]) })), a.options_.playerOptions = u, a.middleware_ = [], a.initChildren(), a.isAudio("audio" === i.nodeName.toLowerCase()), a.controls() ? a.addClass("vjs-controls-enabled") : a.addClass("vjs-controls-disabled"), a.el_.setAttribute("role", "region"), a.isAudio() ? a.el_.setAttribute("aria-label", a.localize("Audio Player")) : a.el_.setAttribute("aria-label", a.localize("Video Player")), a.isAudio() && a.addClass("vjs-audio"), a.flexNotSupported_() && a.addClass("vjs-no-flex"), It && a.addClass("vjs-touch-enabled"), vt || a.addClass("vjs-workinghover"), t.players[a.id_] = ct(a); var c = L.split(".")[0]; return a.addClass("vjs-v" + c), a.userActive(!0), a.reportUserActivity(), a.one("play", a.listenForUserActivity_), a.on("stageclick", a.handleStageClick_), a.on("keydown", a.handleKeyDown), a.breakpoints(a.options_.breakpoints), a.responsive(a.options_.responsive), a } ot(t, e); var i = t.prototype; return i.dispose = function () { var i = this; this.trigger("dispose"), this.off("dispose"), Re(s.a, this.fsApi_.fullscreenchange, this.boundDocumentFullscreenChange_), Re(s.a, "keydown", this.boundFullWindowOnEscKey_), this.styleEl_ && this.styleEl_.parentNode && (this.styleEl_.parentNode.removeChild(this.styleEl_), this.styleEl_ = null), t.players[this.id_] = null, this.tag && this.tag.player && (this.tag.player = null), this.el_ && this.el_.player && (this.el_.player = null), this.tech_ && (this.tech_.dispose(), this.isPosterFromTech_ = !1, this.poster_ = ""), this.playerElIngest_ && (this.playerElIngest_ = null), this.tag && (this.tag = null), Ai[this.id()] = null, wi.names.forEach((function (e) { var t = wi[e], n = i[t.getterName](); n && n.off && n.off() })), e.prototype.dispose.call(this) }, i.createEl = function () { var t, i = this.tag, n = this.playerElIngest_ = i.parentNode && i.parentNode.hasAttribute && i.parentNode.hasAttribute("data-vjs-player"), a = "video-js" === this.tag.tagName.toLowerCase(); n ? t = this.el_ = i.parentNode : a || (t = this.el_ = e.prototype.createEl.call(this, "div")); var o = ee(i); if (a) { for (t = this.el_ = i, i = this.tag = s.a.createElement("video"); t.children.length;)i.appendChild(t.firstChild); X(t, "video-js") || $(t, "video-js"), t.appendChild(i), n = this.playerElIngest_ = t, Object.keys(t).forEach((function (e) { try { i[e] = t[e] } catch (n) { } })) } if (i.setAttribute("tabindex", "-1"), o.tabindex = "-1", (wt || Ct && At) && (i.setAttribute("role", "application"), o.role = "application"), i.removeAttribute("width"), i.removeAttribute("height"), "width" in o && delete o.width, "height" in o && delete o.height, Object.getOwnPropertyNames(o).forEach((function (e) { a && "class" === e || t.setAttribute(e, o[e]), a && i.setAttribute(e, o[e]) })), i.playerId = i.id, i.id += "_html5_api", i.className = "vjs-tech", i.player = t.player = this, this.addClass("vjs-paused"), !0 !== r.a.VIDEOJS_NO_DYNAMIC_STYLE) { this.styleEl_ = Ce("vjs-styles-dimensions"); var l = ge(".vjs-styles-defaults"), u = ge("head"); u.insertBefore(this.styleEl_, l ? l.nextSibling : u.firstChild) } this.fill_ = !1, this.fluid_ = !1, this.width(this.options_.width), this.height(this.options_.height), this.fill(this.options_.fill), this.fluid(this.options_.fluid), this.aspectRatio(this.options_.aspectRatio); for (var c = i.getElementsByTagName("a"), h = 0; h < c.length; h++) { var d = c.item(h); $(d, "vjs-hidden"), d.setAttribute("hidden", "hidden") } return i.initNetworkState_ = i.networkState, i.parentNode && !n && i.parentNode.insertBefore(t, i), Y(i, t), this.children_.unshift(i), this.el_.setAttribute("lang", this.language_), this.el_ = t, t }, i.width = function (e) { return this.dimension("width", e) }, i.height = function (e) { return this.dimension("height", e) }, i.dimension = function (e, t) { var i = e + "_"; if (void 0 === t) return this[i] || 0; if ("" === t) return this[i] = void 0, void this.updateStyleEl_(); var n = parseFloat(t); isNaN(n) ? x.error('Improper value "' + t + '" supplied for for ' + e) : (this[i] = n, this.updateStyleEl_()) }, i.fluid = function (e) { if (void 0 === e) return !!this.fluid_; var t, i; this.fluid_ = !!e, Ge(this) && this.off("playerreset", this.updateStyleEl_), e ? (this.addClass("vjs-fluid"), this.fill(!1), Ge(t = function () { this.on("playerreset", this.updateStyleEl_) }) ? i() : (t.eventedCallbacks || (t.eventedCallbacks = []), t.eventedCallbacks.push(i))) : this.removeClass("vjs-fluid"), this.updateStyleEl_() }, i.fill = function (e) { if (void 0 === e) return !!this.fill_; this.fill_ = !!e, e ? (this.addClass("vjs-fill"), this.fluid(!1)) : this.removeClass("vjs-fill") }, i.aspectRatio = function (e) { if (void 0 === e) return this.aspectRatio_; if (!/^\d+\:\d+$/.test(e)) throw new Error("Improper value supplied for aspect ratio. The format should be width:height, for example 16:9."); this.aspectRatio_ = e, this.fluid(!0), this.updateStyleEl_() }, i.updateStyleEl_ = function () { if (!0 !== r.a.VIDEOJS_NO_DYNAMIC_STYLE) { var e, t, i, n = (void 0 !== this.aspectRatio_ && "auto" !== this.aspectRatio_ ? this.aspectRatio_ : this.videoWidth() > 0 ? this.videoWidth() + ":" + this.videoHeight() : "16:9").split(":"), a = n[1] / n[0]; e = void 0 !== this.width_ ? this.width_ : void 0 !== this.height_ ? this.height_ / a : this.videoWidth() || 300, t = void 0 !== this.height_ ? this.height_ : e * a, i = /^[^a-zA-Z]/.test(this.id()) ? "dimensions-" + this.id() : this.id() + "-dimensions", this.addClass(i), Ee(this.styleEl_, "\n      ." + i + " {\n        width: " + e + "px;\n        height: " + t + "px;\n      }\n\n      ." + i + ".vjs-fluid {\n        padding-top: " + 100 * a + "%;\n      }\n    ") } else { var s = "number" === typeof this.width_ ? this.width_ : this.options_.width, o = "number" === typeof this.height_ ? this.height_ : this.options_.height, l = this.tech_ && this.tech_.el(); l && (s >= 0 && (l.width = s), o >= 0 && (l.height = o)) } }, i.loadTech_ = function (e, t) { var i = this; this.tech_ && this.unloadTech_(); var n = rt(e), r = e.charAt(0).toLowerCase() + e.slice(1); "Html5" !== n && this.tag && (Pi.getTech("Html5").disposeMediaElement(this.tag), this.tag.player = null, this.tag = null), this.techName_ = n, this.isReady_ = !1; var a = { source: t, autoplay: "string" !== typeof this.autoplay() && this.autoplay(), nativeControlsForTouch: this.options_.nativeControlsForTouch, playerId: this.id(), techId: this.id() + "_" + r + "_api", playsinline: this.options_.playsinline, preload: this.options_.preload, loop: this.options_.loop, muted: this.options_.muted, poster: this.poster(), language: this.language(), playerElIngest: this.playerElIngest_ || !1, "vtt.js": this.options_["vtt.js"], canOverridePoster: !!this.options_.techCanOverridePoster, enableSourceset: this.options_.enableSourceset, Promise: this.options_.Promise }; wi.names.forEach((function (e) { var t = wi[e]; a[t.getterName] = i[t.privateName] })), B(a, this.options_[n]), B(a, this.options_[r]), B(a, this.options_[e.toLowerCase()]), this.tag && (a.tag = this.tag), t && t.src === this.cache_.src && this.cache_.currentTime > 0 && (a.startTime = this.cache_.currentTime); var s = Pi.getTech(e); if (!s) throw new Error("No Tech named '" + n + "' exists! '" + n + "' should be registered using videojs.registerTech()'"); this.tech_ = new s(a), this.tech_.ready(qe(this, this.handleTechReady_), !0), Yt(this.textTracksJson_ || [], this.tech_), Tr.forEach((function (e) { i.on(i.tech_, e, i["handleTech" + rt(e) + "_"]) })), Object.keys(kr).forEach((function (e) { i.on(i.tech_, e, (function (t) { 0 === i.tech_.playbackRate() && i.tech_.seeking() ? i.queuedCallbacks_.push({ callback: i["handleTech" + kr[e] + "_"].bind(i), event: t }) : i["handleTech" + kr[e] + "_"](t) })) })), this.on(this.tech_, "loadstart", this.handleTechLoadStart_), this.on(this.tech_, "sourceset", this.handleTechSourceset_), this.on(this.tech_, "waiting", this.handleTechWaiting_), this.on(this.tech_, "ended", this.handleTechEnded_), this.on(this.tech_, "seeking", this.handleTechSeeking_), this.on(this.tech_, "play", this.handleTechPlay_), this.on(this.tech_, "firstplay", this.handleTechFirstPlay_), this.on(this.tech_, "pause", this.handleTechPause_), this.on(this.tech_, "durationchange", this.handleTechDurationChange_), this.on(this.tech_, "fullscreenchange", this.handleTechFullscreenChange_), this.on(this.tech_, "enterpictureinpicture", this.handleTechEnterPictureInPicture_), this.on(this.tech_, "leavepictureinpicture", this.handleTechLeavePictureInPicture_), this.on(this.tech_, "error", this.handleTechError_), this.on(this.tech_, "loadedmetadata", this.updateStyleEl_), this.on(this.tech_, "posterchange", this.handleTechPosterChange_), this.on(this.tech_, "textdata", this.handleTechTextData_), this.on(this.tech_, "ratechange", this.handleTechRateChange_), this.usingNativeControls(this.techGet_("controls")), this.controls() && !this.usingNativeControls() && this.addTechControlsListeners_(), this.tech_.el().parentNode === this.el() || "Html5" === n && this.tag || Y(this.tech_.el(), this.el()), this.tag && (this.tag.player = null, this.tag = null) }, i.unloadTech_ = function () { var e = this; wi.names.forEach((function (t) { var i = wi[t]; e[i.privateName] = e[i.getterName]() })), this.textTracksJson_ = Kt(this.tech_), this.isReady_ = !1, this.tech_.dispose(), this.tech_ = !1, this.isPosterFromTech_ && (this.poster_ = "", this.trigger("posterchange")), this.isPosterFromTech_ = !1 }, i.tech = function (e) { return void 0 === e && x.warn("Using the tech directly can be dangerous. I hope you know what you're doing.\nSee https://github.com/videojs/video.js/issues/2617 for more info.\n"), this.tech_ }, i.addTechControlsListeners_ = function () { this.removeTechControlsListeners_(), this.on(this.tech_, "mouseup", this.handleTechClick_), this.on(this.tech_, "dblclick", this.handleTechDoubleClick_), this.on(this.tech_, "touchstart", this.handleTechTouchStart_), this.on(this.tech_, "touchmove", this.handleTechTouchMove_), this.on(this.tech_, "touchend", this.handleTechTouchEnd_), this.on(this.tech_, "tap", this.handleTechTap_) }, i.removeTechControlsListeners_ = function () { this.off(this.tech_, "tap", this.handleTechTap_), this.off(this.tech_, "touchstart", this.handleTechTouchStart_), this.off(this.tech_, "touchmove", this.handleTechTouchMove_), this.off(this.tech_, "touchend", this.handleTechTouchEnd_), this.off(this.tech_, "mouseup", this.handleTechClick_), this.off(this.tech_, "dblclick", this.handleTechDoubleClick_) }, i.handleTechReady_ = function () { this.triggerReady(), this.cache_.volume && this.techCall_("setVolume", this.cache_.volume), this.handleTechPosterChange_(), this.handleTechDurationChange_() }, i.handleTechLoadStart_ = function () { this.removeClass("vjs-ended"), this.removeClass("vjs-seeking"), this.error(null), this.handleTechDurationChange_(), this.paused() ? (this.hasStarted(!1), this.trigger("loadstart")) : (this.trigger("loadstart"), this.trigger("firstplay")), this.manualAutoplay_(this.autoplay()) }, i.manualAutoplay_ = function (e) { var t = this; if (this.tech_ && "string" === typeof e) { var i, n = function () { var e = t.muted(); t.muted(!0); var i = function () { t.muted(e) }; t.playTerminatedQueue_.push(i); var n = t.play(); if (Wt(n)) return n.catch(i) }; if ("any" === e && !0 !== this.muted() ? Wt(i = this.play()) && (i = i.catch(n)) : i = "muted" === e && !0 !== this.muted() ? n() : this.play(), Wt(i)) return i.then((function () { t.trigger({ type: "autoplay-success", autoplay: e }) })).catch((function (i) { t.trigger({ type: "autoplay-failure", autoplay: e }) })) } }, i.updateSourceCaches_ = function (e) { void 0 === e && (e = ""); var t = e, i = ""; "string" !== typeof t && (t = e.src, i = e.type), this.cache_.source = this.cache_.source || {}, this.cache_.sources = this.cache_.sources || [], t && !i && (i = function (e, t) { if (!t) return ""; if (e.cache_.source.src === t && e.cache_.source.type) return e.cache_.source.type; var i = e.cache_.sources.filter((function (e) { return e.src === t })); if (i.length) return i[0].type; for (var n = e.$$("source"), r = 0; r < n.length; r++) { var a = n[r]; if (a.type && a.src && a.src === t) return a.type } return ji(t) }(this, t)), this.cache_.source = at({}, e, { src: t, type: i }); for (var n = this.cache_.sources.filter((function (e) { return e.src && e.src === t })), r = [], a = this.$$("source"), s = [], o = 0; o < a.length; o++) { var l = ee(a[o]); r.push(l), l.src && l.src === t && s.push(l.src) } s.length && !n.length ? this.cache_.sources = r : n.length || (this.cache_.sources = [this.cache_.source]), this.cache_.src = t }, i.handleTechSourceset_ = function (e) { var t = this; if (!this.changingSrc_) { var i = function (e) { return t.updateSourceCaches_(e) }, n = this.currentSource().src, r = e.src; n && !/^blob:/.test(n) && /^blob:/.test(r) && (!this.lastSource_ || this.lastSource_.tech !== r && this.lastSource_.player !== n) && (i = function () { }), i(r), e.src || this.tech_.any(["sourceset", "loadstart"], (function (e) { if ("sourceset" !== e.type) { var i = t.techGet("currentSrc"); t.lastSource_.tech = i, t.updateSourceCaches_(i) } })) } this.lastSource_ = { player: this.currentSource().src, tech: e.src }, this.trigger({ src: e.src, type: "sourceset" }) }, i.hasStarted = function (e) { if (void 0 === e) return this.hasStarted_; e !== this.hasStarted_ && (this.hasStarted_ = e, this.hasStarted_ ? (this.addClass("vjs-has-started"), this.trigger("firstplay")) : this.removeClass("vjs-has-started")) }, i.handleTechPlay_ = function () { this.removeClass("vjs-ended"), this.removeClass("vjs-paused"), this.addClass("vjs-playing"), this.hasStarted(!0), this.trigger("play") }, i.handleTechRateChange_ = function () { this.tech_.playbackRate() > 0 && 0 === this.cache_.lastPlaybackRate && (this.queuedCallbacks_.forEach((function (e) { return e.callback(e.event) })), this.queuedCallbacks_ = []), this.cache_.lastPlaybackRate = this.tech_.playbackRate(), this.trigger("ratechange") }, i.handleTechWaiting_ = function () { var e = this; this.addClass("vjs-waiting"), this.trigger("waiting"); var t = this.currentTime(); this.on("timeupdate", (function i() { t !== e.currentTime() && (e.removeClass("vjs-waiting"), e.off("timeupdate", i)) })) }, i.handleTechCanPlay_ = function () { this.removeClass("vjs-waiting"), this.trigger("canplay") }, i.handleTechCanPlayThrough_ = function () { this.removeClass("vjs-waiting"), this.trigger("canplaythrough") }, i.handleTechPlaying_ = function () { this.removeClass("vjs-waiting"), this.trigger("playing") }, i.handleTechSeeking_ = function () { this.addClass("vjs-seeking"), this.trigger("seeking") }, i.handleTechSeeked_ = function () { this.removeClass("vjs-seeking"), this.removeClass("vjs-ended"), this.trigger("seeked") }, i.handleTechFirstPlay_ = function () { this.options_.starttime && (x.warn("Passing the `starttime` option to the player will be deprecated in 6.0"), this.currentTime(this.options_.starttime)), this.addClass("vjs-has-started"), this.trigger("firstplay") }, i.handleTechPause_ = function () { this.removeClass("vjs-playing"), this.addClass("vjs-paused"), this.trigger("pause") }, i.handleTechEnded_ = function () { this.addClass("vjs-ended"), this.options_.loop ? (this.currentTime(0), this.play()) : this.paused() || this.pause(), this.trigger("ended") }, i.handleTechDurationChange_ = function () { this.duration(this.techGet_("duration")) }, i.handleTechClick_ = function (e) { fe(e) && this.controls_ && (this.paused() ? zt(this.play()) : this.pause()) }, i.handleTechDoubleClick_ = function (e) { this.controls_ && (Array.prototype.some.call(this.$$(".vjs-control-bar, .vjs-modal-dialog"), (function (t) { return t.contains(e.target) })) || void 0 !== this.options_ && void 0 !== this.options_.userActions && void 0 !== this.options_.userActions.doubleClick && !1 === this.options_.userActions.doubleClick || (void 0 !== this.options_ && void 0 !== this.options_.userActions && "function" === typeof this.options_.userActions.doubleClick ? this.options_.userActions.doubleClick.call(this, e) : this.isFullscreen() ? this.exitFullscreen() : this.requestFullscreen())) }, i.handleTechTap_ = function () { this.userActive(!this.userActive()) }, i.handleTechTouchStart_ = function () { this.userWasActive = this.userActive() }, i.handleTechTouchMove_ = function () { this.userWasActive && this.reportUserActivity() }, i.handleTechTouchEnd_ = function (e) { e.preventDefault() }, i.handleStageClick_ = function () { this.reportUserActivity() }, i.toggleFullscreenClass_ = function () { this.isFullscreen() ? this.addClass("vjs-fullscreen") : this.removeClass("vjs-fullscreen") }, i.documentFullscreenChange_ = function (e) { var t = this.el(), i = s.a[this.fsApi_.fullscreenElement] === t; !i && t.matches ? i = t.matches(":" + this.fsApi_.fullscreen) : !i && t.msMatchesSelector && (i = t.msMatchesSelector(":" + this.fsApi_.fullscreen)), this.isFullscreen(i), !1 === this.isFullscreen() && Re(s.a, this.fsApi_.fullscreenchange, this.boundDocumentFullscreenChange_), this.fsApi_.prefixed && this.trigger("fullscreenchange") }, i.handleTechFullscreenChange_ = function (e, t) { t && this.isFullscreen(t.isFullscreen), this.trigger("fullscreenchange") }, i.togglePictureInPictureClass_ = function () { this.isInPictureInPicture() ? this.addClass("vjs-picture-in-picture") : this.removeClass("vjs-picture-in-picture") }, i.handleTechEnterPictureInPicture_ = function (e) { this.isInPictureInPicture(!0) }, i.handleTechLeavePictureInPicture_ = function (e) { this.isInPictureInPicture(!1) }, i.handleTechError_ = function () { var e = this.tech_.error(); this.error(e) }, i.handleTechTextData_ = function () { var e = null; arguments.length > 1 && (e = arguments[1]), this.trigger("textdata", e) }, i.getCache = function () { return this.cache_ }, i.resetCache_ = function () { this.cache_ = { currentTime: 0, inactivityTimeout: this.options_.inactivityTimeout, duration: NaN, lastVolume: 1, lastPlaybackRate: this.defaultPlaybackRate(), media: null, src: "", source: {}, sources: [], volume: 1 } }, i.techCall_ = function (e, t) { this.ready((function () { if (e in Mi) return function (e, t, i, n) { return t[i](e.reduce(Bi(i), n)) }(this.middleware_, this.tech_, e, t); if (e in Ri) return Oi(this.middleware_, this.tech_, e, t); try { this.tech_ && this.tech_[e](t) } catch (i) { throw x(i), i } }), !0) }, i.techGet_ = function (e) { if (this.tech_ && this.tech_.isReady_) { if (e in Di) return function (e, t, i) { return e.reduceRight(Bi(i), t[i]()) }(this.middleware_, this.tech_, e); if (e in Ri) return Oi(this.middleware_, this.tech_, e); try { return this.tech_[e]() } catch (t) { if (void 0 === this.tech_[e]) throw x("Video.js: " + e + " method not defined for " + this.techName_ + " playback technology.", t), t; if ("TypeError" === t.name) throw x("Video.js: " + e + " unavailable on " + this.techName_ + " playback technology element.", t), this.tech_.isReady_ = !1, t; throw x(t), t } } }, i.play = function () { var e = this, t = this.options_.Promise || r.a.Promise; return t ? new t((function (t) { e.play_(t) })) : this.play_() }, i.play_ = function (e) { var t = this; void 0 === e && (e = zt), this.playCallbacks_.push(e); var i = Boolean(!this.changingSrc_ && (this.src() || this.currentSrc())); if (this.waitToPlay_ && (this.off(["ready", "loadstart"], this.waitToPlay_), this.waitToPlay_ = null), !this.isReady_ || !i) return this.waitToPlay_ = function (e) { t.play_() }, this.one(["ready", "loadstart"], this.waitToPlay_), void (i || !Lt && !vt || this.load()); var n = this.techGet_("play"); null === n ? this.runPlayTerminatedQueue_() : this.runPlayCallbacks_(n) }, i.runPlayTerminatedQueue_ = function () { var e = this.playTerminatedQueue_.slice(0); this.playTerminatedQueue_ = [], e.forEach((function (e) { e() })) }, i.runPlayCallbacks_ = function (e) { var t = this.playCallbacks_.slice(0); this.playCallbacks_ = [], this.playTerminatedQueue_ = [], t.forEach((function (t) { t(e) })) }, i.pause = function () { this.techCall_("pause") }, i.paused = function () { return !1 !== this.techGet_("paused") }, i.played = function () { return this.techGet_("played") || Mt(0, 0) }, i.scrubbing = function (e) { if ("undefined" === typeof e) return this.scrubbing_; this.scrubbing_ = !!e, e ? this.addClass("vjs-scrubbing") : this.removeClass("vjs-scrubbing") }, i.currentTime = function (e) { return "undefined" !== typeof e ? (e < 0 && (e = 0), void this.techCall_("setCurrentTime", e)) : (this.cache_.currentTime = this.techGet_("currentTime") || 0, this.cache_.currentTime) }, i.duration = function (e) { if (void 0 === e) return void 0 !== this.cache_.duration ? this.cache_.duration : NaN; (e = parseFloat(e)) < 0 && (e = 1 / 0), e !== this.cache_.duration && (this.cache_.duration = e, e === 1 / 0 ? (this.addClass("vjs-live"), this.options_.liveui && this.player_.liveTracker && this.addClass("vjs-liveui")) : (this.removeClass("vjs-live"), this.removeClass("vjs-liveui")), isNaN(e) || this.trigger("durationchange")) }, i.remainingTime = function () { return this.duration() - this.currentTime() }, i.remainingTimeDisplay = function () { return Math.floor(this.duration()) - Math.floor(this.currentTime()) }, i.buffered = function () { var e = this.techGet_("buffered"); return e && e.length || (e = Mt(0, 0)), e }, i.bufferedPercent = function () { return Rt(this.buffered(), this.duration()) }, i.bufferedEnd = function () { var e = this.buffered(), t = this.duration(), i = e.end(e.length - 1); return i > t && (i = t), i }, i.volume = function (e) { var t; return void 0 !== e ? (t = Math.max(0, Math.min(1, parseFloat(e))), this.cache_.volume = t, this.techCall_("setVolume", t), void (t > 0 && this.lastVolume_(t))) : (t = parseFloat(this.techGet_("volume")), isNaN(t) ? 1 : t) }, i.muted = function (e) { if (void 0 === e) return this.techGet_("muted") || !1; this.techCall_("setMuted", e) }, i.defaultMuted = function (e) { return void 0 !== e ? this.techCall_("setDefaultMuted", e) : this.techGet_("defaultMuted") || !1 }, i.lastVolume_ = function (e) { if (void 0 === e || 0 === e) return this.cache_.lastVolume; this.cache_.lastVolume = e }, i.supportsFullScreen = function () { return this.techGet_("supportsFullScreen") || !1 }, i.isFullscreen = function (e) { return void 0 !== e ? (this.isFullscreen_ = !!e, void this.toggleFullscreenClass_()) : !!this.isFullscreen_ }, i.requestFullscreen = function (e) { var t; this.isFullscreen(!0), this.fsApi_.requestFullscreen ? (Me(s.a, this.fsApi_.fullscreenchange, this.boundDocumentFullscreenChange_), this.fsApi_.prefixed || (t = this.options_.fullscreen && this.options_.fullscreen.options || {}, void 0 !== e && (t = e)), zt(this.el_[this.fsApi_.requestFullscreen](t))) : this.tech_.supportsFullScreen() ? this.techCall_("enterFullScreen") : (this.enterFullWindow(), this.trigger("fullscreenchange")) }, i.exitFullscreen = function () { this.isFullscreen(!1), this.fsApi_.requestFullscreen ? zt(s.a[this.fsApi_.exitFullscreen]()) : this.tech_.supportsFullScreen() ? this.techCall_("exitFullScreen") : (this.exitFullWindow(), this.trigger("fullscreenchange")) }, i.enterFullWindow = function () { this.isFullWindow = !0, this.docOrigOverflow = s.a.documentElement.style.overflow, Me(s.a, "keydown", this.boundFullWindowOnEscKey_), s.a.documentElement.style.overflow = "hidden", $(s.a.body, "vjs-full-window"), this.trigger("enterFullWindow") }, i.fullWindowOnEscKey = function (e) { c.a.isEventKey(e, "Esc") && (!0 === this.isFullscreen() ? this.exitFullscreen() : this.exitFullWindow()) }, i.exitFullWindow = function () { this.isFullWindow = !1, Re(s.a, "keydown", this.boundFullWindowOnEscKey_), s.a.documentElement.style.overflow = this.docOrigOverflow, Q(s.a.body, "vjs-full-window"), this.trigger("exitFullWindow") }, i.isInPictureInPicture = function (e) { return void 0 !== e ? (this.isInPictureInPicture_ = !!e, void this.togglePictureInPictureClass_()) : !!this.isInPictureInPicture_ }, i.requestPictureInPicture = function () { if ("pictureInPictureEnabled" in s.a) return this.techGet_("requestPictureInPicture") }, i.exitPictureInPicture = function () { if ("pictureInPictureEnabled" in s.a) return s.a.exitPictureInPicture() }, i.handleKeyDown = function (e) { var t = this.options_.userActions; if (t && t.hotkeys) { (function (e) { var t = e.tagName.toLowerCase(); if (e.isContentEditable) return !0; if ("input" === t) return -1 === ["button", "checkbox", "hidden", "radio", "reset", "submit"].indexOf(e.type); return -1 !== ["textarea"].indexOf(t) })(this.el_.ownerDocument.activeElement) || ("function" === typeof t.hotkeys ? t.hotkeys.call(this, e) : this.handleHotkeys(e)) } }, i.handleHotkeys = function (e) { var t = this.options_.userActions ? this.options_.userActions.hotkeys : {}, i = t.fullscreenKey, n = void 0 === i ? function (e) { return c.a.isEventKey(e, "f") } : i, r = t.muteKey, a = void 0 === r ? function (e) { return c.a.isEventKey(e, "m") } : r, o = t.playPauseKey, l = void 0 === o ? function (e) { return c.a.isEventKey(e, "k") || c.a.isEventKey(e, "Space") } : o; if (n.call(this, e)) { e.preventDefault(), e.stopPropagation(); var u = st.getComponent("FullscreenToggle"); !1 !== s.a[this.fsApi_.fullscreenEnabled] && u.prototype.handleClick.call(this, e) } else if (a.call(this, e)) { e.preventDefault(), e.stopPropagation(), st.getComponent("MuteToggle").prototype.handleClick.call(this, e) } else if (l.call(this, e)) { e.preventDefault(), e.stopPropagation(), st.getComponent("PlayToggle").prototype.handleClick.call(this, e) } }, i.canPlayType = function (e) { for (var t, i = 0, n = this.options_.techOrder; i < n.length; i++) { var r = n[i], a = Pi.getTech(r); if (a || (a = st.getComponent(r)), a) { if (a.isSupported() && (t = a.canPlayType(e))) return t } else x.error('The "' + r + '" tech is undefined. Skipped browser support check for that tech.') } return "" }, i.selectSource = function (e) { var t, i = this, n = this.options_.techOrder.map((function (e) { return [e, Pi.getTech(e)] })).filter((function (e) { var t = e[0], i = e[1]; return i ? i.isSupported() : (x.error('The "' + t + '" tech is undefined. Skipped browser support check for that tech.'), !1) })), r = function (e, t, i) { var n; return e.some((function (e) { return t.some((function (t) { if (n = i(e, t)) return !0 })) })), n }, a = function (e, t) { var n = e[0]; if (e[1].canPlaySource(t, i.options_[n.toLowerCase()])) return { source: t, tech: n } }; return (this.options_.sourceOrder ? r(e, n, (t = a, function (e, i) { return t(i, e) })) : r(n, e, a)) || !1 }, i.src = function (e) { var t = this; if ("undefined" === typeof e) return this.cache_.src || ""; var i = function e(t) { if (Array.isArray(t)) { var i = []; t.forEach((function (t) { t = e(t), Array.isArray(t) ? i = i.concat(t) : U(t) && i.push(t) })), t = i } else t = "string" === typeof t && t.trim() ? [Ni({ src: t })] : U(t) && "string" === typeof t.src && t.src && t.src.trim() ? [Ni(t)] : []; return t }(e); i.length ? (this.changingSrc_ = !0, this.cache_.sources = i, this.updateSourceCaches_(i[0]), xi(this, i[0], (function (e, n) { var r, a; if (t.middleware_ = n, t.cache_.sources = i, t.updateSourceCaches_(e), t.src_(e)) return i.length > 1 ? t.src(i.slice(1)) : (t.changingSrc_ = !1, t.setTimeout((function () { this.error({ code: 4, message: this.localize(this.options_.notSupportedMessage) }) }), 0), void t.triggerReady()); r = n, a = t.tech_, r.forEach((function (e) { return e.setTech && e.setTech(a) })) }))) : this.setTimeout((function () { this.error({ code: 4, message: this.localize(this.options_.notSupportedMessage) }) }), 0) }, i.src_ = function (e) { var t, i, n = this, r = this.selectSource([e]); return !r || (t = r.tech, i = this.techName_, rt(t) !== rt(i) ? (this.changingSrc_ = !0, this.loadTech_(r.tech, r.source), this.tech_.ready((function () { n.changingSrc_ = !1 })), !1) : (this.ready((function () { this.tech_.constructor.prototype.hasOwnProperty("setSource") ? this.techCall_("setSource", e) : this.techCall_("src", e.src), this.changingSrc_ = !1 }), !0), !1)) }, i.load = function () { this.techCall_("load") }, i.reset = function () { var e = this, t = this.options_.Promise || r.a.Promise; this.paused() || !t ? this.doReset_() : zt(this.play().then((function () { return e.doReset_() }))) }, i.doReset_ = function () { this.tech_ && this.tech_.clearTracks("text"), this.resetCache_(), this.poster(""), this.loadTech_(this.options_.techOrder[0], null), this.techCall_("reset"), this.resetControlBarUI_(), Ge(this) && this.trigger("playerreset") }, i.resetControlBarUI_ = function () { this.resetProgressBar_(), this.resetPlaybackRate_(), this.resetVolumeBar_() }, i.resetProgressBar_ = function () { this.currentTime(0); var e = this.controlBar, t = e.durationDisplay, i = e.remainingTimeDisplay; t && t.updateContent(), i && i.updateContent() }, i.resetPlaybackRate_ = function () { this.playbackRate(this.defaultPlaybackRate()), this.handleTechRateChange_() }, i.resetVolumeBar_ = function () { this.volume(1), this.trigger("volumechange") }, i.currentSources = function () { var e = this.currentSource(), t = []; return 0 !== Object.keys(e).length && t.push(e), this.cache_.sources || t }, i.currentSource = function () { return this.cache_.source || {} }, i.currentSrc = function () { return this.currentSource() && this.currentSource().src || "" }, i.currentType = function () { return this.currentSource() && this.currentSource().type || "" }, i.preload = function (e) { return void 0 !== e ? (this.techCall_("setPreload", e), void (this.options_.preload = e)) : this.techGet_("preload") }, i.autoplay = function (e) { if (void 0 === e) return this.options_.autoplay || !1; var t; "string" === typeof e && /(any|play|muted)/.test(e) ? (this.options_.autoplay = e, this.manualAutoplay_(e), t = !1) : this.options_.autoplay = !!e, t = "undefined" === typeof t ? this.options_.autoplay : t, this.tech_ && this.techCall_("setAutoplay", t) }, i.playsinline = function (e) { return void 0 !== e ? (this.techCall_("setPlaysinline", e), this.options_.playsinline = e, this) : this.techGet_("playsinline") }, i.loop = function (e) { return void 0 !== e ? (this.techCall_("setLoop", e), void (this.options_.loop = e)) : this.techGet_("loop") }, i.poster = function (e) { if (void 0 === e) return this.poster_; e || (e = ""), e !== this.poster_ && (this.poster_ = e, this.techCall_("setPoster", e), this.isPosterFromTech_ = !1, this.trigger("posterchange")) }, i.handleTechPosterChange_ = function () { if ((!this.poster_ || this.options_.techCanOverridePoster) && this.tech_ && this.tech_.poster) { var e = this.tech_.poster() || ""; e !== this.poster_ && (this.poster_ = e, this.isPosterFromTech_ = !0, this.trigger("posterchange")) } }, i.controls = function (e) { if (void 0 === e) return !!this.controls_; e = !!e, this.controls_ !== e && (this.controls_ = e, this.usingNativeControls() && this.techCall_("setControls", e), this.controls_ ? (this.removeClass("vjs-controls-disabled"), this.addClass("vjs-controls-enabled"), this.trigger("controlsenabled"), this.usingNativeControls() || this.addTechControlsListeners_()) : (this.removeClass("vjs-controls-enabled"), this.addClass("vjs-controls-disabled"), this.trigger("controlsdisabled"), this.usingNativeControls() || this.removeTechControlsListeners_())) }, i.usingNativeControls = function (e) { if (void 0 === e) return !!this.usingNativeControls_; e = !!e, this.usingNativeControls_ !== e && (this.usingNativeControls_ = e, this.usingNativeControls_ ? (this.addClass("vjs-using-native-controls"), this.trigger("usingnativecontrols")) : (this.removeClass("vjs-using-native-controls"), this.trigger("usingcustomcontrols"))) }, i.error = function (e) { if (void 0 === e) return this.error_ || null; if (this.options_.suppressNotSupportedError && e && e.message && e.message === this.localize(this.options_.notSupportedMessage)) { var t = function () { this.error(e) }; return this.options_.suppressNotSupportedError = !1, this.any(["click", "touchstart"], t), void this.one("loadstart", (function () { this.off(["click", "touchstart"], t) })) } if (null === e) return this.error_ = e, this.removeClass("vjs-error"), void (this.errorDisplay && this.errorDisplay.close()); this.error_ = new qt(e), this.addClass("vjs-error"), x.error("(CODE:" + this.error_.code + " " + qt.errorTypes[this.error_.code] + ")", this.error_.message, this.error_), this.trigger("error") }, i.reportUserActivity = function (e) { this.userActivity_ = !0 }, i.userActive = function (e) { if (void 0 === e) return this.userActive_; if ((e = !!e) !== this.userActive_) { if (this.userActive_ = e, this.userActive_) return this.userActivity_ = !0, this.removeClass("vjs-user-inactive"), this.addClass("vjs-user-active"), void this.trigger("useractive"); this.tech_ && this.tech_.one("mousemove", (function (e) { e.stopPropagation(), e.preventDefault() })), this.userActivity_ = !1, this.removeClass("vjs-user-active"), this.addClass("vjs-user-inactive"), this.trigger("userinactive") } }, i.listenForUserActivity_ = function () { var e, t, i, n = qe(this, this.reportUserActivity); this.on("mousedown", (function () { n(), this.clearInterval(e), e = this.setInterval(n, 250) })), this.on("mousemove", (function (e) { e.screenX === t && e.screenY === i || (t = e.screenX, i = e.screenY, n()) })), this.on("mouseup", (function (t) { n(), this.clearInterval(e) })); var r, a = this.getChild("controlBar"); !a || vt || _t || (a.on("mouseenter", (function (e) { this.player().cache_.inactivityTimeout = this.player().options_.inactivityTimeout, this.player().options_.inactivityTimeout = 0 })), a.on("mouseleave", (function (e) { this.player().options_.inactivityTimeout = this.player().cache_.inactivityTimeout }))), this.on("keydown", n), this.on("keyup", n), this.setInterval((function () { if (this.userActivity_) { this.userActivity_ = !1, this.userActive(!0), this.clearTimeout(r); var e = this.options_.inactivityTimeout; e <= 0 || (r = this.setTimeout((function () { this.userActivity_ || this.userActive(!1) }), e)) } }), 250) }, i.playbackRate = function (e) { if (void 0 === e) return this.tech_ && this.tech_.featuresPlaybackRate ? this.cache_.lastPlaybackRate || this.techGet_("playbackRate") : 1; this.techCall_("setPlaybackRate", e) }, i.defaultPlaybackRate = function (e) { return void 0 !== e ? this.techCall_("setDefaultPlaybackRate", e) : this.tech_ && this.tech_.featuresPlaybackRate ? this.techGet_("defaultPlaybackRate") : 1 }, i.isAudio = function (e) { if (void 0 === e) return !!this.isAudio_; this.isAudio_ = !!e }, i.addTextTrack = function (e, t, i) { if (this.tech_) return this.tech_.addTextTrack(e, t, i) }, i.addRemoteTextTrack = function (e, t) { if (this.tech_) return this.tech_.addRemoteTextTrack(e, t) }, i.removeRemoteTextTrack = function (e) { void 0 === e && (e = {}); var t = e.track; if (t || (t = e), this.tech_) return this.tech_.removeRemoteTextTrack(t) }, i.getVideoPlaybackQuality = function () { return this.techGet_("getVideoPlaybackQuality") }, i.videoWidth = function () { return this.tech_ && this.tech_.videoWidth && this.tech_.videoWidth() || 0 }, i.videoHeight = function () { return this.tech_ && this.tech_.videoHeight && this.tech_.videoHeight() || 0 }, i.language = function (e) { if (void 0 === e) return this.language_; this.language_ = String(e).toLowerCase() }, i.languages = function () { return at(t.prototype.options_.languages, this.languages_) }, i.toJSON = function () { var e = at(this.options_), t = e.tracks; e.tracks = []; for (var i = 0; i < t.length; i++) { var n = t[i]; (n = at(n)).player = void 0, e.tracks[i] = n } return e }, i.createModal = function (e, t) { var i = this; (t = t || {}).content = e || ""; var n = new $t(this, t); return this.addChild(n), n.on("dispose", (function () { i.removeChild(n) })), n.open(), n }, i.updateCurrentBreakpoint_ = function () { if (this.responsive()) for (var e = this.currentBreakpoint(), t = this.currentWidth(), i = 0; i < Sr.length; i++) { var n = Sr[i]; if (t <= this.breakpoints_[n]) { if (e === n) return; e && this.removeClass(Cr[e]), this.addClass(Cr[n]), this.breakpoint_ = n; break } } }, i.removeCurrentBreakpoint_ = function () { var e = this.currentBreakpointClass(); this.breakpoint_ = "", e && this.removeClass(e) }, i.breakpoints = function (e) { return void 0 === e ? B(this.breakpoints_) : (this.breakpoint_ = "", this.breakpoints_ = B({}, Er, e), this.updateCurrentBreakpoint_(), B(this.breakpoints_)) }, i.responsive = function (e) { return void 0 === e ? this.responsive_ : (e = Boolean(e)) !== this.responsive_ ? (this.responsive_ = e, e ? (this.on("playerresize", this.updateCurrentBreakpoint_), this.updateCurrentBreakpoint_()) : (this.off("playerresize", this.updateCurrentBreakpoint_), this.removeCurrentBreakpoint_()), e) : void 0 }, i.currentBreakpoint = function () { return this.breakpoint_ }, i.currentBreakpointClass = function () { return Cr[this.breakpoint_] || "" }, i.loadMedia = function (e, t) { var i = this; if (e && "object" === typeof e) { this.reset(), this.cache_.media = at(e); var n = this.cache_.media, r = n.artwork, a = n.poster, s = n.src, o = n.textTracks; !r && a && (this.cache_.media.artwork = [{ src: a, type: ji(a) }]), s && this.src(s), a && this.poster(a), Array.isArray(o) && o.forEach((function (e) { return i.addRemoteTextTrack(e, !1) })), this.ready(t) } }, i.getMedia = function () { if (!this.cache_.media) { var e = this.poster(), t = { src: this.currentSources(), textTracks: Array.prototype.map.call(this.remoteTextTracks(), (function (e) { return { kind: e.kind, label: e.label, language: e.language, src: e.src } })) }; return e && (t.poster = e, t.artwork = [{ src: t.poster, type: ji(t.poster) }]), t } return at(this.cache_.media) }, t.getTagSettings = function (e) { var t = { sources: [], tracks: [] }, i = ee(e), n = i["data-setup"]; if (X(e, "vjs-fill") && (i.fill = !0), X(e, "vjs-fluid") && (i.fluid = !0), null !== n) { var r = l()(n || "{}"), a = r[0], s = r[1]; a && x.error(a), B(i, s) } if (B(t, i), e.hasChildNodes()) for (var o = e.childNodes, u = 0, c = o.length; u < c; u++) { var h = o[u], d = h.nodeName.toLowerCase(); "source" === d ? t.sources.push(ee(h)) : "track" === d && t.tracks.push(ee(h)) } return t }, i.flexNotSupported_ = function () { var e = s.a.createElement("i"); return !("flexBasis" in e.style || "webkitFlexBasis" in e.style || "mozFlexBasis" in e.style || "msFlexBasis" in e.style || "msFlexOrder" in e.style) }, t }(st); wi.names.forEach((function (e) { var t = wi[e]; wr.prototype[t.getterName] = function () { return this.tech_ ? this.tech_[t.getterName]() : (this[t.privateName] = this[t.privateName] || new t.ListClass, this[t.privateName]) } })), wr.players = {}; var Pr = r.a.navigator; wr.prototype.options_ = { techOrder: Pi.defaultTechOrder_, html5: {}, flash: {}, inactivityTimeout: 2e3, playbackRates: [], liveui: !1, children: ["mediaLoader", "posterImage", "textTrackDisplay", "loadingSpinner", "bigPlayButton", "liveTracker", "controlBar", "errorDisplay", "textTrackSettings", "resizeManager"], language: Pr && (Pr.languages && Pr.languages[0] || Pr.userLanguage || Pr.language) || "en", languages: {}, notSupportedMessage: "No compatible source was found for this media.", fullscreen: { options: { navigationUI: "hide" } }, breakpoints: {}, responsive: !1 }, ["ended", "seeking", "seekable", "networkState", "readyState"].forEach((function (e) { wr.prototype[e] = function () { return this.techGet_(e) } })), Tr.forEach((function (e) { wr.prototype["handleTech" + rt(e) + "_"] = function () { return this.trigger(e) } })), st.registerComponent("Player", wr); var Lr = {}, Ar = function (e) { return Lr.hasOwnProperty(e) }, Ir = function (e) { return Ar(e) ? Lr[e] : void 0 }, xr = function (e, t) { e.activePlugins_ = e.activePlugins_ || {}, e.activePlugins_[t] = !0 }, Or = function (e, t, i) { var n = (i ? "before" : "") + "pluginsetup"; e.trigger(n, t), e.trigger(n + ":" + t.name, t) }, Dr = function (e, t) { return t.prototype.name = e, function () { Or(this, { name: e, plugin: t, instance: null }, !0); for (var i = arguments.length, n = new Array(i), r = 0; r < i; r++)n[r] = arguments[r]; var a = ut(t, [this].concat(n)); return this[e] = function () { return a }, Or(this, a.getEventHash()), a } }, Mr = function () { function e(t) { if (this.constructor === e) throw new Error("Plugin must be sub-classed; not directly instantiated."); this.player = t, et(this), delete this.trigger, it(this, this.constructor.defaultState), xr(t, this.name), this.dispose = qe(this, this.dispose), t.on("dispose", this.dispose) } var t = e.prototype; return t.version = function () { return this.constructor.VERSION }, t.getEventHash = function (e) { return void 0 === e && (e = {}), e.name = this.name, e.plugin = this.constructor, e.instance = this, e }, t.trigger = function (e, t) { return void 0 === t && (t = {}), Be(this.eventBusEl_, e, this.getEventHash(t)) }, t.handleStateChanged = function (e) { }, t.dispose = function () { var e = this.name, t = this.player; this.trigger("dispose"), this.off(), t.off("dispose", this.dispose), t.activePlugins_[e] = !1, this.player = this.state = null, t[e] = Dr(e, Lr[e]) }, e.isBasic = function (t) { var i = "string" === typeof t ? Ir(t) : t; return "function" === typeof i && !e.prototype.isPrototypeOf(i.prototype) }, e.registerPlugin = function (t, i) { if ("string" !== typeof t) throw new Error('Illegal plugin name, "' + t + '", must be a string, was ' + typeof t + "."); if (Ar(t)) x.warn('A plugin named "' + t + '" already exists. You may want to avoid re-registering plugins!'); else if (wr.prototype.hasOwnProperty(t)) throw new Error('Illegal plugin name, "' + t + '", cannot share a name with an existing player method!'); if ("function" !== typeof i) throw new Error('Illegal plugin for "' + t + '", must be a function, was ' + typeof i + "."); return Lr[t] = i, "plugin" !== t && (e.isBasic(i) ? wr.prototype[t] = function (e, t) { var i = function () { Or(this, { name: e, plugin: t, instance: null }, !0); var i = t.apply(this, arguments); return xr(this, e), Or(this, { name: e, plugin: t, instance: i }), i }; return Object.keys(t).forEach((function (e) { i[e] = t[e] })), i }(t, i) : wr.prototype[t] = Dr(t, i)), i }, e.deregisterPlugin = function (e) { if ("plugin" === e) throw new Error("Cannot de-register base plugin."); Ar(e) && (delete Lr[e], delete wr.prototype[e]) }, e.getPlugins = function (e) { var t; return void 0 === e && (e = Object.keys(Lr)), e.forEach((function (e) { var i = Ir(e); i && ((t = t || {})[e] = i) })), t }, e.getPluginVersion = function (e) { var t = Ir(e); return t && t.VERSION || "" }, e }(); Mr.getPlugin = Ir, Mr.BASE_PLUGIN_NAME = "plugin", Mr.registerPlugin("plugin", Mr), wr.prototype.usingPlugin = function (e) { return !!this.activePlugins_ && !0 === this.activePlugins_[e] }, wr.prototype.hasPlugin = function (e) { return !!Ar(e) }; var Rr = function (e) { return 0 === e.indexOf("#") ? e.slice(1) : e }; function Br(e, t, i) { var n = Br.getPlayer(e); if (n) return t && x.warn('Player "' + e + '" is already initialised. Options will not be applied.'), i && n.ready(i), n; var r = "string" === typeof e ? ge("#" + Rr(e)) : e; if (!V(r)) throw new TypeError("The element or ID supplied is not valid. (videojs)"); r.ownerDocument.defaultView && r.ownerDocument.body.contains(r) || x.warn("The element supplied is not included in the DOM"), t = t || {}, Br.hooks("beforesetup").forEach((function (e) { var i = e(r, at(t)); U(i) && !Array.isArray(i) ? t = at(t, i) : x.error("please return an object in beforesetup hooks") })); var a = st.getComponent("Player"); return n = new a(r, t, i), Br.hooks("setup").forEach((function (e) { return e(n) })), n } if (Br.hooks_ = {}, Br.hooks = function (e, t) { return Br.hooks_[e] = Br.hooks_[e] || [], t && (Br.hooks_[e] = Br.hooks_[e].concat(t)), Br.hooks_[e] }, Br.hook = function (e, t) { Br.hooks(e, t) }, Br.hookOnce = function (e, t) { Br.hooks(e, [].concat(t).map((function (t) { return function i() { return Br.removeHook(e, i), t.apply(void 0, arguments) } }))) }, Br.removeHook = function (e, t) { var i = Br.hooks(e).indexOf(t); return !(i <= -1) && (Br.hooks_[e] = Br.hooks_[e].slice(), Br.hooks_[e].splice(i, 1), !0) }, !0 !== r.a.VIDEOJS_NO_DYNAMIC_STYLE && q()) { var Ur = ge(".vjs-styles-defaults"); if (!Ur) { Ur = Ce("vjs-styles-defaults"); var jr = ge("head"); jr && jr.insertBefore(Ur, jr.firstChild), Ee(Ur, "\n      .video-js {\n        width: 300px;\n        height: 150px;\n      }\n\n      .vjs-fluid {\n        padding-top: 56.25%\n      }\n    ") } } Te(1, Br), Br.VERSION = L, Br.options = wr.prototype.options_, Br.getPlayers = function () { return wr.players }, Br.getPlayer = function (e) { var t, i = wr.players; if ("string" === typeof e) { var n = Rr(e), r = i[n]; if (r) return r; t = ge("#" + n) } else t = e; if (V(t)) { var a = t, s = a.player, o = a.playerId; if (s || i[o]) return s || i[o] } }, Br.getAllPlayers = function () { return Object.keys(wr.players).map((function (e) { return wr.players[e] })).filter(Boolean) }, Br.players = wr.players, Br.getComponent = st.getComponent, Br.registerComponent = function (e, t) { Pi.isTech(t) && x.warn("The " + e + " tech was registered as a component. It should instead be registered using videojs.registerTech(name, tech)"), st.registerComponent.call(st, e, t) }, Br.getTech = Pi.getTech, Br.registerTech = Pi.registerTech, Br.use = function (e, t) { Li[e] = Li[e] || [], Li[e].push(t) }, Object.defineProperty(Br, "middleware", { value: {}, writeable: !1, enumerable: !0 }), Object.defineProperty(Br.middleware, "TERMINATOR", { value: Ii, writeable: !1, enumerable: !0 }), Br.browser = xt, Br.TOUCH_ENABLED = It, Br.extend = function (e, t) { void 0 === t && (t = {}); var i = function () { e.apply(this, arguments) }, n = {}; for (var r in "object" === typeof t ? (t.constructor !== Object.prototype.constructor && (i = t.constructor), n = t) : "function" === typeof t && (i = t), function (e, t) { if ("function" !== typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t); e.prototype = Object.create(t && t.prototype, { constructor: { value: e, enumerable: !1, writable: !0, configurable: !0 } }), t && (e.super_ = t) }(i, e), n) n.hasOwnProperty(r) && (i.prototype[r] = n[r]); return i }, Br.mergeOptions = at, Br.bind = qe, Br.registerPlugin = Mr.registerPlugin, Br.deregisterPlugin = Mr.deregisterPlugin, Br.plugin = function (e, t) { return x.warn("videojs.plugin() is deprecated; use videojs.registerPlugin() instead"), Mr.registerPlugin(e, t) }, Br.getPlugins = Mr.getPlugins, Br.getPlugin = Mr.getPlugin, Br.getPluginVersion = Mr.getPluginVersion, Br.addLanguage = function (e, t) { var i; return e = ("" + e).toLowerCase(), Br.options.languages = at(Br.options.languages, ((i = {})[e] = t, i)), Br.options.languages[e] }, Br.log = x, Br.createLogger = O, Br.createTimeRange = Br.createTimeRanges = Mt, Br.formatTime = en, Br.setFormatTime = function (e) { Zi = e }, Br.resetFormatTime = function () { Zi = Ji }, Br.parseUrl = hi, Br.isCrossOrigin = fi, Br.EventTarget = ze, Br.on = Me, Br.one = Ue, Br.off = Re, Br.trigger = Be, Br.xhr = d.a, Br.TextTrack = yi, Br.AudioTrack = _i, Br.VideoTrack = bi, ["isEl", "isTextNode", "createEl", "hasClass", "addClass", "removeClass", "toggleClass", "setAttributes", "getAttributes", "emptyEl", "appendContent", "insertContent"].forEach((function (e) { Br[e] = function () { return x.warn("videojs." + e + "() is deprecated; use videojs.dom." + e + "() instead"), ye[e].apply(null, arguments) } })), Br.computedStyle = N, Br.dom = ye, Br.url = mi; var Nr = function (e, t) { return /^[a-z]+:/i.test(t) ? t : (/\/\//i.test(e) || (e = g.a.buildAbsoluteURL(r.a.location.href, e)), g.a.buildAbsoluteURL(e, t)) }, Fr = function (e, t, i) { return e && i.responseURL && t !== i.responseURL ? i.responseURL : t }, Hr = function (e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") }, qr = function () { function e(e, t) { for (var i = 0; i < t.length; i++) { var n = t[i]; n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, n.key, n) } } return function (t, i, n) { return i && e(t.prototype, i), n && e(t, n), t } }(), Vr = function (e, t) { if ("function" !== typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t); e.prototype = Object.create(t && t.prototype, { constructor: { value: e, enumerable: !1, writable: !0, configurable: !0 } }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t) }, Wr = function (e, t) { if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return !t || "object" !== typeof t && "function" !== typeof t ? e : t }, zr = function (e, t) { if (Array.isArray(e)) return e; if (Symbol.iterator in Object(e)) return function (e, t) { var i = [], n = !0, r = !1, a = void 0; try { for (var s, o = e[Symbol.iterator](); !(n = (s = o.next()).done) && (i.push(s.value), !t || i.length !== t); n = !0); } catch (l) { r = !0, a = l } finally { try { !n && o.return && o.return() } finally { if (r) throw a } } return i }(e, t); throw new TypeError("Invalid attempt to destructure non-iterable instance") }, Gr = Br.mergeOptions, Kr = Br.EventTarget, Yr = Br.log, Xr = function (e, t) { ["AUDIO", "SUBTITLES"].forEach((function (i) { for (var n in e.mediaGroups[i]) for (var r in e.mediaGroups[i][n]) { var a = e.mediaGroups[i][n][r]; t(a, i, n, r) } })) }, $r = function (e, t) { var i = Gr(e, {}), n = i.playlists[t.uri]; if (!n) return null; if (n.segments && t.segments && n.segments.length === t.segments.length && n.endList === t.endList && n.mediaSequence === t.mediaSequence) return null; var r = Gr(n, t); n.segments && (r.segments = function (e, t, i) { var n = t.slice(); i = i || 0; for (var r = Math.min(e.length, t.length + i), a = i; a < r; a++)n[a - i] = Gr(e[a], n[a - i]); return n }(n.segments, t.segments, t.mediaSequence - n.mediaSequence)), r.segments.forEach((function (e) { !function (e, t) { e.resolvedUri || (e.resolvedUri = Nr(t, e.uri)), e.key && !e.key.resolvedUri && (e.key.resolvedUri = Nr(t, e.key.uri)), e.map && !e.map.resolvedUri && (e.map.resolvedUri = Nr(t, e.map.uri)) }(e, r.resolvedUri) })); for (var a = 0; a < i.playlists.length; a++)i.playlists[a].uri === t.uri && (i.playlists[a] = r); return i.playlists[t.uri] = r, i }, Qr = function (e) { for (var t = e.playlists.length; t--;) { var i = e.playlists[t]; e.playlists[i.uri] = i, i.resolvedUri = Nr(e.uri, i.uri), i.id = t, i.attributes || (i.attributes = {}, Yr.warn("Invalid playlist STREAM-INF detected. Missing BANDWIDTH attribute.")) } }, Jr = function (e) { Xr(e, (function (t) { t.uri && (t.resolvedUri = Nr(e.uri, t.uri)) })) }, Zr = function (e, t) { var i = e.segments[e.segments.length - 1]; return t && i && i.duration ? 1e3 * i.duration : 500 * (e.targetDuration || 10) }, ea = function (e) { function t(e, i) { var n = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : {}; Hr(this, t); var r = Wr(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this)), a = n.withCredentials, s = void 0 !== a && a, o = n.handleManifestRedirects, l = void 0 !== o && o; r.srcUrl = e, r.hls_ = i, r.withCredentials = s, r.handleManifestRedirects = l; var u = i.options_; if (r.customTagParsers = u && u.customTagParsers || [], r.customTagMappers = u && u.customTagMappers || [], !r.srcUrl) throw new Error("A non-empty playlist URL is required"); return r.state = "HAVE_NOTHING", r.on("mediaupdatetimeout", (function () { "HAVE_METADATA" === r.state && (r.state = "HAVE_CURRENT_METADATA", r.request = r.hls_.xhr({ uri: Nr(r.master.uri, r.media().uri), withCredentials: r.withCredentials }, (function (e, t) { if (r.request) return e ? r.playlistRequestError(r.request, r.media().uri, "HAVE_METADATA") : void r.haveMetadata(r.request, r.media().uri) }))) })), r } return Vr(t, e), qr(t, [{ key: "playlistRequestError", value: function (e, t, i) { this.request = null, i && (this.state = i), this.error = { playlist: this.master.playlists[t], status: e.status, message: "HLS playlist request error at URL: " + t + ".", responseText: e.responseText, code: e.status >= 500 ? 4 : 2 }, this.trigger("error") } }, { key: "haveMetadata", value: function (e, t) { var i = this; this.request = null, this.state = "HAVE_METADATA"; var n = new v.a; this.customTagParsers.forEach((function (e) { return n.addParser(e) })), this.customTagMappers.forEach((function (e) { return n.addTagMapper(e) })), n.push(e.responseText), n.end(), n.manifest.uri = t, n.manifest.attributes = n.manifest.attributes || {}; var a = $r(this.master, n.manifest); this.targetDuration = n.manifest.targetDuration, a ? (this.master = a, this.media_ = this.master.playlists[n.manifest.uri]) : this.trigger("playlistunchanged"), this.media().endList || (r.a.clearTimeout(this.mediaUpdateTimeout), this.mediaUpdateTimeout = r.a.setTimeout((function () { i.trigger("mediaupdatetimeout") }), Zr(this.media(), !!a))), this.trigger("loadedplaylist") } }, { key: "dispose", value: function () { this.stopRequest(), r.a.clearTimeout(this.mediaUpdateTimeout), r.a.clearTimeout(this.finalRenditionTimeout) } }, { key: "stopRequest", value: function () { if (this.request) { var e = this.request; this.request = null, e.onreadystatechange = null, e.abort() } } }, { key: "media", value: function (e, t) { var i = this; if (!e) return this.media_; if ("HAVE_NOTHING" === this.state) throw new Error("Cannot switch media playlist from " + this.state); if ("string" === typeof e) { if (!this.master.playlists[e]) throw new Error("Unknown playlist URI: " + e); e = this.master.playlists[e] } if (r.a.clearTimeout(this.finalRenditionTimeout), t) { var n = e.targetDuration / 2 * 1e3 || 5e3; this.finalRenditionTimeout = r.a.setTimeout(this.media.bind(this, e, !1), n) } else { var a = this.state, s = !this.media_ || e.uri !== this.media_.uri; if (this.master.playlists[e.uri].endList) return this.request && (this.request.onreadystatechange = null, this.request.abort(), this.request = null), this.state = "HAVE_METADATA", this.media_ = e, void (s && (this.trigger("mediachanging"), this.trigger("mediachange"))); if (s) { if (this.state = "SWITCHING_MEDIA", this.request) { if (e.resolvedUri === this.request.url) return; this.request.onreadystatechange = null, this.request.abort(), this.request = null } this.media_ && this.trigger("mediachanging"), this.request = this.hls_.xhr({ uri: e.resolvedUri, withCredentials: this.withCredentials }, (function (t, n) { if (i.request) { if (e.resolvedUri = Fr(i.handleManifestRedirects, e.resolvedUri, n), t) return i.playlistRequestError(i.request, e.uri, a); i.haveMetadata(n, e.uri), "HAVE_MASTER" === a ? i.trigger("loadedmetadata") : i.trigger("mediachange") } })) } } } }, { key: "pause", value: function () { this.stopRequest(), r.a.clearTimeout(this.mediaUpdateTimeout), "HAVE_NOTHING" === this.state && (this.started = !1), "SWITCHING_MEDIA" === this.state ? this.media_ ? this.state = "HAVE_METADATA" : this.state = "HAVE_MASTER" : "HAVE_CURRENT_METADATA" === this.state && (this.state = "HAVE_METADATA") } }, { key: "load", value: function (e) { var t = this; r.a.clearTimeout(this.mediaUpdateTimeout); var i = this.media(); if (e) { var n = i ? i.targetDuration / 2 * 1e3 : 5e3; this.mediaUpdateTimeout = r.a.setTimeout((function () { return t.load() }), n) } else this.started ? i && !i.endList ? this.trigger("mediaupdatetimeout") : this.trigger("loadedplaylist") : this.start() } }, { key: "start", value: function () { var e = this; this.started = !0, this.request = this.hls_.xhr({ uri: this.srcUrl, withCredentials: this.withCredentials }, (function (t, i) { if (e.request) { if (e.request = null, t) return e.error = { status: i.status, message: "HLS playlist request error at URL: " + e.srcUrl + ".", responseText: i.responseText, code: 2 }, "HAVE_NOTHING" === e.state && (e.started = !1), e.trigger("error"); var n = new v.a; return e.customTagParsers.forEach((function (e) { return n.addParser(e) })), e.customTagMappers.forEach((function (e) { return n.addTagMapper(e) })), n.push(i.responseText), n.end(), e.state = "HAVE_MASTER", e.srcUrl = Fr(e.handleManifestRedirects, e.srcUrl, i), n.manifest.uri = e.srcUrl, n.manifest.playlists ? (e.master = n.manifest, Qr(e.master), Jr(e.master), e.trigger("loadedplaylist"), void (e.request || e.media(n.manifest.playlists[0]))) : (e.master = { mediaGroups: { AUDIO: {}, VIDEO: {}, "CLOSED-CAPTIONS": {}, SUBTITLES: {} }, uri: r.a.location.href, playlists: [{ uri: e.srcUrl, id: 0, resolvedUri: e.srcUrl, attributes: {} }] }, e.master.playlists[e.srcUrl] = e.master.playlists[0], e.haveMetadata(i, e.srcUrl), e.trigger("loadedmetadata")) } })) } }]), t }(Kr), ta = Br.createTimeRange, ia = function (e, t, i) { var n, r; return "undefined" === typeof t && (t = e.mediaSequence + e.segments.length), t < e.mediaSequence ? 0 : (n = function (e, t) { var i = 0, n = t - e.mediaSequence, r = e.segments[n]; if (r) { if ("undefined" !== typeof r.start) return { result: r.start, precise: !0 }; if ("undefined" !== typeof r.end) return { result: r.end - r.duration, precise: !0 } } for (; n--;) { if ("undefined" !== typeof (r = e.segments[n]).end) return { result: i + r.end, precise: !0 }; if (i += r.duration, "undefined" !== typeof r.start) return { result: i + r.start, precise: !0 } } return { result: i, precise: !1 } }(e, t)).precise ? n.result : (r = function (e, t) { for (var i = 0, n = void 0, r = t - e.mediaSequence; r < e.segments.length; r++) { if ("undefined" !== typeof (n = e.segments[r]).start) return { result: n.start - i, precise: !0 }; if (i += n.duration, "undefined" !== typeof n.end) return { result: n.end - i, precise: !0 } } return { result: -1, precise: !1 } }(e, t)).precise ? r.result : n.result + i }, na = function (e, t, i) { if (!e) return 0; if ("number" !== typeof i && (i = 0), "undefined" === typeof t) { if (e.totalDuration) return e.totalDuration; if (!e.endList) return r.a.Infinity } return ia(e, t, i) }, ra = function (e, t, i) { var n = 0; if (t > i) { var r = [i, t]; t = r[0], i = r[1] } if (t < 0) { for (var a = t; a < Math.min(0, i); a++)n += e.targetDuration; t = 0 } for (var s = t; s < i; s++)n += e.segments[s].duration; return n }, aa = function (e) { if (!e.segments.length) return 0; for (var t = e.segments.length - 1, i = e.segments[t].duration || e.targetDuration, n = i + 2 * e.targetDuration; t-- && !((i += e.segments[t].duration) >= n);); return Math.max(0, t) }, sa = function (e, t, i) { if (!e || !e.segments) return null; if (e.endList) return na(e); if (null === t) return null; t = t || 0; var n = i ? aa(e) : e.segments.length; return ia(e, e.mediaSequence + n, t) }, oa = function (e) { return e - Math.floor(e) === 0 }, la = function (e, t) { if (oa(t)) return t + .1 * e; for (var i = t.toString().split(".")[1].length, n = 1; n <= i; n++) { var r = Math.pow(10, n), a = t * r; if (oa(a) || n === i) return (a + e) / r } }, ua = la.bind(null, 1), ca = la.bind(null, -1), ha = function (e) { return e.excludeUntil && e.excludeUntil > Date.now() }, da = function (e) { return e.excludeUntil && e.excludeUntil === 1 / 0 }, pa = function (e) { var t = ha(e); return !e.disabled && !t }, fa = function (e, t) { return t.attributes && t.attributes[e] }, ma = function (e, t) { if (1 === e.playlists.length) return !0; var i = t.attributes.BANDWIDTH || Number.MAX_VALUE; return 0 === e.playlists.filter((function (e) { return !!pa(e) && (e.attributes.BANDWIDTH || 0) < i })).length }, ga = { duration: na, seekable: function (e, t) { var i = t || 0, n = sa(e, t, !0); return null === n ? ta() : ta(i, n) }, safeLiveIndex: aa, getMediaInfoForTime: function (e, t, i, n) { var r = void 0, a = void 0, s = e.segments.length, o = t - n; if (o < 0) { if (i > 0) for (r = i - 1; r >= 0; r--)if (a = e.segments[r], (o += ca(a.duration)) > 0) return { mediaIndex: r, startTime: n - ra(e, i, r) }; return { mediaIndex: 0, startTime: t } } if (i < 0) { for (r = i; r < 0; r++)if ((o -= e.targetDuration) < 0) return { mediaIndex: 0, startTime: t }; i = 0 } for (r = i; r < s; r++)if (a = e.segments[r], (o -= ua(a.duration)) < 0) return { mediaIndex: r, startTime: n + ra(e, i, r) }; return { mediaIndex: s - 1, startTime: t } }, isEnabled: pa, isDisabled: function (e) { return e.disabled }, isBlacklisted: ha, isIncompatible: da, playlistEnd: sa, isAes: function (e) { for (var t = 0; t < e.segments.length; t++)if (e.segments[t].key) return !0; return !1 }, isFmp4: function (e) { for (var t = 0; t < e.segments.length; t++)if (e.segments[t].map) return !0; return !1 }, hasAttribute: fa, estimateSegmentRequestTime: function (e, t, i) { var n = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : 0; if (!fa("BANDWIDTH", i)) return NaN; var r = e * i.attributes.BANDWIDTH; return (r - 8 * n) / t }, isLowestEnabledRendition: ma }, va = Br.xhr, ya = Br.mergeOptions, _a = function () { return function e(t, i) { t = ya({ timeout: 45e3 }, t); var n = e.beforeRequest || Br.Hls.xhr.beforeRequest; if (n && "function" === typeof n) { var r = n(t); r && (t = r) } var a = va(t, (function (e, t) { var n = a.response; !e && n && (a.responseTime = Date.now(), a.roundTripTime = a.responseTime - a.requestTime, a.bytesReceived = n.byteLength || n.length, a.bandwidth || (a.bandwidth = Math.floor(a.bytesReceived / a.roundTripTime * 8 * 1e3))), t.headers && (a.responseHeaders = t.headers), e && "ETIMEDOUT" === e.code && (a.timedout = !0), e || a.aborted || 200 === t.statusCode || 206 === t.statusCode || 0 === t.statusCode || (e = new Error("XHR Failed with a response of: " + (a && (n || a.responseText)))), i(e, a) })), s = a.abort; return a.abort = function () { return a.aborted = !0, s.apply(a, arguments) }, a.uri = t.uri, a.requestTime = Date.now(), a } }, ba = function (e) { var t = {}; return e.byterange && (t.Range = function (e) { var t; return t = e.offset + e.length - 1, "bytes=" + e.offset + "-" + t }(e.byterange)), t }, Ta = function (e, t) { return e.start(t) + "-" + e.end(t) }, ka = function (e, t) { var i = e.toString(16); return "00".substring(0, 2 - i.length) + i + (t % 2 ? " " : "") }, Sa = function (e) { return e >= 32 && e < 126 ? String.fromCharCode(e) : "." }, Ca = function (e) { var t = {}; return Object.keys(e).forEach((function (i) { var n = e[i]; ArrayBuffer.isView(n) ? t[i] = { bytes: n.buffer, byteOffset: n.byteOffset, byteLength: n.byteLength } : t[i] = n })), t }, Ea = function (e) { var t = e.byterange || { length: 1 / 0, offset: 0 }; return [t.length, t.offset, e.resolvedUri].join(",") }, wa = function (e) { return e.resolvedUri }, Pa = function (e) { for (var t = Array.prototype.slice.call(e), i = "", n = 0; n < t.length / 16; n++)i += t.slice(16 * n, 16 * n + 16).map(ka).join("") + " " + t.slice(16 * n, 16 * n + 16).map(Sa).join("") + "\n"; return i }, La = Object.freeze({ createTransferableMessage: Ca, initSegmentId: Ea, segmentKeyId: wa, hexDump: Pa, tagDump: function (e) { var t = e.bytes; return Pa(t) }, textRanges: function (e) { var t = "", i = void 0; for (i = 0; i < e.length; i++)t += Ta(e, i) + " "; return t } }), Aa = function (e) { var t = e.playlist, i = e.time, n = void 0 === i ? void 0 : i, r = e.callback; if (!r) throw new Error("getProgramTime: callback must be provided"); if (!t || void 0 === n) return r({ message: "getProgramTime: playlist and time must be provided" }); var a = function (e, t) { if (!t || !t.segments || 0 === t.segments.length) return null; for (var i = 0, n = void 0, r = 0; r < t.segments.length && !(e <= (i = (n = t.segments[r]).videoTimingInfo ? n.videoTimingInfo.transmuxedPresentationEnd : i + n.duration)); r++); var a = t.segments[t.segments.length - 1]; if (a.videoTimingInfo && a.videoTimingInfo.transmuxedPresentationEnd < e) return null; if (e > i) { if (e > i + .25 * a.duration) return null; n = a } return { segment: n, estimatedStart: n.videoTimingInfo ? n.videoTimingInfo.transmuxedPresentationStart : i - n.duration, type: n.videoTimingInfo ? "accurate" : "estimate" } }(n, t); if (!a) return r({ message: "valid programTime was not found" }); if ("estimate" === a.type) return r({ message: "Accurate programTime could not be determined. Please seek to e.seekTime and try again", seekTime: a.estimatedStart }); var s = { mediaSeconds: n }, o = function (e, t) { if (!t.dateTimeObject) return null; var i = t.videoTimingInfo.transmuxerPrependedSeconds, n = e - (t.videoTimingInfo.transmuxedPresentationStart + i); return new Date(t.dateTimeObject.getTime() + 1e3 * n) }(n, a.segment); return o && (s.programDateTime = o.toISOString()), r(null, s) }, Ia = function e(t) { var i = t.programTime, n = t.playlist, r = t.retryCount, a = void 0 === r ? 2 : r, s = t.seekTo, o = t.pauseAfterSeek, l = void 0 === o || o, u = t.tech, c = t.callback; if (!c) throw new Error("seekToProgramTime: callback must be provided"); if ("undefined" === typeof i || !n || !s) return c({ message: "seekToProgramTime: programTime, seekTo and playlist must be provided" }); if (!n.endList && !u.hasStarted_) return c({ message: "player must be playing a live stream to start buffering" }); if (!function (e) { if (!e.segments || 0 === e.segments.length) return !1; for (var t = 0; t < e.segments.length; t++) { if (!e.segments[t].dateTimeObject) return !1 } return !0 }(n)) return c({ message: "programDateTime tags must be provided in the manifest " + n.resolvedUri }); var h = function (e, t) { var i = void 0; try { i = new Date(e) } catch (u) { return null } if (!t || !t.segments || 0 === t.segments.length) return null; var n = t.segments[0]; if (i < n.dateTimeObject) return null; for (var r = 0; r < t.segments.length - 1; r++) { if (n = t.segments[r], i < t.segments[r + 1].dateTimeObject) break } var a, s = t.segments[t.segments.length - 1], o = s.dateTimeObject, l = s.videoTimingInfo ? (a = s.videoTimingInfo).transmuxedPresentationEnd - a.transmuxedPresentationStart - a.transmuxerPrependedSeconds : s.duration + .25 * s.duration; return i > new Date(o.getTime() + 1e3 * l) ? null : (i > o && (n = s), { segment: n, estimatedStart: n.videoTimingInfo ? n.videoTimingInfo.transmuxedPresentationStart : ga.duration(t, t.mediaSequence + t.segments.indexOf(n)), type: n.videoTimingInfo ? "accurate" : "estimate" }) }(i, n); if (!h) return c({ message: i + " was not found in the stream" }); var d = h.segment, p = function (e, t) { var i = void 0, n = void 0; try { i = new Date(e), n = new Date(t) } catch (a) { } var r = i.getTime(); return (n.getTime() - r) / 1e3 }(d.dateTimeObject, i); if ("estimate" === h.type) return 0 === a ? c({ message: i + " is not buffered yet. Try again" }) : (s(h.estimatedStart + p), void u.one("seeked", (function () { e({ programTime: i, playlist: n, retryCount: a - 1, seekTo: s, pauseAfterSeek: l, tech: u, callback: c }) }))); var f = d.start + p; u.one("seeked", (function () { return c(null, u.currentTime()) })), l && u.pause(), s(f) }, xa = function (e, t) { var i = [], n = void 0; if (e && e.length) for (n = 0; n < e.length; n++)t(e.start(n), e.end(n)) && i.push([e.start(n), e.end(n)]); return Br.createTimeRanges(i) }, Oa = function (e, t) { return xa(e, (function (e, i) { return e - .1 <= t && i + .1 >= t })) }, Da = function (e, t) { return xa(e, (function (e) { return e - 1 / 30 >= t })) }, Ma = function (e) { var t = []; if (!e || !e.length) return ""; for (var i = 0; i < e.length; i++)t.push(e.start(i) + " => " + e.end(i)); return t.join(", ") }, Ra = function (e) { for (var t = [], i = 0; i < e.length; i++)t.push({ start: e.start(i), end: e.end(i) }); return t }, Ba = function (e, t, i) { var n = void 0, r = void 0; if (i && i.cues) for (n = i.cues.length; n--;)(r = i.cues[n]).startTime <= t && r.endTime >= e && i.removeCue(r) }, Ua = function (e) { return isNaN(e) || Math.abs(e) === 1 / 0 ? Number.MAX_VALUE : e }, ja = function (e, t, i) { var n = r.a.WebKitDataCue || r.a.VTTCue; if (t && t.forEach((function (e) { var t = e.stream; this.inbandTextTracks_[t].addCue(new n(e.startTime + this.timestampOffset, e.endTime + this.timestampOffset, e.text)) }), e), i) { var a = Ua(e.mediaSource_.duration); if (i.forEach((function (e) { var t = e.cueTime + this.timestampOffset; !("number" !== typeof t || r.a.isNaN(t) || t < 0) && t < 1 / 0 && e.frames.forEach((function (e) { var i = new n(t, t, e.value || e.url || e.data || ""); i.frame = e, i.value = e, function (e) { Object.defineProperties(e.frame, { id: { get: function () { return Br.log.warn("cue.frame.id is deprecated. Use cue.value.key instead."), e.value.key } }, value: { get: function () { return Br.log.warn("cue.frame.value is deprecated. Use cue.value.data instead."), e.value.data } }, privateData: { get: function () { return Br.log.warn("cue.frame.privateData is deprecated. Use cue.value.data instead."), e.value.data } } }) }(i), this.metadataTrack_.addCue(i) }), this) }), e), e.metadataTrack_ && e.metadataTrack_.cues && e.metadataTrack_.cues.length) { for (var s = e.metadataTrack_.cues, o = [], l = 0; l < s.length; l++)s[l] && o.push(s[l]); var u = o.reduce((function (e, t) { var i = e[t.startTime] || []; return i.push(t), e[t.startTime] = i, e }), {}), c = Object.keys(u).sort((function (e, t) { return Number(e) - Number(t) })); c.forEach((function (e, t) { var i = u[e], n = Number(c[t + 1]) || a; i.forEach((function (e) { e.endTime = n })) })) } } }, Na = "undefined" !== typeof window ? window : {}, Fa = "undefined" === typeof Symbol ? "__target" : Symbol(), Ha = "application/javascript", qa = Na.BlobBuilder || Na.WebKitBlobBuilder || Na.MozBlobBuilder || Na.MSBlobBuilder, Va = Na.URL || Na.webkitURL || Va && Va.msURL, Wa = Na.Worker; function za(e, t) { return function (i) { var n = this; if (!t) return new Wa(e); if (Wa && !i) { var r = Xa(t.toString().replace(/^function.+?{/, "").slice(0, -1)); return this[Fa] = new Wa(r), function (e, t) { if (!e || !t) return; var i = e.terminate; e.objURL = t, e.terminate = function () { e.objURL && Va.revokeObjectURL(e.objURL), i.call(e) } }(this[Fa], r), this[Fa] } var a = { postMessage: function (e) { n.onmessage && setTimeout((function () { n.onmessage({ data: e, target: a }) })) } }; t.call(a), this.postMessage = function (e) { setTimeout((function () { a.onmessage({ data: e, target: n }) })) }, this.isThisThread = !0 } } if (Wa) { var Ga, Ka = Xa("self.onmessage = function () {}"), Ya = new Uint8Array(1); try { (Ga = new Wa(Ka)).postMessage(Ya, [Ya.buffer]) } catch (yo) { Wa = null } finally { Va.revokeObjectURL(Ka), Ga && Ga.terminate() } } function Xa(e) { try { return Va.createObjectURL(new Blob([e], { type: Ha })) } catch (yo) { var t = new qa; return t.append(e), Va.createObjectURL(t.getBlob(type)) } } var $a = new za("./transmuxer-worker.worker.js", (function (e, t) { var i = this; !function () { var e = function () { this.init = function () { var e = {}; this.on = function (t, i) { e[t] || (e[t] = []), e[t] = e[t].concat(i) }, this.off = function (t, i) { var n; return !!e[t] && (n = e[t].indexOf(i), e[t] = e[t].slice(), e[t].splice(n, 1), n > -1) }, this.trigger = function (t) { var i, n, r, a; if (i = e[t]) if (2 === arguments.length) for (r = i.length, n = 0; n < r; ++n)i[n].call(this, arguments[1]); else { for (a = [], n = arguments.length, n = 1; n < arguments.length; ++n)a.push(arguments[n]); for (r = i.length, n = 0; n < r; ++n)i[n].apply(this, a) } }, this.dispose = function () { e = {} } } }; e.prototype.pipe = function (e) { return this.on("data", (function (t) { e.push(t) })), this.on("done", (function (t) { e.flush(t) })), this.on("partialdone", (function (t) { e.partialFlush(t) })), this.on("endedtimeline", (function (t) { e.endTimeline(t) })), this.on("reset", (function (t) { e.reset(t) })), e }, e.prototype.push = function (e) { this.trigger("data", e) }, e.prototype.flush = function (e) { this.trigger("done", e) }, e.prototype.partialFlush = function (e) { this.trigger("partialdone", e) }, e.prototype.endTimeline = function (e) { this.trigger("endedtimeline", e) }, e.prototype.reset = function (e) { this.trigger("reset", e) }; var t, n, r, a, s, o, l, u, c, h, d, p, f, m, g, v, y, _, b, T, k, S, C, E, w, P, L, A, I, x, O, D, M, R, B, U, j = e, N = Math.pow(2, 32) - 1; !function () { var e; if (C = { avc1: [], avcC: [], btrt: [], dinf: [], dref: [], esds: [], ftyp: [], hdlr: [], mdat: [], mdhd: [], mdia: [], mfhd: [], minf: [], moof: [], moov: [], mp4a: [], mvex: [], mvhd: [], pasp: [], sdtp: [], smhd: [], stbl: [], stco: [], stsc: [], stsd: [], stsz: [], stts: [], styp: [], tfdt: [], tfhd: [], traf: [], trak: [], trun: [], trex: [], tkhd: [], vmhd: [] }, "undefined" !== typeof Uint8Array) { for (e in C) C.hasOwnProperty(e) && (C[e] = [e.charCodeAt(0), e.charCodeAt(1), e.charCodeAt(2), e.charCodeAt(3)]); E = new Uint8Array(["i".charCodeAt(0), "s".charCodeAt(0), "o".charCodeAt(0), "m".charCodeAt(0)]), P = new Uint8Array(["a".charCodeAt(0), "v".charCodeAt(0), "c".charCodeAt(0), "1".charCodeAt(0)]), w = new Uint8Array([0, 0, 0, 1]), L = new Uint8Array([0, 0, 0, 0, 0, 0, 0, 0, 118, 105, 100, 101, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 86, 105, 100, 101, 111, 72, 97, 110, 100, 108, 101, 114, 0]), A = new Uint8Array([0, 0, 0, 0, 0, 0, 0, 0, 115, 111, 117, 110, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 83, 111, 117, 110, 100, 72, 97, 110, 100, 108, 101, 114, 0]), I = { video: L, audio: A }, D = new Uint8Array([0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 12, 117, 114, 108, 32, 0, 0, 0, 1]), O = new Uint8Array([0, 0, 0, 0, 0, 0, 0, 0]), M = new Uint8Array([0, 0, 0, 0, 0, 0, 0, 0]), R = M, B = new Uint8Array([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]), U = M, x = new Uint8Array([0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0]) } }(), t = function (e) { var t, i, n = [], r = 0; for (t = 1; t < arguments.length; t++)n.push(arguments[t]); for (t = n.length; t--;)r += n[t].byteLength; for (i = new Uint8Array(r + 8), new DataView(i.buffer, i.byteOffset, i.byteLength).setUint32(0, i.byteLength), i.set(e, 4), t = 0, r = 8; t < n.length; t++)i.set(n[t], r), r += n[t].byteLength; return i }, n = function () { return t(C.dinf, t(C.dref, D)) }, r = function (e) { return t(C.esds, new Uint8Array([0, 0, 0, 0, 3, 25, 0, 0, 0, 4, 17, 64, 21, 0, 6, 0, 0, 0, 218, 192, 0, 0, 218, 192, 5, 2, e.audioobjecttype << 3 | e.samplingfrequencyindex >>> 1, e.samplingfrequencyindex << 7 | e.channelcount << 3, 6, 1, 2])) }, a = function () { return t(C.ftyp, E, w, E, P) }, v = function (e) { return t(C.hdlr, I[e]) }, s = function (e) { return t(C.mdat, e) }, g = function (e) { var i = new Uint8Array([0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 3, 0, 1, 95, 144, e.duration >>> 24 & 255, e.duration >>> 16 & 255, e.duration >>> 8 & 255, 255 & e.duration, 85, 196, 0, 0]); return e.samplerate && (i[12] = e.samplerate >>> 24 & 255, i[13] = e.samplerate >>> 16 & 255, i[14] = e.samplerate >>> 8 & 255, i[15] = 255 & e.samplerate), t(C.mdhd, i) }, m = function (e) { return t(C.mdia, g(e), v(e.type), l(e)) }, o = function (e) { return t(C.mfhd, new Uint8Array([0, 0, 0, 0, (4278190080 & e) >> 24, (16711680 & e) >> 16, (65280 & e) >> 8, 255 & e])) }, l = function (e) { return t(C.minf, "video" === e.type ? t(C.vmhd, x) : t(C.smhd, O), n(), _(e)) }, u = function (e, i) { for (var n = [], r = i.length; r--;)n[r] = T(i[r]); return t.apply(null, [C.moof, o(e)].concat(n)) }, c = function (e) { for (var i = e.length, n = []; i--;)n[i] = p(e[i]); return t.apply(null, [C.moov, d(4294967295)].concat(n).concat(h(e))) }, h = function (e) { for (var i = e.length, n = []; i--;)n[i] = k(e[i]); return t.apply(null, [C.mvex].concat(n)) }, d = function (e) { var i = new Uint8Array([0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 2, 0, 1, 95, 144, (4278190080 & e) >> 24, (16711680 & e) >> 16, (65280 & e) >> 8, 255 & e, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 64, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 255, 255, 255, 255]); return t(C.mvhd, i) }, y = function (e) { var i, n, r = e.samples || [], a = new Uint8Array(4 + r.length); for (n = 0; n < r.length; n++)i = r[n].flags, a[n + 4] = i.dependsOn << 4 | i.isDependedOn << 2 | i.hasRedundancy; return t(C.sdtp, a) }, _ = function (e) { return t(C.stbl, b(e), t(C.stts, U), t(C.stsc, R), t(C.stsz, B), t(C.stco, M)) }, function () { var e, i; b = function (n) { return t(C.stsd, new Uint8Array([0, 0, 0, 0, 0, 0, 0, 1]), "video" === n.type ? e(n) : i(n)) }, e = function (e) { var i, n, r = e.sps || [], a = e.pps || [], s = [], o = []; for (i = 0; i < r.length; i++)s.push((65280 & r[i].byteLength) >>> 8), s.push(255 & r[i].byteLength), s = s.concat(Array.prototype.slice.call(r[i])); for (i = 0; i < a.length; i++)o.push((65280 & a[i].byteLength) >>> 8), o.push(255 & a[i].byteLength), o = o.concat(Array.prototype.slice.call(a[i])); if (n = [C.avc1, new Uint8Array([0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (65280 & e.width) >> 8, 255 & e.width, (65280 & e.height) >> 8, 255 & e.height, 0, 72, 0, 0, 0, 72, 0, 0, 0, 0, 0, 0, 0, 1, 19, 118, 105, 100, 101, 111, 106, 115, 45, 99, 111, 110, 116, 114, 105, 98, 45, 104, 108, 115, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 24, 17, 17]), t(C.avcC, new Uint8Array([1, e.profileIdc, e.profileCompatibility, e.levelIdc, 255].concat([r.length], s, [a.length], o))), t(C.btrt, new Uint8Array([0, 28, 156, 128, 0, 45, 198, 192, 0, 45, 198, 192]))], e.sarRatio) { var l = e.sarRatio[0], u = e.sarRatio[1]; n.push(t(C.pasp, new Uint8Array([(4278190080 & l) >> 24, (16711680 & l) >> 16, (65280 & l) >> 8, 255 & l, (4278190080 & u) >> 24, (16711680 & u) >> 16, (65280 & u) >> 8, 255 & u]))) } return t.apply(null, n) }, i = function (e) { return t(C.mp4a, new Uint8Array([0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, (65280 & e.channelcount) >> 8, 255 & e.channelcount, (65280 & e.samplesize) >> 8, 255 & e.samplesize, 0, 0, 0, 0, (65280 & e.samplerate) >> 8, 255 & e.samplerate, 0, 0]), r(e)) } }(), f = function (e) { var i = new Uint8Array([0, 0, 0, 7, 0, 0, 0, 0, 0, 0, 0, 0, (4278190080 & e.id) >> 24, (16711680 & e.id) >> 16, (65280 & e.id) >> 8, 255 & e.id, 0, 0, 0, 0, (4278190080 & e.duration) >> 24, (16711680 & e.duration) >> 16, (65280 & e.duration) >> 8, 255 & e.duration, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 64, 0, 0, 0, (65280 & e.width) >> 8, 255 & e.width, 0, 0, (65280 & e.height) >> 8, 255 & e.height, 0, 0]); return t(C.tkhd, i) }, T = function (e) { var i, n, r, a, s, o; return i = t(C.tfhd, new Uint8Array([0, 0, 0, 58, (4278190080 & e.id) >> 24, (16711680 & e.id) >> 16, (65280 & e.id) >> 8, 255 & e.id, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0])), s = Math.floor(e.baseMediaDecodeTime / (N + 1)), o = Math.floor(e.baseMediaDecodeTime % (N + 1)), n = t(C.tfdt, new Uint8Array([1, 0, 0, 0, s >>> 24 & 255, s >>> 16 & 255, s >>> 8 & 255, 255 & s, o >>> 24 & 255, o >>> 16 & 255, o >>> 8 & 255, 255 & o])), 92, "audio" === e.type ? (r = S(e, 92), t(C.traf, i, n, r)) : (a = y(e), r = S(e, a.length + 92), t(C.traf, i, n, r, a)) }, p = function (e) { return e.duration = e.duration || 4294967295, t(C.trak, f(e), m(e)) }, k = function (e) { var i = new Uint8Array([0, 0, 0, 0, (4278190080 & e.id) >> 24, (16711680 & e.id) >> 16, (65280 & e.id) >> 8, 255 & e.id, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1]); return "video" !== e.type && (i[i.length - 1] = 0), t(C.trex, i) }, function () { var e, i, n; n = function (e, t) { var i = 0, n = 0, r = 0, a = 0; return e.length && (void 0 !== e[0].duration && (i = 1), void 0 !== e[0].size && (n = 2), void 0 !== e[0].flags && (r = 4), void 0 !== e[0].compositionTimeOffset && (a = 8)), [0, 0, i | n | r | a, 1, (4278190080 & e.length) >>> 24, (16711680 & e.length) >>> 16, (65280 & e.length) >>> 8, 255 & e.length, (4278190080 & t) >>> 24, (16711680 & t) >>> 16, (65280 & t) >>> 8, 255 & t] }, i = function (e, i) { var r, a, s, o; for (i += 20 + 16 * (a = e.samples || []).length, r = n(a, i), o = 0; o < a.length; o++)s = a[o], r = r.concat([(4278190080 & s.duration) >>> 24, (16711680 & s.duration) >>> 16, (65280 & s.duration) >>> 8, 255 & s.duration, (4278190080 & s.size) >>> 24, (16711680 & s.size) >>> 16, (65280 & s.size) >>> 8, 255 & s.size, s.flags.isLeading << 2 | s.flags.dependsOn, s.flags.isDependedOn << 6 | s.flags.hasRedundancy << 4 | s.flags.paddingValue << 1 | s.flags.isNonSyncSample, 61440 & s.flags.degradationPriority, 15 & s.flags.degradationPriority, (4278190080 & s.compositionTimeOffset) >>> 24, (16711680 & s.compositionTimeOffset) >>> 16, (65280 & s.compositionTimeOffset) >>> 8, 255 & s.compositionTimeOffset]); return t(C.trun, new Uint8Array(r)) }, e = function (e, i) { var r, a, s, o; for (i += 20 + 8 * (a = e.samples || []).length, r = n(a, i), o = 0; o < a.length; o++)s = a[o], r = r.concat([(4278190080 & s.duration) >>> 24, (16711680 & s.duration) >>> 16, (65280 & s.duration) >>> 8, 255 & s.duration, (4278190080 & s.size) >>> 24, (16711680 & s.size) >>> 16, (65280 & s.size) >>> 8, 255 & s.size]); return t(C.trun, new Uint8Array(r)) }, S = function (t, n) { return "audio" === t.type ? e(t, n) : i(t, n) } }(); var F, H, q, V, W, z, G, K, Y = s, X = u, $ = function (e) { var t, i = a(), n = c(e); return (t = new Uint8Array(i.byteLength + n.byteLength)).set(i), t.set(n, i.byteLength), t }, Q = function (e, t) { var i = { size: 0, flags: { isLeading: 0, dependsOn: 1, isDependedOn: 0, hasRedundancy: 0, degradationPriority: 0, isNonSyncSample: 1 } }; return i.dataOffset = t, i.compositionTimeOffset = e.pts - e.dts, i.duration = e.duration, i.size = 4 * e.length, i.size += e.byteLength, e.keyFrame && (i.flags.dependsOn = 2, i.flags.isNonSyncSample = 0), i }, J = function (e) { var t, i, n = [], r = []; for (r.byteLength = 0, r.nalCount = 0, r.duration = 0, n.byteLength = 0, t = 0; t < e.length; t++)"access_unit_delimiter_rbsp" === (i = e[t]).nalUnitType ? (n.length && (n.duration = i.dts - n.dts, r.byteLength += n.byteLength, r.nalCount += n.length, r.duration += n.duration, r.push(n)), (n = [i]).byteLength = i.data.byteLength, n.pts = i.pts, n.dts = i.dts) : ("slice_layer_without_partitioning_rbsp_idr" === i.nalUnitType && (n.keyFrame = !0), n.duration = i.dts - n.dts, n.byteLength += i.data.byteLength, n.push(i)); return r.length && (!n.duration || n.duration <= 0) && (n.duration = r[r.length - 1].duration), r.byteLength += n.byteLength, r.nalCount += n.length, r.duration += n.duration, r.push(n), r }, Z = function (e) { var t, i, n = [], r = []; for (n.byteLength = 0, n.nalCount = 0, n.duration = 0, n.pts = e[0].pts, n.dts = e[0].dts, r.byteLength = 0, r.nalCount = 0, r.duration = 0, r.pts = e[0].pts, r.dts = e[0].dts, t = 0; t < e.length; t++)(i = e[t]).keyFrame ? (n.length && (r.push(n), r.byteLength += n.byteLength, r.nalCount += n.nalCount, r.duration += n.duration), (n = [i]).nalCount = i.length, n.byteLength = i.byteLength, n.pts = i.pts, n.dts = i.dts, n.duration = i.duration) : (n.duration += i.duration, n.nalCount += i.length, n.byteLength += i.byteLength, n.push(i)); return r.length && n.duration <= 0 && (n.duration = r[r.length - 1].duration), r.byteLength += n.byteLength, r.nalCount += n.nalCount, r.duration += n.duration, r.push(n), r }, ee = function (e) { var t; return !e[0][0].keyFrame && e.length > 1 && (t = e.shift(), e.byteLength -= t.byteLength, e.nalCount -= t.nalCount, e[0][0].dts = t.dts, e[0][0].pts = t.pts, e[0][0].duration += t.duration), e }, te = function (e, t) { var i, n, r, a, s, o = t || 0, l = []; for (i = 0; i < e.length; i++)for (a = e[i], n = 0; n < a.length; n++)s = a[n], o += (r = Q(s, o)).size, l.push(r); return l }, ie = function (e) { var t, i, n, r, a, s, o = 0, l = e.byteLength, u = e.nalCount, c = new Uint8Array(l + 4 * u), h = new DataView(c.buffer); for (t = 0; t < e.length; t++)for (r = e[t], i = 0; i < r.length; i++)for (a = r[i], n = 0; n < a.length; n++)s = a[n], h.setUint32(o, s.data.byteLength), o += 4, c.set(s.data, o), o += s.data.byteLength; return c }, ne = [33, 16, 5, 32, 164, 27], re = [33, 65, 108, 84, 1, 2, 4, 8, 168, 2, 4, 8, 17, 191, 252], ae = function (e) { for (var t = []; e--;)t.push(0); return t }, se = { 96e3: [ne, [227, 64], ae(154), [56]], 88200: [ne, [231], ae(170), [56]], 64e3: [ne, [248, 192], ae(240), [56]], 48e3: [ne, [255, 192], ae(268), [55, 148, 128], ae(54), [112]], 44100: [ne, [255, 192], ae(268), [55, 163, 128], ae(84), [112]], 32e3: [ne, [255, 192], ae(268), [55, 234], ae(226), [112]], 24e3: [ne, [255, 192], ae(268), [55, 255, 128], ae(268), [111, 112], ae(126), [224]], 16e3: [ne, [255, 192], ae(268), [55, 255, 128], ae(268), [111, 255], ae(269), [223, 108], ae(195), [1, 192]], 12e3: [re, ae(268), [3, 127, 248], ae(268), [6, 255, 240], ae(268), [13, 255, 224], ae(268), [27, 253, 128], ae(259), [56]], 11025: [re, ae(268), [3, 127, 248], ae(268), [6, 255, 240], ae(268), [13, 255, 224], ae(268), [27, 255, 192], ae(268), [55, 175, 128], ae(108), [112]], 8e3: [re, ae(268), [3, 121, 16], ae(47), [7]] }, oe = (F = se, Object.keys(F).reduce((function (e, t) { return e[t] = new Uint8Array(F[t].reduce((function (e, t) { return e.concat(t) }), [])), e }), {})); z = function (e, t) { return H(W(e, t)) }, G = function (e, t) { return q(V(e), t) }, K = function (e, t, i) { return V(i ? e : e - t) }; var le = 9e4, ue = (H = function (e) { return 9e4 * e }, q = function (e, t) { return e * t }, V = function (e) { return e / 9e4 }, W = function (e, t) { return e / t }, z), ce = G, he = K, de = function (e, t, i, n) { var r, a, s, o, l, u = 0, c = 0, h = 0; if (t.length && (r = ue(e.baseMediaDecodeTime, e.samplerate), a = Math.ceil(le / (e.samplerate / 1024)), i && n && (u = r - Math.max(i, n), h = (c = Math.floor(u / a)) * a), !(c < 1 || h > le / 2))) { for ((s = oe[e.samplerate]) || (s = t[0].data), o = 0; o < c; o++)l = t[0], t.splice(0, 0, { data: s, dts: l.dts - a, pts: l.pts - a }); e.baseMediaDecodeTime -= Math.floor(ce(h, e.samplerate)) } }, pe = function (e, t, i) { return t.minSegmentDts >= i ? e : (t.minSegmentDts = 1 / 0, e.filter((function (e) { return e.dts >= i && (t.minSegmentDts = Math.min(t.minSegmentDts, e.dts), t.minSegmentPts = t.minSegmentDts, !0) }))) }, fe = function (e) { var t, i, n = []; for (t = 0; t < e.length; t++)i = e[t], n.push({ size: i.data.byteLength, duration: 1024 }); return n }, me = function (e) { var t, i, n = 0, r = new Uint8Array(function (e) { var t, i = 0; for (t = 0; t < e.length; t++)i += e[t].data.byteLength; return i }(e)); for (t = 0; t < e.length; t++)i = e[t], r.set(i.data, n), n += i.data.byteLength; return r }, ge = le, ve = function (e) { delete e.minSegmentDts, delete e.maxSegmentDts, delete e.minSegmentPts, delete e.maxSegmentPts }, ye = function (e, t) { var i, n = e.minSegmentDts; return t || (n -= e.timelineStartInfo.dts), i = e.timelineStartInfo.baseMediaDecodeTime, i += n, i = Math.max(0, i), "audio" === e.type && (i *= e.samplerate / ge, i = Math.floor(i)), i }, _e = function (e, t) { "number" === typeof t.pts && (void 0 === e.timelineStartInfo.pts && (e.timelineStartInfo.pts = t.pts), void 0 === e.minSegmentPts ? e.minSegmentPts = t.pts : e.minSegmentPts = Math.min(e.minSegmentPts, t.pts), void 0 === e.maxSegmentPts ? e.maxSegmentPts = t.pts : e.maxSegmentPts = Math.max(e.maxSegmentPts, t.pts)), "number" === typeof t.dts && (void 0 === e.timelineStartInfo.dts && (e.timelineStartInfo.dts = t.dts), void 0 === e.minSegmentDts ? e.minSegmentDts = t.dts : e.minSegmentDts = Math.min(e.minSegmentDts, t.dts), void 0 === e.maxSegmentDts ? e.maxSegmentDts = t.dts : e.maxSegmentDts = Math.max(e.maxSegmentDts, t.dts)) }, be = function (e) { for (var t = 0, i = { payloadType: -1, payloadSize: 0 }, n = 0, r = 0; t < e.byteLength && 128 !== e[t];) { for (; 255 === e[t];)n += 255, t++; for (n += e[t++]; 255 === e[t];)r += 255, t++; if (r += e[t++], !i.payload && 4 === n) { i.payloadType = n, i.payloadSize = r, i.payload = e.subarray(t, t + r); break } t += r, n = 0, r = 0 } return i }, Te = function (e) { return 181 !== e.payload[0] ? null : 49 !== (e.payload[1] << 8 | e.payload[2]) ? null : "GA94" !== String.fromCharCode(e.payload[3], e.payload[4], e.payload[5], e.payload[6]) ? null : 3 !== e.payload[7] ? null : e.payload.subarray(8, e.payload.length - 1) }, ke = function (e, t) { var i, n, r, a, s = []; if (!(64 & t[0])) return s; for (n = 31 & t[0], i = 0; i < n; i++)a = { type: 3 & t[(r = 3 * i) + 2], pts: e }, 4 & t[r + 2] && (a.ccData = t[r + 3] << 8 | t[r + 4], s.push(a)); return s }, Se = 4, Ce = function e() { e.prototype.init.call(this), this.captionPackets_ = [], this.ccStreams_ = [new Ae(0, 0), new Ae(0, 1), new Ae(1, 0), new Ae(1, 1)], this.reset(), this.ccStreams_.forEach((function (e) { e.on("data", this.trigger.bind(this, "data")), e.on("partialdone", this.trigger.bind(this, "partialdone")), e.on("done", this.trigger.bind(this, "done")) }), this) }; (Ce.prototype = new j).push = function (e) { var t, i, n; if ("sei_rbsp" === e.nalUnitType && (t = be(e.escapedRBSP)).payloadType === Se && (i = Te(t))) if (e.dts < this.latestDts_) this.ignoreNextEqualDts_ = !0; else { if (e.dts === this.latestDts_ && this.ignoreNextEqualDts_) return this.numSameDts_--, void (this.numSameDts_ || (this.ignoreNextEqualDts_ = !1)); n = ke(e.pts, i), this.captionPackets_ = this.captionPackets_.concat(n), this.latestDts_ !== e.dts && (this.numSameDts_ = 0), this.numSameDts_++, this.latestDts_ = e.dts } }, Ce.prototype.flushCCStreams = function (e) { this.ccStreams_.forEach((function (t) { return "flush" === e ? t.flush() : t.partialFlush() }), this) }, Ce.prototype.flushStream = function (e) { this.captionPackets_.length ? (this.captionPackets_.forEach((function (e, t) { e.presortIndex = t })), this.captionPackets_.sort((function (e, t) { return e.pts === t.pts ? e.presortIndex - t.presortIndex : e.pts - t.pts })), this.captionPackets_.forEach((function (e) { e.type < 2 && this.dispatchCea608Packet(e) }), this), this.captionPackets_.length = 0, this.flushCCStreams(e)) : this.flushCCStreams(e) }, Ce.prototype.flush = function () { return this.flushStream("flush") }, Ce.prototype.partialFlush = function () { return this.flushStream("partialFlush") }, Ce.prototype.reset = function () { this.latestDts_ = null, this.ignoreNextEqualDts_ = !1, this.numSameDts_ = 0, this.activeCea608Channel_ = [null, null], this.ccStreams_.forEach((function (e) { e.reset() })) }, Ce.prototype.dispatchCea608Packet = function (e) { this.setsTextOrXDSActive(e) ? this.activeCea608Channel_[e.type] = null : this.setsChannel1Active(e) ? this.activeCea608Channel_[e.type] = 0 : this.setsChannel2Active(e) && (this.activeCea608Channel_[e.type] = 1), null !== this.activeCea608Channel_[e.type] && this.ccStreams_[(e.type << 1) + this.activeCea608Channel_[e.type]].push(e) }, Ce.prototype.setsChannel1Active = function (e) { return 4096 === (30720 & e.ccData) }, Ce.prototype.setsChannel2Active = function (e) { return 6144 === (30720 & e.ccData) }, Ce.prototype.setsTextOrXDSActive = function (e) { return 256 === (28928 & e.ccData) || 4138 === (30974 & e.ccData) || 6186 === (30974 & e.ccData) }; var Ee = { 42: 225, 92: 233, 94: 237, 95: 243, 96: 250, 123: 231, 124: 247, 125: 209, 126: 241, 127: 9608, 304: 174, 305: 176, 306: 189, 307: 191, 308: 8482, 309: 162, 310: 163, 311: 9834, 312: 224, 313: 160, 314: 232, 315: 226, 316: 234, 317: 238, 318: 244, 319: 251, 544: 193, 545: 201, 546: 211, 547: 218, 548: 220, 549: 252, 550: 8216, 551: 161, 552: 42, 553: 39, 554: 8212, 555: 169, 556: 8480, 557: 8226, 558: 8220, 559: 8221, 560: 192, 561: 194, 562: 199, 563: 200, 564: 202, 565: 203, 566: 235, 567: 206, 568: 207, 569: 239, 570: 212, 571: 217, 572: 249, 573: 219, 574: 171, 575: 187, 800: 195, 801: 227, 802: 205, 803: 204, 804: 236, 805: 210, 806: 242, 807: 213, 808: 245, 809: 123, 810: 125, 811: 92, 812: 94, 813: 95, 814: 124, 815: 126, 816: 196, 817: 228, 818: 214, 819: 246, 820: 223, 821: 165, 822: 164, 823: 9474, 824: 197, 825: 229, 826: 216, 827: 248, 828: 9484, 829: 9488, 830: 9492, 831: 9496 }, we = function (e) { return null === e ? "" : (e = Ee[e] || e, String.fromCharCode(e)) }, Pe = [4352, 4384, 4608, 4640, 5376, 5408, 5632, 5664, 5888, 5920, 4096, 4864, 4896, 5120, 5152], Le = function () { for (var e = [], t = 15; t--;)e.push(""); return e }, Ae = function e(t, i) { e.prototype.init.call(this), this.field_ = t || 0, this.dataChannel_ = i || 0, this.name_ = "CC" + (1 + (this.field_ << 1 | this.dataChannel_)), this.setConstants(), this.reset(), this.push = function (e) { var t, i, n, r, a; if ((t = 32639 & e.ccData) !== this.lastControlCode_) { if (4096 === (61440 & t) ? this.lastControlCode_ = t : t !== this.PADDING_ && (this.lastControlCode_ = null), n = t >>> 8, r = 255 & t, t !== this.PADDING_) if (t === this.RESUME_CAPTION_LOADING_) this.mode_ = "popOn"; else if (t === this.END_OF_CAPTION_) this.mode_ = "popOn", this.clearFormatting(e.pts), this.flushDisplayed(e.pts), i = this.displayed_, this.displayed_ = this.nonDisplayed_, this.nonDisplayed_ = i, this.startPts_ = e.pts; else if (t === this.ROLL_UP_2_ROWS_) this.rollUpRows_ = 2, this.setRollUp(e.pts); else if (t === this.ROLL_UP_3_ROWS_) this.rollUpRows_ = 3, this.setRollUp(e.pts); else if (t === this.ROLL_UP_4_ROWS_) this.rollUpRows_ = 4, this.setRollUp(e.pts); else if (t === this.CARRIAGE_RETURN_) this.clearFormatting(e.pts), this.flushDisplayed(e.pts), this.shiftRowsUp_(), this.startPts_ = e.pts; else if (t === this.BACKSPACE_) "popOn" === this.mode_ ? this.nonDisplayed_[this.row_] = this.nonDisplayed_[this.row_].slice(0, -1) : this.displayed_[this.row_] = this.displayed_[this.row_].slice(0, -1); else if (t === this.ERASE_DISPLAYED_MEMORY_) this.flushDisplayed(e.pts), this.displayed_ = Le(); else if (t === this.ERASE_NON_DISPLAYED_MEMORY_) this.nonDisplayed_ = Le(); else if (t === this.RESUME_DIRECT_CAPTIONING_) "paintOn" !== this.mode_ && (this.flushDisplayed(e.pts), this.displayed_ = Le()), this.mode_ = "paintOn", this.startPts_ = e.pts; else if (this.isSpecialCharacter(n, r)) a = we((n = (3 & n) << 8) | r), this[this.mode_](e.pts, a), this.column_++; else if (this.isExtCharacter(n, r)) "popOn" === this.mode_ ? this.nonDisplayed_[this.row_] = this.nonDisplayed_[this.row_].slice(0, -1) : this.displayed_[this.row_] = this.displayed_[this.row_].slice(0, -1), a = we((n = (3 & n) << 8) | r), this[this.mode_](e.pts, a), this.column_++; else if (this.isMidRowCode(n, r)) this.clearFormatting(e.pts), this[this.mode_](e.pts, " "), this.column_++, 14 === (14 & r) && this.addFormatting(e.pts, ["i"]), 1 === (1 & r) && this.addFormatting(e.pts, ["u"]); else if (this.isOffsetControlCode(n, r)) this.column_ += 3 & r; else if (this.isPAC(n, r)) { var s = Pe.indexOf(7968 & t); "rollUp" === this.mode_ && (s - this.rollUpRows_ + 1 < 0 && (s = this.rollUpRows_ - 1), this.setRollUp(e.pts, s)), s !== this.row_ && (this.clearFormatting(e.pts), this.row_ = s), 1 & r && -1 === this.formatting_.indexOf("u") && this.addFormatting(e.pts, ["u"]), 16 === (16 & t) && (this.column_ = 4 * ((14 & t) >> 1)), this.isColorPAC(r) && 14 === (14 & r) && this.addFormatting(e.pts, ["i"]) } else this.isNormalChar(n) && (0 === r && (r = null), a = we(n), a += we(r), this[this.mode_](e.pts, a), this.column_ += a.length) } else this.lastControlCode_ = null } }; Ae.prototype = new j, Ae.prototype.flushDisplayed = function (e) { var t = this.displayed_.map((function (e) { try { return e.trim() } catch (yo) { return console.error("Skipping malformed caption."), "" } })).join("\n").replace(/^\n+|\n+$/g, ""); t.length && this.trigger("data", { startPts: this.startPts_, endPts: e, text: t, stream: this.name_ }) }, Ae.prototype.reset = function () { this.mode_ = "popOn", this.topRow_ = 0, this.startPts_ = 0, this.displayed_ = Le(), this.nonDisplayed_ = Le(), this.lastControlCode_ = null, this.column_ = 0, this.row_ = 14, this.rollUpRows_ = 2, this.formatting_ = [] }, Ae.prototype.setConstants = function () { 0 === this.dataChannel_ ? (this.BASE_ = 16, this.EXT_ = 17, this.CONTROL_ = (20 | this.field_) << 8, this.OFFSET_ = 23) : 1 === this.dataChannel_ && (this.BASE_ = 24, this.EXT_ = 25, this.CONTROL_ = (28 | this.field_) << 8, this.OFFSET_ = 31), this.PADDING_ = 0, this.RESUME_CAPTION_LOADING_ = 32 | this.CONTROL_, this.END_OF_CAPTION_ = 47 | this.CONTROL_, this.ROLL_UP_2_ROWS_ = 37 | this.CONTROL_, this.ROLL_UP_3_ROWS_ = 38 | this.CONTROL_, this.ROLL_UP_4_ROWS_ = 39 | this.CONTROL_, this.CARRIAGE_RETURN_ = 45 | this.CONTROL_, this.RESUME_DIRECT_CAPTIONING_ = 41 | this.CONTROL_, this.BACKSPACE_ = 33 | this.CONTROL_, this.ERASE_DISPLAYED_MEMORY_ = 44 | this.CONTROL_, this.ERASE_NON_DISPLAYED_MEMORY_ = 46 | this.CONTROL_ }, Ae.prototype.isSpecialCharacter = function (e, t) { return e === this.EXT_ && t >= 48 && t <= 63 }, Ae.prototype.isExtCharacter = function (e, t) { return (e === this.EXT_ + 1 || e === this.EXT_ + 2) && t >= 32 && t <= 63 }, Ae.prototype.isMidRowCode = function (e, t) { return e === this.EXT_ && t >= 32 && t <= 47 }, Ae.prototype.isOffsetControlCode = function (e, t) { return e === this.OFFSET_ && t >= 33 && t <= 35 }, Ae.prototype.isPAC = function (e, t) { return e >= this.BASE_ && e < this.BASE_ + 8 && t >= 64 && t <= 127 }, Ae.prototype.isColorPAC = function (e) { return e >= 64 && e <= 79 || e >= 96 && e <= 127 }, Ae.prototype.isNormalChar = function (e) { return e >= 32 && e <= 127 }, Ae.prototype.setRollUp = function (e, t) { if ("rollUp" !== this.mode_ && (this.row_ = 14, this.mode_ = "rollUp", this.flushDisplayed(e), this.nonDisplayed_ = Le(), this.displayed_ = Le()), void 0 !== t && t !== this.row_) for (var i = 0; i < this.rollUpRows_; i++)this.displayed_[t - i] = this.displayed_[this.row_ - i], this.displayed_[this.row_ - i] = ""; void 0 === t && (t = this.row_), this.topRow_ = t - this.rollUpRows_ + 1 }, Ae.prototype.addFormatting = function (e, t) { this.formatting_ = this.formatting_.concat(t); var i = t.reduce((function (e, t) { return e + "<" + t + ">" }), ""); this[this.mode_](e, i) }, Ae.prototype.clearFormatting = function (e) { if (this.formatting_.length) { var t = this.formatting_.reverse().reduce((function (e, t) { return e + "</" + t + ">" }), ""); this.formatting_ = [], this[this.mode_](e, t) } }, Ae.prototype.popOn = function (e, t) { var i = this.nonDisplayed_[this.row_]; i += t, this.nonDisplayed_[this.row_] = i }, Ae.prototype.rollUp = function (e, t) { var i = this.displayed_[this.row_]; i += t, this.displayed_[this.row_] = i }, Ae.prototype.shiftRowsUp_ = function () { var e; for (e = 0; e < this.topRow_; e++)this.displayed_[e] = ""; for (e = this.row_ + 1; e < 15; e++)this.displayed_[e] = ""; for (e = this.topRow_; e < this.row_; e++)this.displayed_[e] = this.displayed_[e + 1]; this.displayed_[this.row_] = "" }, Ae.prototype.paintOn = function (e, t) { var i = this.displayed_[this.row_]; i += t, this.displayed_[this.row_] = i }; var Ie = { CaptionStream: Ce, Cea608Stream: Ae }, xe = { H264_STREAM_TYPE: 27, ADTS_STREAM_TYPE: 15, METADATA_STREAM_TYPE: 21 }, Oe = function (e, t) { var i = 1; for (e > t && (i = -1); Math.abs(t - e) > 4294967296;)e += 8589934592 * i; return e }, De = function e(t) { var i, n; e.prototype.init.call(this), this.type_ = t || "shared", this.push = function (e) { "shared" !== this.type_ && e.type !== this.type_ || (void 0 === n && (n = e.dts), e.dts = Oe(e.dts, n), e.pts = Oe(e.pts, n), i = e.dts, this.trigger("data", e)) }, this.flush = function () { n = i, this.trigger("done") }, this.endTimeline = function () { this.flush(), this.trigger("endedtimeline") }, this.discontinuity = function () { n = void 0, i = void 0 }, this.reset = function () { this.discontinuity(), this.trigger("reset") } }; De.prototype = new j; var Me, Re = De, Be = function (e, t, i) { var n, r = ""; for (n = t; n < i; n++)r += "%" + ("00" + e[n].toString(16)).slice(-2); return r }, Ue = function (e, t, i) { return decodeURIComponent(Be(e, t, i)) }, je = function (e) { return e[0] << 21 | e[1] << 14 | e[2] << 7 | e[3] }, Ne = { TXXX: function (e) { var t; if (3 === e.data[0]) { for (t = 1; t < e.data.length; t++)if (0 === e.data[t]) { e.description = Ue(e.data, 1, t), e.value = Ue(e.data, t + 1, e.data.length).replace(/\0*$/, ""); break } e.data = e.value } }, WXXX: function (e) { var t; if (3 === e.data[0]) for (t = 1; t < e.data.length; t++)if (0 === e.data[t]) { e.description = Ue(e.data, 1, t), e.url = Ue(e.data, t + 1, e.data.length); break } }, PRIV: function (e) { var t, i; for (t = 0; t < e.data.length; t++)if (0 === e.data[t]) { e.owner = (i = e.data, unescape(Be(i, 0, t))); break } e.privateData = e.data.subarray(t + 1), e.data = e.privateData } }; (Me = function (e) { var t, i = { debug: !(!e || !e.debug), descriptor: e && e.descriptor }, n = 0, r = [], a = 0; if (Me.prototype.init.call(this), this.dispatchType = xe.METADATA_STREAM_TYPE.toString(16), i.descriptor) for (t = 0; t < i.descriptor.length; t++)this.dispatchType += ("00" + i.descriptor[t].toString(16)).slice(-2); this.push = function (e) { var t, s, o, l, u; if ("timed-metadata" === e.type) if (e.dataAlignmentIndicator && (a = 0, r.length = 0), 0 === r.length && (e.data.length < 10 || e.data[0] !== "I".charCodeAt(0) || e.data[1] !== "D".charCodeAt(0) || e.data[2] !== "3".charCodeAt(0))) i.debug && console.log("Skipping unrecognized metadata packet"); else if (r.push(e), a += e.data.byteLength, 1 === r.length && (n = je(e.data.subarray(6, 10)), n += 10), !(a < n)) { for (t = { data: new Uint8Array(n), frames: [], pts: r[0].pts, dts: r[0].dts }, u = 0; u < n;)t.data.set(r[0].data.subarray(0, n - u), u), u += r[0].data.byteLength, a -= r[0].data.byteLength, r.shift(); s = 10, 64 & t.data[5] && (s += 4, s += je(t.data.subarray(10, 14)), n -= je(t.data.subarray(16, 20))); do { if ((o = je(t.data.subarray(s + 4, s + 8))) < 1) return console.log("Malformed ID3 frame encountered. Skipping metadata parsing."); if ((l = { id: String.fromCharCode(t.data[s], t.data[s + 1], t.data[s + 2], t.data[s + 3]), data: t.data.subarray(s + 10, s + o + 10) }).key = l.id, Ne[l.id] && (Ne[l.id](l), "com.apple.streaming.transportStreamTimestamp" === l.owner)) { var c = l.data, h = (1 & c[3]) << 30 | c[4] << 22 | c[5] << 14 | c[6] << 6 | c[7] >>> 2; h *= 4, h += 3 & c[7], l.timeStamp = h, void 0 === t.pts && void 0 === t.dts && (t.pts = l.timeStamp, t.dts = l.timeStamp), this.trigger("timestamp", l) } t.frames.push(l), s += 10, s += o } while (s < n); this.trigger("data", t) } } }).prototype = new j; var Fe, He, qe, Ve = Me, We = Re; (Fe = function () { var e = new Uint8Array(188), t = 0; Fe.prototype.init.call(this), this.push = function (i) { var n, r = 0, a = 188; for (t ? ((n = new Uint8Array(i.byteLength + t)).set(e.subarray(0, t)), n.set(i, t), t = 0) : n = i; a < n.byteLength;)71 !== n[r] || 71 !== n[a] ? (r++, a++) : (this.trigger("data", n.subarray(r, a)), r += 188, a += 188); r < n.byteLength && (e.set(n.subarray(r), 0), t = n.byteLength - r) }, this.flush = function () { 188 === t && 71 === e[0] && (this.trigger("data", e), t = 0), this.trigger("done") }, this.endTimeline = function () { this.flush(), this.trigger("endedtimeline") }, this.reset = function () { t = 0, this.trigger("reset") } }).prototype = new j, (He = function () { var e, t, i, n; He.prototype.init.call(this), n = this, this.packetsWaitingForPmt = [], this.programMapTable = void 0, e = function (e, n) { var r = 0; n.payloadUnitStartIndicator && (r += e[r] + 1), "pat" === n.type ? t(e.subarray(r), n) : i(e.subarray(r), n) }, t = function (e, t) { t.section_number = e[7], t.last_section_number = e[8], n.pmtPid = (31 & e[10]) << 8 | e[11], t.pmtPid = n.pmtPid }, i = function (e, t) { var i, r; if (1 & e[5]) { for (n.programMapTable = { video: null, audio: null, "timed-metadata": {} }, i = 3 + ((15 & e[1]) << 8 | e[2]) - 4, r = 12 + ((15 & e[10]) << 8 | e[11]); r < i;) { var a = e[r], s = (31 & e[r + 1]) << 8 | e[r + 2]; a === xe.H264_STREAM_TYPE && null === n.programMapTable.video ? n.programMapTable.video = s : a === xe.ADTS_STREAM_TYPE && null === n.programMapTable.audio ? n.programMapTable.audio = s : a === xe.METADATA_STREAM_TYPE && (n.programMapTable["timed-metadata"][s] = a), r += 5 + ((15 & e[r + 3]) << 8 | e[r + 4]) } t.programMapTable = n.programMapTable } }, this.push = function (t) { var i = {}, n = 4; if (i.payloadUnitStartIndicator = !!(64 & t[1]), i.pid = 31 & t[1], i.pid <<= 8, i.pid |= t[2], (48 & t[3]) >>> 4 > 1 && (n += t[n] + 1), 0 === i.pid) i.type = "pat", e(t.subarray(n), i), this.trigger("data", i); else if (i.pid === this.pmtPid) for (i.type = "pmt", e(t.subarray(n), i), this.trigger("data", i); this.packetsWaitingForPmt.length;)this.processPes_.apply(this, this.packetsWaitingForPmt.shift()); else void 0 === this.programMapTable ? this.packetsWaitingForPmt.push([t, n, i]) : this.processPes_(t, n, i) }, this.processPes_ = function (e, t, i) { i.pid === this.programMapTable.video ? i.streamType = xe.H264_STREAM_TYPE : i.pid === this.programMapTable.audio ? i.streamType = xe.ADTS_STREAM_TYPE : i.streamType = this.programMapTable["timed-metadata"][i.pid], i.type = "pes", i.data = e.subarray(t), this.trigger("data", i) } }).prototype = new j, He.STREAM_TYPES = { h264: 27, adts: 15 }, (qe = function () { var e, t = this, i = { data: [], size: 0 }, n = { data: [], size: 0 }, r = { data: [], size: 0 }, a = function (e, i, n) { var r, a, s = new Uint8Array(e.size), o = { type: i }, l = 0, u = 0; if (e.data.length && !(e.size < 9)) { for (o.trackId = e.data[0].pid, l = 0; l < e.data.length; l++)a = e.data[l], s.set(a.data, u), u += a.data.byteLength; !function (e, t) { var i; t.packetLength = 6 + (e[4] << 8 | e[5]), t.dataAlignmentIndicator = 0 !== (4 & e[6]), 192 & (i = e[7]) && (t.pts = (14 & e[9]) << 27 | (255 & e[10]) << 20 | (254 & e[11]) << 12 | (255 & e[12]) << 5 | (254 & e[13]) >>> 3, t.pts *= 4, t.pts += (6 & e[13]) >>> 1, t.dts = t.pts, 64 & i && (t.dts = (14 & e[14]) << 27 | (255 & e[15]) << 20 | (254 & e[16]) << 12 | (255 & e[17]) << 5 | (254 & e[18]) >>> 3, t.dts *= 4, t.dts += (6 & e[18]) >>> 1)), t.data = e.subarray(9 + e[8]) }(s, o), r = "video" === i || o.packetLength <= e.size, (n || r) && (e.size = 0, e.data.length = 0), r && t.trigger("data", o) } }; qe.prototype.init.call(this), this.push = function (s) { ({ pat: function () { }, pes: function () { var e, t; switch (s.streamType) { case xe.H264_STREAM_TYPE: case xe.H264_STREAM_TYPE: e = i, t = "video"; break; case xe.ADTS_STREAM_TYPE: e = n, t = "audio"; break; case xe.METADATA_STREAM_TYPE: e = r, t = "timed-metadata"; break; default: return }s.payloadUnitStartIndicator && a(e, t, !0), e.data.push(s), e.size += s.data.byteLength }, pmt: function () { var i = { type: "metadata", tracks: [] }; null !== (e = s.programMapTable).video && i.tracks.push({ timelineStartInfo: { baseMediaDecodeTime: 0 }, id: +e.video, codec: "avc", type: "video" }), null !== e.audio && i.tracks.push({ timelineStartInfo: { baseMediaDecodeTime: 0 }, id: +e.audio, codec: "adts", type: "audio" }), t.trigger("data", i) } })[s.type]() }, this.reset = function () { i.size = 0, i.data.length = 0, n.size = 0, n.data.length = 0, this.trigger("reset") }, this.flushStreams_ = function () { a(i, "video"), a(n, "audio"), a(r, "timed-metadata") }, this.flush = function () { this.flushStreams_(), this.trigger("done") } }).prototype = new j; var ze = { PAT_PID: 0, MP2T_PACKET_LENGTH: 188, TransportPacketStream: Fe, TransportParseStream: He, ElementaryStream: qe, TimestampRolloverStream: We, CaptionStream: Ie.CaptionStream, Cea608Stream: Ie.Cea608Stream, MetadataStream: Ve }; for (var Ge in xe) xe.hasOwnProperty(Ge) && (ze[Ge] = xe[Ge]); var Ke, Ye = ze, Xe = le, $e = [96e3, 88200, 64e3, 48e3, 44100, 32e3, 24e3, 22050, 16e3, 12e3, 11025, 8e3, 7350]; (Ke = function (e) { var t, i = 0; Ke.prototype.init.call(this), this.push = function (n) { var r, a, s, o, l, u, c = 0; if (e || (i = 0), "audio" === n.type) for (t ? (o = t, (t = new Uint8Array(o.byteLength + n.data.byteLength)).set(o), t.set(n.data, o.byteLength)) : t = n.data; c + 5 < t.length;)if (255 === t[c] && 240 === (246 & t[c + 1])) { if (a = 2 * (1 & ~t[c + 1]), r = (3 & t[c + 3]) << 11 | t[c + 4] << 3 | (224 & t[c + 5]) >> 5, u = (l = 1024 * (1 + (3 & t[c + 6]))) * Xe / $e[(60 & t[c + 2]) >>> 2], s = c + r, t.byteLength < s) return; if (this.trigger("data", { pts: n.pts + i * u, dts: n.dts + i * u, sampleCount: l, audioobjecttype: 1 + (t[c + 2] >>> 6 & 3), channelcount: (1 & t[c + 2]) << 2 | (192 & t[c + 3]) >>> 6, samplerate: $e[(60 & t[c + 2]) >>> 2], samplingfrequencyindex: (60 & t[c + 2]) >>> 2, samplesize: 16, data: t.subarray(c + 7 + a, s) }), i++, t.byteLength === s) return void (t = void 0); t = t.subarray(s) } else c++ }, this.flush = function () { i = 0, this.trigger("done") }, this.reset = function () { t = void 0, this.trigger("reset") }, this.endTimeline = function () { t = void 0, this.trigger("endedtimeline") } }).prototype = new j; var Qe, Je, Ze, et = Ke, tt = function (e) { var t = e.byteLength, i = 0, n = 0; this.length = function () { return 8 * t }, this.bitsAvailable = function () { return 8 * t + n }, this.loadWord = function () { var r = e.byteLength - t, a = new Uint8Array(4), s = Math.min(4, t); if (0 === s) throw new Error("no bytes available"); a.set(e.subarray(r, r + s)), i = new DataView(a.buffer).getUint32(0), n = 8 * s, t -= s }, this.skipBits = function (e) { var r; n > e ? (i <<= e, n -= e) : (e -= n, e -= 8 * (r = Math.floor(e / 8)), t -= r, this.loadWord(), i <<= e, n -= e) }, this.readBits = function (e) { var r = Math.min(n, e), a = i >>> 32 - r; return (n -= r) > 0 ? i <<= r : t > 0 && this.loadWord(), (r = e - r) > 0 ? a << r | this.readBits(r) : a }, this.skipLeadingZeros = function () { var e; for (e = 0; e < n; ++e)if (0 !== (i & 2147483648 >>> e)) return i <<= e, n -= e, e; return this.loadWord(), e + this.skipLeadingZeros() }, this.skipUnsignedExpGolomb = function () { this.skipBits(1 + this.skipLeadingZeros()) }, this.skipExpGolomb = function () { this.skipBits(1 + this.skipLeadingZeros()) }, this.readUnsignedExpGolomb = function () { var e = this.skipLeadingZeros(); return this.readBits(e + 1) - 1 }, this.readExpGolomb = function () { var e = this.readUnsignedExpGolomb(); return 1 & e ? 1 + e >>> 1 : -1 * (e >>> 1) }, this.readBoolean = function () { return 1 === this.readBits(1) }, this.readUnsignedByte = function () { return this.readBits(8) }, this.loadWord() }; (Je = function () { var e, t, i = 0; Je.prototype.init.call(this), this.push = function (n) { var r; t ? ((r = new Uint8Array(t.byteLength + n.data.byteLength)).set(t), r.set(n.data, t.byteLength), t = r) : t = n.data; for (var a = t.byteLength; i < a - 3; i++)if (1 === t[i + 2]) { e = i + 5; break } for (; e < a;)switch (t[e]) { case 0: if (0 !== t[e - 1]) { e += 2; break } if (0 !== t[e - 2]) { e++; break } i + 3 !== e - 2 && this.trigger("data", t.subarray(i + 3, e - 2)); do { e++ } while (1 !== t[e] && e < a); i = e - 2, e += 3; break; case 1: if (0 !== t[e - 1] || 0 !== t[e - 2]) { e += 3; break } this.trigger("data", t.subarray(i + 3, e - 2)), i = e - 2, e += 3; break; default: e += 3 }t = t.subarray(i), e -= i, i = 0 }, this.reset = function () { t = null, i = 0, this.trigger("reset") }, this.flush = function () { t && t.byteLength > 3 && this.trigger("data", t.subarray(i + 3)), t = null, i = 0, this.trigger("done") }, this.endTimeline = function () { this.flush(), this.trigger("endedtimeline") } }).prototype = new j, Ze = { 100: !0, 110: !0, 122: !0, 244: !0, 44: !0, 83: !0, 86: !0, 118: !0, 128: !0, 138: !0, 139: !0, 134: !0 }, (Qe = function () { var e, t, i, n, r, a, s, o = new Je; Qe.prototype.init.call(this), e = this, this.push = function (e) { "video" === e.type && (t = e.trackId, i = e.pts, n = e.dts, o.push(e)) }, o.on("data", (function (s) { var o = { trackId: t, pts: i, dts: n, data: s }; switch (31 & s[0]) { case 5: o.nalUnitType = "slice_layer_without_partitioning_rbsp_idr"; break; case 6: o.nalUnitType = "sei_rbsp", o.escapedRBSP = r(s.subarray(1)); break; case 7: o.nalUnitType = "seq_parameter_set_rbsp", o.escapedRBSP = r(s.subarray(1)), o.config = a(o.escapedRBSP); break; case 8: o.nalUnitType = "pic_parameter_set_rbsp"; break; case 9: o.nalUnitType = "access_unit_delimiter_rbsp" }e.trigger("data", o) })), o.on("done", (function () { e.trigger("done") })), o.on("partialdone", (function () { e.trigger("partialdone") })), o.on("reset", (function () { e.trigger("reset") })), o.on("endedtimeline", (function () { e.trigger("endedtimeline") })), this.flush = function () { o.flush() }, this.partialFlush = function () { o.partialFlush() }, this.reset = function () { o.reset() }, this.endTimeline = function () { o.endTimeline() }, s = function (e, t) { var i, n = 8, r = 8; for (i = 0; i < e; i++)0 !== r && (r = (n + t.readExpGolomb() + 256) % 256), n = 0 === r ? n : r }, r = function (e) { for (var t, i, n = e.byteLength, r = [], a = 1; a < n - 2;)0 === e[a] && 0 === e[a + 1] && 3 === e[a + 2] ? (r.push(a + 2), a += 2) : a++; if (0 === r.length) return e; t = n - r.length, i = new Uint8Array(t); var s = 0; for (a = 0; a < t; s++, a++)s === r[0] && (s++, r.shift()), i[a] = e[s]; return i }, a = function (e) { var t, i, n, r, a, o, l, u, c, h, d, p, f, m = 0, g = 0, v = 0, y = 0, _ = 1; if (i = (t = new tt(e)).readUnsignedByte(), r = t.readUnsignedByte(), n = t.readUnsignedByte(), t.skipUnsignedExpGolomb(), Ze[i] && (3 === (a = t.readUnsignedExpGolomb()) && t.skipBits(1), t.skipUnsignedExpGolomb(), t.skipUnsignedExpGolomb(), t.skipBits(1), t.readBoolean())) for (d = 3 !== a ? 8 : 12, f = 0; f < d; f++)t.readBoolean() && s(f < 6 ? 16 : 64, t); if (t.skipUnsignedExpGolomb(), 0 === (o = t.readUnsignedExpGolomb())) t.readUnsignedExpGolomb(); else if (1 === o) for (t.skipBits(1), t.skipExpGolomb(), t.skipExpGolomb(), l = t.readUnsignedExpGolomb(), f = 0; f < l; f++)t.skipExpGolomb(); if (t.skipUnsignedExpGolomb(), t.skipBits(1), u = t.readUnsignedExpGolomb(), c = t.readUnsignedExpGolomb(), 0 === (h = t.readBits(1)) && t.skipBits(1), t.skipBits(1), t.readBoolean() && (m = t.readUnsignedExpGolomb(), g = t.readUnsignedExpGolomb(), v = t.readUnsignedExpGolomb(), y = t.readUnsignedExpGolomb()), t.readBoolean() && t.readBoolean()) { switch (t.readUnsignedByte()) { case 1: p = [1, 1]; break; case 2: p = [12, 11]; break; case 3: p = [10, 11]; break; case 4: p = [16, 11]; break; case 5: p = [40, 33]; break; case 6: p = [24, 11]; break; case 7: p = [20, 11]; break; case 8: p = [32, 11]; break; case 9: p = [80, 33]; break; case 10: p = [18, 11]; break; case 11: p = [15, 11]; break; case 12: p = [64, 33]; break; case 13: p = [160, 99]; break; case 14: p = [4, 3]; break; case 15: p = [3, 2]; break; case 16: p = [2, 1]; break; case 255: p = [t.readUnsignedByte() << 8 | t.readUnsignedByte(), t.readUnsignedByte() << 8 | t.readUnsignedByte()] }p && (_ = p[0] / p[1]) } return { profileIdc: i, levelIdc: n, profileCompatibility: r, width: Math.ceil((16 * (u + 1) - 2 * m - 2 * g) * _), height: (2 - h) * (c + 1) * 16 - 2 * v - 2 * y, sarRatio: p } } }).prototype = new j; var it, nt = { H264Stream: Qe, NalByteStream: Je }, rt = function (e) { return e[0] === "I".charCodeAt(0) && e[1] === "D".charCodeAt(0) && e[2] === "3".charCodeAt(0) }, at = function (e, t) { var i = e[t + 6] << 21 | e[t + 7] << 14 | e[t + 8] << 7 | e[t + 9]; return (16 & e[t + 5]) >> 4 ? i + 20 : i + 10 }, st = function (e, t) { var i = (224 & e[t + 5]) >> 5, n = e[t + 4] << 3; return 6144 & e[t + 3] | n | i }; (it = function () { var e = new Uint8Array, t = 0; it.prototype.init.call(this), this.setTimestamp = function (e) { t = e }, this.push = function (i) { var n, r, a, s, o = 0, l = 0; for (e.length ? (s = e.length, (e = new Uint8Array(i.byteLength + s)).set(e.subarray(0, s)), e.set(i, s)) : e = i; e.length - l >= 3;)if (e[l] !== "I".charCodeAt(0) || e[l + 1] !== "D".charCodeAt(0) || e[l + 2] !== "3".charCodeAt(0)) if (255 !== (255 & e[l]) || 240 !== (240 & e[l + 1])) l++; else { if (e.length - l < 7) break; if (l + (o = st(e, l)) > e.length) break; a = { type: "audio", data: e.subarray(l, l + o), pts: t, dts: t }, this.trigger("data", a), l += o } else { if (e.length - l < 10) break; if (l + (o = at(e, l)) > e.length) break; r = { type: "timed-metadata", data: e.subarray(l, l + o) }, this.trigger("data", r), l += o } n = e.length - l, e = n > 0 ? e.subarray(l) : new Uint8Array }, this.reset = function () { e = new Uint8Array, this.trigger("reset") }, this.endTimeline = function () { e = new Uint8Array, this.trigger("endedtimeline") } }).prototype = new j; var ot, lt, ut, ct, ht = it, dt = nt.H264Stream, pt = rt, ft = le, mt = ["audioobjecttype", "channelcount", "samplerate", "samplingfrequencyindex", "samplesize"], gt = ["width", "height", "profileIdc", "levelIdc", "profileCompatibility", "sarRatio"], vt = function (e, t) { var i; if (e.length !== t.length) return !1; for (i = 0; i < e.length; i++)if (e[i] !== t[i]) return !1; return !0 }, yt = function (e, t, i, n, r, a) { return { start: { dts: e, pts: e + (i - t) }, end: { dts: e + (n - t), pts: e + (r - i) }, prependedContentDuration: a, baseMediaDecodeTime: e } }; (lt = function (e, t) { var i = [], n = 0, r = 0, a = 0, s = 1 / 0; t = t || {}, lt.prototype.init.call(this), this.push = function (t) { _e(e, t), e && mt.forEach((function (i) { e[i] = t[i] })), i.push(t) }, this.setEarliestDts = function (t) { r = t - e.timelineStartInfo.baseMediaDecodeTime }, this.setVideoBaseMediaDecodeTime = function (e) { s = e }, this.setAudioAppendStart = function (e) { a = e }, this.flush = function () { var o, l, u, c, h; 0 !== i.length ? (o = pe(i, e, r), e.baseMediaDecodeTime = ye(e, t.keepOriginalTimestamps), de(e, o, a, s), e.samples = fe(o), u = Y(me(o)), i = [], l = X(n, [e]), c = new Uint8Array(l.byteLength + u.byteLength), n++, c.set(l), c.set(u, l.byteLength), ve(e), h = Math.ceil(1024 * ft / e.samplerate), o.length && this.trigger("timingInfo", { start: o[0].dts, end: o[0].dts + o.length * h }), this.trigger("data", { track: e, boxes: c }), this.trigger("done", "AudioSegmentStream")) : this.trigger("done", "AudioSegmentStream") }, this.reset = function () { ve(e), i = [], this.trigger("reset") } }).prototype = new j, (ot = function (e, t) { var i, n, r = 0, a = [], s = []; t = t || {}, ot.prototype.init.call(this), delete e.minPTS, this.gopCache_ = [], this.push = function (t) { _e(e, t), "seq_parameter_set_rbsp" !== t.nalUnitType || i || (i = t.config, e.sps = [t.data], gt.forEach((function (t) { e[t] = i[t] }), this)), "pic_parameter_set_rbsp" !== t.nalUnitType || n || (n = t.data, e.pps = [t.data]), a.push(t) }, this.flush = function () { for (var i, n, o, l, u, c, h, d, p = 0; a.length && "access_unit_delimiter_rbsp" !== a[0].nalUnitType;)a.shift(); if (0 === a.length) return this.resetStream_(), void this.trigger("done", "VideoSegmentStream"); if (i = J(a), (o = Z(i))[0][0].keyFrame || ((n = this.getGopForFusion_(a[0], e)) ? (p = n.duration, o.unshift(n), o.byteLength += n.byteLength, o.nalCount += n.nalCount, o.pts = n.pts, o.dts = n.dts, o.duration += n.duration) : o = ee(o)), s.length) { var f; if (!(f = t.alignGopsAtEnd ? this.alignGopsAtEnd_(o) : this.alignGopsAtStart_(o))) return this.gopCache_.unshift({ gop: o.pop(), pps: e.pps, sps: e.sps }), this.gopCache_.length = Math.min(6, this.gopCache_.length), a = [], this.resetStream_(), void this.trigger("done", "VideoSegmentStream"); ve(e), o = f } _e(e, o), e.samples = te(o), u = Y(ie(o)), e.baseMediaDecodeTime = ye(e, t.keepOriginalTimestamps), this.trigger("processedGopsInfo", o.map((function (e) { return { pts: e.pts, dts: e.dts, byteLength: e.byteLength } }))), h = o[0], d = o[o.length - 1], this.trigger("segmentTimingInfo", yt(e.baseMediaDecodeTime, h.dts, h.pts, d.dts + d.duration, d.pts + d.duration, p)), this.trigger("timingInfo", { start: o[0].dts, end: o[o.length - 1].dts + o[o.length - 1].duration }), this.gopCache_.unshift({ gop: o.pop(), pps: e.pps, sps: e.sps }), this.gopCache_.length = Math.min(6, this.gopCache_.length), a = [], this.trigger("baseMediaDecodeTime", e.baseMediaDecodeTime), this.trigger("timelineStartInfo", e.timelineStartInfo), l = X(r, [e]), c = new Uint8Array(l.byteLength + u.byteLength), r++, c.set(l), c.set(u, l.byteLength), this.trigger("data", { track: e, boxes: c }), this.resetStream_(), this.trigger("done", "VideoSegmentStream") }, this.reset = function () { this.resetStream_(), a = [], this.gopCache_.length = 0, s.length = 0, this.trigger("reset") }, this.resetStream_ = function () { ve(e), i = void 0, n = void 0 }, this.getGopForFusion_ = function (t) { var i, n, r, a, s, o = 1 / 0; for (s = 0; s < this.gopCache_.length; s++)r = (a = this.gopCache_[s]).gop, e.pps && vt(e.pps[0], a.pps[0]) && e.sps && vt(e.sps[0], a.sps[0]) && (r.dts < e.timelineStartInfo.dts || (i = t.dts - r.dts - r.duration) >= -1e4 && i <= 45e3 && (!n || o > i) && (n = a, o = i)); return n ? n.gop : null }, this.alignGopsAtStart_ = function (e) { var t, i, n, r, a, o, l, u; for (a = e.byteLength, o = e.nalCount, l = e.duration, t = i = 0; t < s.length && i < e.length && (n = s[t], r = e[i], n.pts !== r.pts);)r.pts > n.pts ? t++ : (i++, a -= r.byteLength, o -= r.nalCount, l -= r.duration); return 0 === i ? e : i === e.length ? null : ((u = e.slice(i)).byteLength = a, u.duration = l, u.nalCount = o, u.pts = u[0].pts, u.dts = u[0].dts, u) }, this.alignGopsAtEnd_ = function (e) { var t, i, n, r, a, o, l; for (t = s.length - 1, i = e.length - 1, a = null, o = !1; t >= 0 && i >= 0;) { if (n = s[t], r = e[i], n.pts === r.pts) { o = !0; break } n.pts > r.pts ? t-- : (t === s.length - 1 && (a = i), i--) } if (!o && null === a) return null; if (0 === (l = o ? i : a)) return e; var u = e.slice(l), c = u.reduce((function (e, t) { return e.byteLength += t.byteLength, e.duration += t.duration, e.nalCount += t.nalCount, e }), { byteLength: 0, duration: 0, nalCount: 0 }); return u.byteLength = c.byteLength, u.duration = c.duration, u.nalCount = c.nalCount, u.pts = u[0].pts, u.dts = u[0].dts, u }, this.alignGopsWith = function (e) { s = e } }).prototype = new j, (ct = function (e, t) { this.numberOfTracks = 0, this.metadataStream = t, "undefined" !== typeof (e = e || {}).remux ? this.remuxTracks = !!e.remux : this.remuxTracks = !0, "boolean" === typeof e.keepOriginalTimestamps ? this.keepOriginalTimestamps = e.keepOriginalTimestamps : this.keepOriginalTimestamps = !1, this.pendingTracks = [], this.videoTrack = null, this.pendingBoxes = [], this.pendingCaptions = [], this.pendingMetadata = [], this.pendingBytes = 0, this.emittedTracks = 0, ct.prototype.init.call(this), this.push = function (e) { return e.text ? this.pendingCaptions.push(e) : e.frames ? this.pendingMetadata.push(e) : (this.pendingTracks.push(e.track), this.pendingBytes += e.boxes.byteLength, "video" === e.track.type && (this.videoTrack = e.track, this.pendingBoxes.push(e.boxes)), void ("audio" === e.track.type && (this.audioTrack = e.track, this.pendingBoxes.unshift(e.boxes)))) } }).prototype = new j, ct.prototype.flush = function (e) { var t, i, n, r, a = 0, s = { captions: [], captionStreams: {}, metadata: [], info: {} }, o = 0; if (this.pendingTracks.length < this.numberOfTracks) { if ("VideoSegmentStream" !== e && "AudioSegmentStream" !== e) return; if (this.remuxTracks) return; if (0 === this.pendingTracks.length) return this.emittedTracks++, void (this.emittedTracks >= this.numberOfTracks && (this.trigger("done"), this.emittedTracks = 0)) } if (this.videoTrack ? (o = this.videoTrack.timelineStartInfo.pts, gt.forEach((function (e) { s.info[e] = this.videoTrack[e] }), this)) : this.audioTrack && (o = this.audioTrack.timelineStartInfo.pts, mt.forEach((function (e) { s.info[e] = this.audioTrack[e] }), this)), this.videoTrack || this.audioTrack) { for (1 === this.pendingTracks.length ? s.type = this.pendingTracks[0].type : s.type = "combined", this.emittedTracks += this.pendingTracks.length, n = $(this.pendingTracks), s.initSegment = new Uint8Array(n.byteLength), s.initSegment.set(n), s.data = new Uint8Array(this.pendingBytes), r = 0; r < this.pendingBoxes.length; r++)s.data.set(this.pendingBoxes[r], a), a += this.pendingBoxes[r].byteLength; for (r = 0; r < this.pendingCaptions.length; r++)(t = this.pendingCaptions[r]).startTime = he(t.startPts, o, this.keepOriginalTimestamps), t.endTime = he(t.endPts, o, this.keepOriginalTimestamps), s.captionStreams[t.stream] = !0, s.captions.push(t); for (r = 0; r < this.pendingMetadata.length; r++)(i = this.pendingMetadata[r]).cueTime = he(i.pts, o, this.keepOriginalTimestamps), s.metadata.push(i); for (s.metadata.dispatchType = this.metadataStream.dispatchType, this.pendingTracks.length = 0, this.videoTrack = null, this.pendingBoxes.length = 0, this.pendingCaptions.length = 0, this.pendingBytes = 0, this.pendingMetadata.length = 0, this.trigger("data", s), r = 0; r < s.captions.length; r++)t = s.captions[r], this.trigger("caption", t); for (r = 0; r < s.metadata.length; r++)i = s.metadata[r], this.trigger("id3Frame", i) } this.emittedTracks >= this.numberOfTracks && (this.trigger("done"), this.emittedTracks = 0) }, ct.prototype.setRemux = function (e) { this.remuxTracks = e }, (ut = function (e) { var t, i, n = this, r = !0; ut.prototype.init.call(this), e = e || {}, this.baseMediaDecodeTime = e.baseMediaDecodeTime || 0, this.transmuxPipeline_ = {}, this.setupAacPipeline = function () { var r = {}; this.transmuxPipeline_ = r, r.type = "aac", r.metadataStream = new Ye.MetadataStream, r.aacStream = new ht, r.audioTimestampRolloverStream = new Ye.TimestampRolloverStream("audio"), r.timedMetadataTimestampRolloverStream = new Ye.TimestampRolloverStream("timed-metadata"), r.adtsStream = new et, r.coalesceStream = new ct(e, r.metadataStream), r.headOfPipeline = r.aacStream, r.aacStream.pipe(r.audioTimestampRolloverStream).pipe(r.adtsStream), r.aacStream.pipe(r.timedMetadataTimestampRolloverStream).pipe(r.metadataStream).pipe(r.coalesceStream), r.metadataStream.on("timestamp", (function (e) { r.aacStream.setTimestamp(e.timeStamp) })), r.aacStream.on("data", (function (a) { "timed-metadata" !== a.type || r.audioSegmentStream || (i = i || { timelineStartInfo: { baseMediaDecodeTime: n.baseMediaDecodeTime }, codec: "adts", type: "audio" }, r.coalesceStream.numberOfTracks++, r.audioSegmentStream = new lt(i, e), r.audioSegmentStream.on("timingInfo", n.trigger.bind(n, "audioTimingInfo")), r.adtsStream.pipe(r.audioSegmentStream).pipe(r.coalesceStream)), n.trigger("trackinfo", { hasAudio: !!i, hasVideo: !!t }) })), r.coalesceStream.on("data", this.trigger.bind(this, "data")), r.coalesceStream.on("done", this.trigger.bind(this, "done")) }, this.setupTsPipeline = function () { var r = {}; this.transmuxPipeline_ = r, r.type = "ts", r.metadataStream = new Ye.MetadataStream, r.packetStream = new Ye.TransportPacketStream, r.parseStream = new Ye.TransportParseStream, r.elementaryStream = new Ye.ElementaryStream, r.timestampRolloverStream = new Ye.TimestampRolloverStream, r.adtsStream = new et, r.h264Stream = new dt, r.captionStream = new Ye.CaptionStream, r.coalesceStream = new ct(e, r.metadataStream), r.headOfPipeline = r.packetStream, r.packetStream.pipe(r.parseStream).pipe(r.elementaryStream).pipe(r.timestampRolloverStream), r.timestampRolloverStream.pipe(r.h264Stream), r.timestampRolloverStream.pipe(r.adtsStream), r.timestampRolloverStream.pipe(r.metadataStream).pipe(r.coalesceStream), r.h264Stream.pipe(r.captionStream).pipe(r.coalesceStream), r.elementaryStream.on("data", (function (a) { var s; if ("metadata" === a.type) { for (s = a.tracks.length; s--;)t || "video" !== a.tracks[s].type ? i || "audio" !== a.tracks[s].type || ((i = a.tracks[s]).timelineStartInfo.baseMediaDecodeTime = n.baseMediaDecodeTime) : (t = a.tracks[s]).timelineStartInfo.baseMediaDecodeTime = n.baseMediaDecodeTime; t && !r.videoSegmentStream && (r.coalesceStream.numberOfTracks++, r.videoSegmentStream = new ot(t, e), r.videoSegmentStream.on("timelineStartInfo", (function (e) { i && (i.timelineStartInfo = e, r.audioSegmentStream.setEarliestDts(e.dts)) })), r.videoSegmentStream.on("processedGopsInfo", n.trigger.bind(n, "gopInfo")), r.videoSegmentStream.on("segmentTimingInfo", n.trigger.bind(n, "videoSegmentTimingInfo")), r.videoSegmentStream.on("baseMediaDecodeTime", (function (e) { i && r.audioSegmentStream.setVideoBaseMediaDecodeTime(e) })), r.videoSegmentStream.on("timingInfo", n.trigger.bind(n, "videoTimingInfo")), r.h264Stream.pipe(r.videoSegmentStream).pipe(r.coalesceStream)), i && !r.audioSegmentStream && (r.coalesceStream.numberOfTracks++, r.audioSegmentStream = new lt(i, e), r.audioSegmentStream.on("timingInfo", n.trigger.bind(n, "audioTimingInfo")), r.adtsStream.pipe(r.audioSegmentStream).pipe(r.coalesceStream)), n.trigger("trackinfo", { hasAudio: !!i, hasVideo: !!t }) } })), r.coalesceStream.on("data", this.trigger.bind(this, "data")), r.coalesceStream.on("id3Frame", (function (e) { e.dispatchType = r.metadataStream.dispatchType, n.trigger("id3Frame", e) })), r.coalesceStream.on("caption", this.trigger.bind(this, "caption")), r.coalesceStream.on("done", this.trigger.bind(this, "done")) }, this.setBaseMediaDecodeTime = function (n) { var r = this.transmuxPipeline_; e.keepOriginalTimestamps || (this.baseMediaDecodeTime = n), i && (i.timelineStartInfo.dts = void 0, i.timelineStartInfo.pts = void 0, ve(i), e.keepOriginalTimestamps || (i.timelineStartInfo.baseMediaDecodeTime = n), r.audioTimestampRolloverStream && r.audioTimestampRolloverStream.discontinuity()), t && (r.videoSegmentStream && (r.videoSegmentStream.gopCache_ = []), t.timelineStartInfo.dts = void 0, t.timelineStartInfo.pts = void 0, ve(t), r.captionStream.reset(), e.keepOriginalTimestamps || (t.timelineStartInfo.baseMediaDecodeTime = n)), r.timestampRolloverStream && r.timestampRolloverStream.discontinuity() }, this.setAudioAppendStart = function (e) { i && this.transmuxPipeline_.audioSegmentStream.setAudioAppendStart(e) }, this.setRemux = function (t) { var i = this.transmuxPipeline_; e.remux = t, i && i.coalesceStream && i.coalesceStream.setRemux(t) }, this.alignGopsWith = function (e) { t && this.transmuxPipeline_.videoSegmentStream && this.transmuxPipeline_.videoSegmentStream.alignGopsWith(e) }, this.push = function (e) { if (r) { var t = pt(e); t && "aac" !== this.transmuxPipeline_.type ? this.setupAacPipeline() : t || "ts" === this.transmuxPipeline_.type || this.setupTsPipeline(), r = !1 } this.transmuxPipeline_.headOfPipeline.push(e) }, this.flush = function () { r = !0, this.transmuxPipeline_.headOfPipeline.flush() }, this.endTimeline = function () { this.transmuxPipeline_.headOfPipeline.endTimeline() }, this.reset = function () { this.transmuxPipeline_.headOfPipeline && this.transmuxPipeline_.headOfPipeline.reset() }, this.resetCaptions = function () { this.transmuxPipeline_.captionStream && this.transmuxPipeline_.captionStream.reset() } }).prototype = new j; var _t = { Transmuxer: ut, VideoSegmentStream: ot, AudioSegmentStream: lt, AUDIO_PROPERTIES: mt, VIDEO_PROPERTIES: gt, generateVideoSegmentTimingInfo: yt }, bt = function (e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") }, Tt = function () { function e(e, t) { for (var i = 0; i < t.length; i++) { var n = t[i]; n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, n.key, n) } } return function (t, i, n) { return i && e(t.prototype, i), n && e(t, n), t } }(), kt = function () { function e(t, i) { bt(this, e), this.options = i || {}, this.self = t, this.init() } return Tt(e, [{ key: "init", value: function () { this.transmuxer && this.transmuxer.dispose(), this.transmuxer = new _t.Transmuxer(this.options), function (e, t) { t.on("data", (function (t) { var i = t.initSegment; t.initSegment = { data: i.buffer, byteOffset: i.byteOffset, byteLength: i.byteLength }; var n = t.data; t.data = n.buffer, e.postMessage({ action: "data", segment: t, byteOffset: n.byteOffset, byteLength: n.byteLength }, [t.data]) })), t.captionStream && t.captionStream.on("data", (function (t) { e.postMessage({ action: "caption", data: t }) })), t.on("done", (function (t) { e.postMessage({ action: "done" }) })), t.on("gopInfo", (function (t) { e.postMessage({ action: "gopInfo", gopInfo: t }) })), t.on("videoSegmentTimingInfo", (function (t) { e.postMessage({ action: "videoSegmentTimingInfo", videoSegmentTimingInfo: t }) })) }(this.self, this.transmuxer) } }, { key: "push", value: function (e) { var t = new Uint8Array(e.data, e.byteOffset, e.byteLength); this.transmuxer.push(t) } }, { key: "reset", value: function () { this.init() } }, { key: "setTimestampOffset", value: function (e) { var t = e.timestampOffset || 0; this.transmuxer.setBaseMediaDecodeTime(Math.round(9e4 * t)) } }, { key: "setAudioAppendStart", value: function (e) { this.transmuxer.setAudioAppendStart(Math.ceil(9e4 * e.appendStart)) } }, { key: "flush", value: function (e) { this.transmuxer.flush() } }, { key: "resetCaptions", value: function () { this.transmuxer.resetCaptions() } }, { key: "alignGopsWith", value: function (e) { this.transmuxer.alignGopsWith(e.gopsToAlignWith.slice()) } }]), e }(); new function (e) { e.onmessage = function (t) { "init" === t.data.action && t.data.options ? this.messageHandlers = new kt(e, t.data.options) : (this.messageHandlers || (this.messageHandlers = new kt(e)), t.data && t.data.action && "init" !== t.data.action && this.messageHandlers[t.data.action] && this.messageHandlers[t.data.action](t.data)) } }(i) }() })), Qa = { videoCodec: "avc1", videoObjectTypeIndicator: ".4d400d", audioProfile: "2" }, Ja = function (e) { return e.map((function (e) { return e.replace(/avc1\.(\d+)\.(\d+)/i, (function (e, t, i) { return "avc1." + ("00" + Number(t).toString(16)).slice(-2) + "00" + ("00" + Number(i).toString(16)).slice(-2) })) })) }, Za = function () { var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : "", t = { codecCount: 0 }, i = void 0; return t.codecCount = e.split(",").length, t.codecCount = t.codecCount || 2, (i = /(^|\s|,)+(avc[13])([^ ,]*)/i.exec(e)) && (t.videoCodec = i[2], t.videoObjectTypeIndicator = i[3]), t.audioProfile = /(^|\s|,)+mp4a.[0-9A-Fa-f]+\.([0-9A-Fa-f]+)/i.exec(e), t.audioProfile = t.audioProfile && t.audioProfile[2], t }, es = function (e, t, i) { return e + "/" + t + '; codecs="' + i.filter((function (e) { return !!e })).join(", ") + '"' }, ts = function (e, t) { var i = function (e) { return e.segments && e.segments.length && e.segments[0].map ? "mp4" : "mp2t" }(t), n = function (e) { var t = e.attributes || {}; return t.CODECS ? Za(t.CODECS) : Qa }(t), r = t.attributes || {}, a = !0, s = !1; if (!t) return []; if (e.mediaGroups.AUDIO && r.AUDIO) { var o = e.mediaGroups.AUDIO[r.AUDIO]; if (o) for (var l in s = !0, a = !1, o) if (!o[l].uri && !o[l].playlists) { a = !0; break } } s && !n.audioProfile && (a || (n.audioProfile = function (e, t) { if (!e.mediaGroups.AUDIO || !t) return null; var i = e.mediaGroups.AUDIO[t]; if (!i) return null; for (var n in i) { var r = i[n]; if (r.default && r.playlists) return Za(r.playlists[0].attributes.CODECS).audioProfile } return null }(e, r.AUDIO)), n.audioProfile || (Br.log.warn("Multiple audio tracks present but no audio codec string is specified. Attempting to use the default audio codec (mp4a.40.2)"), n.audioProfile = Qa.audioProfile)); var u = {}; n.videoCodec && (u.video = "" + n.videoCodec + n.videoObjectTypeIndicator), n.audioProfile && (u.audio = "mp4a.40." + n.audioProfile); var c = es("audio", i, [u.audio]), h = es("video", i, [u.video]), d = es("video", i, [u.video, u.audio]); return s ? !a && u.video ? [h, c] : a || u.video ? [d, c] : [c, c] : u.video ? [d] : [c] }, is = function (e) { return /mp4a\.\d+.\d+/i.test(e) }, ns = function (e) { return /avc1\.[\da-f]+/i.test(e) }, rs = function (e, t, i) { if ("undefined" === typeof t || null === t || !e.length) return []; var n = Math.ceil(9e4 * (t - i + 3)), r = void 0; for (r = 0; r < e.length && !(e[r].pts > n); r++); return e.slice(r) }, as = function (e, t, i) { var n = null, r = null, a = 0, s = [], o = []; if (!e && !t) return Br.createTimeRange(); if (!e) return t.buffered; if (!t) return e.buffered; if (i) return e.buffered; if (0 === e.buffered.length && 0 === t.buffered.length) return Br.createTimeRange(); for (var l = e.buffered, u = t.buffered, c = l.length; c--;)s.push({ time: l.start(c), type: "start" }), s.push({ time: l.end(c), type: "end" }); for (c = u.length; c--;)s.push({ time: u.start(c), type: "start" }), s.push({ time: u.end(c), type: "end" }); for (s.sort((function (e, t) { return e.time - t.time })), c = 0; c < s.length; c++)"start" === s[c].type ? 2 === ++a && (n = s[c].time) : "end" === s[c].type && 1 === --a && (r = s[c].time), null !== n && null !== r && (o.push([n, r]), n = null, r = null); return Br.createTimeRanges(o) }, ss = function (e) { function t(e, i) { Hr(this, t); var n = Wr(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, Br.EventTarget)); n.timestampOffset_ = 0, n.pendingBuffers_ = [], n.bufferUpdating_ = !1, n.mediaSource_ = e, n.codecs_ = i, n.audioCodec_ = null, n.videoCodec_ = null, n.audioDisabled_ = !1, n.appendAudioInitSegment_ = !0, n.gopBuffer_ = [], n.timeMapping_ = 0, n.safeAppend_ = Br.browser.IE_VERSION >= 11; var r = { remux: !1, alignGopsAtEnd: n.safeAppend_ }; return n.codecs_.forEach((function (e) { is(e) ? n.audioCodec_ = e : ns(e) && (n.videoCodec_ = e) })), n.transmuxer_ = new $a, n.transmuxer_.postMessage({ action: "init", options: r }), n.transmuxer_.onmessage = function (e) { return "data" === e.data.action ? n.data_(e) : "done" === e.data.action ? n.done_(e) : "gopInfo" === e.data.action ? n.appendGopInfo_(e) : "videoSegmentTimingInfo" === e.data.action ? n.videoSegmentTimingInfo_(e.data.videoSegmentTimingInfo) : void 0 }, Object.defineProperty(n, "timestampOffset", { get: function () { return this.timestampOffset_ }, set: function (e) { "number" === typeof e && e >= 0 && (this.timestampOffset_ = e, this.appendAudioInitSegment_ = !0, this.gopBuffer_.length = 0, this.timeMapping_ = 0, this.transmuxer_.postMessage({ action: "setTimestampOffset", timestampOffset: e })) } }), Object.defineProperty(n, "appendWindowStart", { get: function () { return (this.videoBuffer_ || this.audioBuffer_).appendWindowStart }, set: function (e) { this.videoBuffer_ && (this.videoBuffer_.appendWindowStart = e), this.audioBuffer_ && (this.audioBuffer_.appendWindowStart = e) } }), Object.defineProperty(n, "updating", { get: function () { return !!(this.bufferUpdating_ || !this.audioDisabled_ && this.audioBuffer_ && this.audioBuffer_.updating || this.videoBuffer_ && this.videoBuffer_.updating) } }), Object.defineProperty(n, "buffered", { get: function () { return as(this.videoBuffer_, this.audioBuffer_, this.audioDisabled_) } }), n } return Vr(t, e), qr(t, [{ key: "data_", value: function (e) { var t = e.data.segment; t.data = new Uint8Array(t.data, e.data.byteOffset, e.data.byteLength), t.initSegment = new Uint8Array(t.initSegment.data, t.initSegment.byteOffset, t.initSegment.byteLength), function (e, t, i) { var n = t.player_; if (i.captions && i.captions.length) for (var r in e.inbandTextTracks_ || (e.inbandTextTracks_ = {}), i.captionStreams) if (!e.inbandTextTracks_[r]) { n.tech_.trigger({ type: "usage", name: "hls-608" }); var a = n.textTracks().getTrackById(r); e.inbandTextTracks_[r] = a || n.addRemoteTextTrack({ kind: "captions", id: r, label: r }, !1).track } i.metadata && i.metadata.length && !e.metadataTrack_ && (e.metadataTrack_ = n.addRemoteTextTrack({ kind: "metadata", label: "Timed Metadata" }, !1).track, e.metadataTrack_.inBandMetadataTrackDispatchType = i.metadata.dispatchType) }(this, this.mediaSource_, t), this.pendingBuffers_.push(t) } }, { key: "done_", value: function (e) { "closed" !== this.mediaSource_.readyState ? this.processPendingSegments_() : this.pendingBuffers_.length = 0 } }, { key: "videoSegmentTimingInfo_", value: function (e) { var t = { start: { decode: e.start.dts / 9e4, presentation: e.start.pts / 9e4 }, end: { decode: e.end.dts / 9e4, presentation: e.end.pts / 9e4 }, baseMediaDecodeTime: e.baseMediaDecodeTime / 9e4 }; e.prependedContentDuration && (t.prependedContentDuration = e.prependedContentDuration / 9e4), this.trigger({ type: "videoSegmentTimingInfo", videoSegmentTimingInfo: t }) } }, { key: "createRealSourceBuffers_", value: function () { var e = this, t = ["audio", "video"]; t.forEach((function (i) { if (e[i + "Codec_"] && !e[i + "Buffer_"]) { var n = null; if (e.mediaSource_[i + "Buffer_"]) (n = e.mediaSource_[i + "Buffer_"]).updating = !1; else { var r = i + '/mp4;codecs="' + e[i + "Codec_"] + '"'; n = function (e, t) { var i = e.addSourceBuffer(t), n = Object.create(null); n.updating = !1, n.realBuffer_ = i; var r = function (e) { "function" === typeof i[e] ? n[e] = function () { return i[e].apply(i, arguments) } : "undefined" === typeof n[e] && Object.defineProperty(n, e, { get: function () { return i[e] }, set: function (t) { return i[e] = t } }) }; for (var a in i) r(a); return n }(e.mediaSource_.nativeMediaSource_, r), e.mediaSource_[i + "Buffer_"] = n } e[i + "Buffer_"] = n, ["update", "updatestart", "updateend"].forEach((function (r) { n.addEventListener(r, (function () { if ("audio" !== i || !e.audioDisabled_) return "updateend" === r && (e[i + "Buffer_"].updating = !1), t.every((function (t) { return !("audio" !== t || !e.audioDisabled_) || (i === t || !e[t + "Buffer_"] || !e[t + "Buffer_"].updating) })) ? e.trigger(r) : void 0 })) })) } })) } }, { key: "appendBuffer", value: function (e) { if (this.bufferUpdating_ = !0, this.audioBuffer_ && this.audioBuffer_.buffered.length) { var t = this.audioBuffer_.buffered; this.transmuxer_.postMessage({ action: "setAudioAppendStart", appendStart: t.end(t.length - 1) }) } this.videoBuffer_ && this.transmuxer_.postMessage({ action: "alignGopsWith", gopsToAlignWith: rs(this.gopBuffer_, this.mediaSource_.player_ ? this.mediaSource_.player_.currentTime() : null, this.timeMapping_) }), this.transmuxer_.postMessage({ action: "push", data: e.buffer, byteOffset: e.byteOffset, byteLength: e.byteLength }, [e.buffer]), this.transmuxer_.postMessage({ action: "flush" }) } }, { key: "appendGopInfo_", value: function (e) { this.gopBuffer_ = function (e, t, i) { if (!t.length) return e; if (i) return t.slice(); for (var n = t[0].pts, r = 0; r < e.length && !(e[r].pts >= n); r++); return e.slice(0, r).concat(t) }(this.gopBuffer_, e.data.gopInfo, this.safeAppend_) } }, { key: "remove", value: function (e, t) { if (this.videoBuffer_ && (this.videoBuffer_.updating = !0, this.videoBuffer_.remove(e, t), this.gopBuffer_ = function (e, t, i, n) { for (var r = Math.ceil(9e4 * (t - n)), a = Math.ceil(9e4 * (i - n)), s = e.slice(), o = e.length; o-- && !(e[o].pts <= a);); if (-1 === o) return s; for (var l = o + 1; l-- && !(e[l].pts <= r);); return l = Math.max(l, 0), s.splice(l, o - l + 1), s }(this.gopBuffer_, e, t, this.timeMapping_)), !this.audioDisabled_ && this.audioBuffer_ && (this.audioBuffer_.updating = !0, this.audioBuffer_.remove(e, t)), Ba(e, t, this.metadataTrack_), this.inbandTextTracks_) for (var i in this.inbandTextTracks_) Ba(e, t, this.inbandTextTracks_[i]) } }, { key: "processPendingSegments_", value: function () { var e = { video: { segments: [], bytes: 0 }, audio: { segments: [], bytes: 0 }, captions: [], metadata: [] }; if (!this.pendingBuffers_.length) return this.trigger("updateend"), void (this.bufferUpdating_ = !1); e = this.pendingBuffers_.reduce((function (e, t) { var i = t.type, n = t.data, r = t.initSegment; return e[i].segments.push(n), e[i].bytes += n.byteLength, e[i].initSegment = r, t.captions && (e.captions = e.captions.concat(t.captions)), t.info && (e[i].info = t.info), t.metadata && (e.metadata = e.metadata.concat(t.metadata)), e }), e), this.videoBuffer_ || this.audioBuffer_ || (0 === e.video.bytes && (this.videoCodec_ = null), 0 === e.audio.bytes && (this.audioCodec_ = null), this.createRealSourceBuffers_()), e.audio.info && this.mediaSource_.trigger({ type: "audioinfo", info: e.audio.info }), e.video.info && this.mediaSource_.trigger({ type: "videoinfo", info: e.video.info }), this.appendAudioInitSegment_ && (!this.audioDisabled_ && this.audioBuffer_ && (e.audio.segments.unshift(e.audio.initSegment), e.audio.bytes += e.audio.initSegment.byteLength), this.appendAudioInitSegment_ = !1); var t = !1; this.videoBuffer_ && e.video.bytes ? (e.video.segments.unshift(e.video.initSegment), e.video.bytes += e.video.initSegment.byteLength, this.concatAndAppendSegments_(e.video, this.videoBuffer_)) : !this.videoBuffer_ || !this.audioDisabled_ && this.audioBuffer_ || (t = !0), ja(this, e.captions, e.metadata), !this.audioDisabled_ && this.audioBuffer_ && this.concatAndAppendSegments_(e.audio, this.audioBuffer_), this.pendingBuffers_.length = 0, t && this.trigger("updateend"), this.bufferUpdating_ = !1 } }, { key: "concatAndAppendSegments_", value: function (e, t) { var i = 0, n = void 0; if (e.bytes) { n = new Uint8Array(e.bytes), e.segments.forEach((function (e) { n.set(e, i), i += e.byteLength })); try { t.updating = !0, t.appendBuffer(n) } catch (r) { this.mediaSource_.player_ && this.mediaSource_.player_.error({ code: -3, type: "APPEND_BUFFER_ERR", message: r.message, originalError: r }) } } } }, { key: "abort", value: function () { this.videoBuffer_ && this.videoBuffer_.abort(), !this.audioDisabled_ && this.audioBuffer_ && this.audioBuffer_.abort(), this.transmuxer_ && this.transmuxer_.postMessage({ action: "reset" }), this.pendingBuffers_.length = 0, this.bufferUpdating_ = !1 } }]), t }(Br.EventTarget), os = function (e) { function t() { Hr(this, t); var e = Wr(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this)), i = void 0; for (i in e.nativeMediaSource_ = new r.a.MediaSource, e.nativeMediaSource_) i in t.prototype || "function" !== typeof e.nativeMediaSource_[i] || (e[i] = e.nativeMediaSource_[i].bind(e.nativeMediaSource_)); return e.duration_ = NaN, Object.defineProperty(e, "duration", { get: function () { return this.duration_ === 1 / 0 ? this.duration_ : this.nativeMediaSource_.duration }, set: function (e) { this.duration_ = e, e === 1 / 0 || (this.nativeMediaSource_.duration = e) } }), Object.defineProperty(e, "seekable", { get: function () { return this.duration_ === 1 / 0 ? Br.createTimeRanges([[0, this.nativeMediaSource_.duration]]) : this.nativeMediaSource_.seekable } }), Object.defineProperty(e, "readyState", { get: function () { return this.nativeMediaSource_.readyState } }), Object.defineProperty(e, "activeSourceBuffers", { get: function () { return this.activeSourceBuffers_ } }), e.sourceBuffers = [], e.activeSourceBuffers_ = [], e.updateActiveSourceBuffers_ = function () { if (e.activeSourceBuffers_.length = 0, 1 === e.sourceBuffers.length) { var t = e.sourceBuffers[0]; return t.appendAudioInitSegment_ = !0, t.audioDisabled_ = !t.audioCodec_, void e.activeSourceBuffers_.push(t) } for (var i = !1, n = !0, r = 0; r < e.player_.audioTracks().length; r++) { var a = e.player_.audioTracks()[r]; if (a.enabled && "main" !== a.kind) { i = !0, n = !1; break } } e.sourceBuffers.forEach((function (t, r) { if (t.appendAudioInitSegment_ = !0, t.videoCodec_ && t.audioCodec_) t.audioDisabled_ = i; else if (t.videoCodec_ && !t.audioCodec_) t.audioDisabled_ = !0, n = !1; else if (!t.videoCodec_ && t.audioCodec_ && (t.audioDisabled_ = r ? n : !n, t.audioDisabled_)) return; e.activeSourceBuffers_.push(t) })) }, e.onPlayerMediachange_ = function () { e.sourceBuffers.forEach((function (e) { e.appendAudioInitSegment_ = !0 })) }, e.onHlsReset_ = function () { e.sourceBuffers.forEach((function (e) { e.transmuxer_ && e.transmuxer_.postMessage({ action: "resetCaptions" }) })) }, e.onHlsSegmentTimeMapping_ = function (t) { e.sourceBuffers.forEach((function (e) { return e.timeMapping_ = t.mapping })) }, ["sourceopen", "sourceclose", "sourceended"].forEach((function (e) { this.nativeMediaSource_.addEventListener(e, this.trigger.bind(this)) }), e), e.on("sourceopen", (function (t) { var i = s.a.querySelector('[src="' + e.url_ + '"]'); i && (e.player_ = Br(i.parentNode), e.player_ && (e.player_.tech_.on("hls-reset", e.onHlsReset_), e.player_.tech_.on("hls-segment-time-mapping", e.onHlsSegmentTimeMapping_), e.player_.audioTracks && e.player_.audioTracks() && (e.player_.audioTracks().on("change", e.updateActiveSourceBuffers_), e.player_.audioTracks().on("addtrack", e.updateActiveSourceBuffers_), e.player_.audioTracks().on("removetrack", e.updateActiveSourceBuffers_)), e.player_.on("mediachange", e.onPlayerMediachange_))) })), e.on("sourceended", (function (t) { for (var i = Ua(e.duration), n = 0; n < e.sourceBuffers.length; n++) { var r = e.sourceBuffers[n], a = r.metadataTrack_ && r.metadataTrack_.cues; a && a.length && (a[a.length - 1].endTime = i) } })), e.on("sourceclose", (function (e) { this.sourceBuffers.forEach((function (e) { e.transmuxer_ && e.transmuxer_.terminate() })), this.sourceBuffers.length = 0, this.player_ && (this.player_.audioTracks && this.player_.audioTracks() && (this.player_.audioTracks().off("change", this.updateActiveSourceBuffers_), this.player_.audioTracks().off("addtrack", this.updateActiveSourceBuffers_), this.player_.audioTracks().off("removetrack", this.updateActiveSourceBuffers_)), this.player_.el_ && this.player_.off("mediachange", this.onPlayerMediachange_), this.player_.tech_ && this.player_.tech_.el_ && (this.player_.tech_.off("hls-reset", this.onHlsReset_), this.player_.tech_.off("hls-segment-time-mapping", this.onHlsSegmentTimeMapping_))) })), e } return Vr(t, e), qr(t, [{ key: "addSeekableRange_", value: function (e, t) { var i = void 0; if (this.duration !== 1 / 0) throw (i = new Error("MediaSource.addSeekableRange() can only be invoked when the duration is Infinity")).name = "InvalidStateError", i.code = 11, i; (t > this.nativeMediaSource_.duration || isNaN(this.nativeMediaSource_.duration)) && (this.nativeMediaSource_.duration = t) } }, { key: "addSourceBuffer", value: function (e) { var t = void 0, i = function (e) { var t = { type: "", parameters: {} }, i = e.trim().split(";"); return t.type = i.shift().trim(), i.forEach((function (e) { var i = e.trim().split("="); if (i.length > 1) { var n = i[0].replace(/"/g, "").trim(), r = i[1].replace(/"/g, "").trim(); t.parameters[n] = r } })), t }(e); if (/^(video|audio)\/mp2t$/i.test(i.type)) { var n = []; i.parameters && i.parameters.codecs && (n = i.parameters.codecs.split(","), n = (n = Ja(n)).filter((function (e) { return is(e) || ns(e) }))), 0 === n.length && (n = ["avc1.4d400d", "mp4a.40.2"]), t = new ss(this, n), 0 !== this.sourceBuffers.length && (this.sourceBuffers[0].createRealSourceBuffers_(), t.createRealSourceBuffers_(), this.sourceBuffers[0].audioDisabled_ = !0) } else t = this.nativeMediaSource_.addSourceBuffer(e); return this.sourceBuffers.push(t), t } }]), t }(Br.EventTarget), ls = 0; Br.mediaSources = {}; var us = function (e, t) { var i = Br.mediaSources[e]; if (!i) throw new Error("Media Source not found (Video.js)"); i.trigger({ type: "sourceopen", swfId: t }) }, cs = function () { return !!r.a.MediaSource && !!r.a.MediaSource.isTypeSupported && r.a.MediaSource.isTypeSupported('video/mp4;codecs="avc1.4d400d,mp4a.40.2"') }, hs = function () { if (this.MediaSource = { open: us, supportsNativeMediaSources: cs }, cs()) return new os; throw new Error("Cannot use create a virtual MediaSource for this video") }; hs.open = us, hs.supportsNativeMediaSources = cs; var ds = { createObjectURL: function (e) { var t = void 0; return e instanceof os ? (t = r.a.URL.createObjectURL(e.nativeMediaSource_), e.url_ = t, t) : e instanceof os ? (t = "blob:vjs-media-source/" + ls, ls++, Br.mediaSources[t] = e, t) : (t = r.a.URL.createObjectURL(e), e.url_ = t, t) } }; Br.MediaSource = hs, Br.URL = ds; var ps = Br.EventTarget, fs = Br.mergeOptions, ms = function (e, t) { for (var i = void 0, n = fs(e, { duration: t.duration, minimumUpdatePeriod: t.minimumUpdatePeriod }), r = 0; r < t.playlists.length; r++) { var a = $r(n, t.playlists[r]); a ? n = a : i = !0 } return Xr(t, (function (e, t, r, a) { if (e.playlists && e.playlists.length) { var s = e.playlists[0].uri, o = $r(n, e.playlists[0]); o && ((n = o).mediaGroups[t][r][a].playlists[0] = n.playlists[s], i = !1) } })), i ? null : n }, gs = function (e) { var t = e.byterange.offset + e.byterange.length - 1; return e.uri + "-" + e.byterange.offset + "-" + t }, vs = function (e, t) { var i, n, r = {}; for (var a in e) { var s = e[a].sidx; if (s) { var o = gs(s); if (!t[o]) break; var l = t[o].sidxInfo; i = l, n = s, (Boolean(!i.map && !n.map) || Boolean(i.map && n.map && i.map.byterange.offset === n.map.byterange.offset && i.map.byterange.length === n.map.byterange.length)) && i.uri === n.uri && i.byterange.offset === n.byterange.offset && i.byterange.length === n.byterange.length && (r[o] = t[o]) } } return r }, ys = function (e, t, i, n, r) { var a = { uri: Fr(n.handleManifestRedirects, e.resolvedUri), byterange: e.byterange, playlist: t }; return i(Br.mergeOptions(a, { responseType: "arraybuffer", headers: ba(a) }), r) }, _s = function (e) { function t(e, i) { var n = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : {}, r = arguments[3]; Hr(this, t); var a = Wr(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this)), s = n.withCredentials, o = void 0 !== s && s, l = n.handleManifestRedirects, u = void 0 !== l && l; if (a.hls_ = i, a.withCredentials = o, a.handleManifestRedirects = u, !e) throw new Error("A non-empty playlist URL or playlist is required"); return a.on("minimumUpdatePeriod", (function () { a.refreshXml_() })), a.on("mediaupdatetimeout", (function () { a.refreshMedia_(a.media().uri) })), a.state = "HAVE_NOTHING", a.loadedPlaylists_ = {}, "string" === typeof e ? (a.srcUrl = e, a.sidxMapping_ = {}, Wr(a)) : (a.setupChildLoader(r, e), a) } return Vr(t, e), qr(t, [{ key: "setupChildLoader", value: function (e, t) { this.masterPlaylistLoader_ = e, this.childPlaylist_ = t } }, { key: "dispose", value: function () { this.stopRequest(), this.loadedPlaylists_ = {}, r.a.clearTimeout(this.minimumUpdatePeriodTimeout_), r.a.clearTimeout(this.mediaRequest_), r.a.clearTimeout(this.mediaUpdateTimeout) } }, { key: "hasPendingRequest", value: function () { return this.request || this.mediaRequest_ } }, { key: "stopRequest", value: function () { if (this.request) { var e = this.request; this.request = null, e.onreadystatechange = null, e.abort() } } }, { key: "sidxRequestFinished_", value: function (e, t, i, n) { var r = this; return function (a, s) { if (r.request) { if (r.request = null, a) return r.error = { status: s.status, message: "DASH playlist request error at URL: " + e.uri, response: s.response, code: 2 }, i && (r.state = i), r.trigger("error"), n(t, null); var o = new Uint8Array(s.response), l = b.a.parseSidx(o.subarray(8)); return n(t, l) } } } }, { key: "media", value: function (e) { var t = this; if (!e) return this.media_; if ("HAVE_NOTHING" === this.state) throw new Error("Cannot switch media playlist from " + this.state); var i = this.state; if ("string" === typeof e) { if (!this.master.playlists[e]) throw new Error("Unknown playlist URI: " + e); e = this.master.playlists[e] } var n = !this.media_ || e.uri !== this.media_.uri; if (n && this.loadedPlaylists_[e.uri] && this.loadedPlaylists_[e.uri].endList) return this.state = "HAVE_METADATA", this.media_ = e, void (n && (this.trigger("mediachanging"), this.trigger("mediachange"))); if (n) if (this.media_ && this.trigger("mediachanging"), e.sidx) { var a = void 0, s = void 0; this.masterPlaylistLoader_ ? (a = this.masterPlaylistLoader_.master, s = this.masterPlaylistLoader_.sidxMapping_) : (a = this.master, s = this.sidxMapping_); var o = gs(e.sidx); s[o] = { sidxInfo: e.sidx }, this.request = ys(e.sidx, e, this.hls_.xhr, { handleManifestRedirects: this.handleManifestRedirects }, this.sidxRequestFinished_(e, a, i, (function (n, r) { if (!n || !r) throw new Error("failed to request sidx"); s[o].sidx = r, t.haveMetadata({ startingState: i, playlist: n.playlists[e.uri] }) }))) } else this.mediaRequest_ = r.a.setTimeout(this.haveMetadata.bind(this, { startingState: i, playlist: e }), 0) } }, { key: "haveMetadata", value: function (e) { var t = e.startingState, i = e.playlist; this.state = "HAVE_METADATA", this.loadedPlaylists_[i.uri] = i, this.mediaRequest_ = null, this.refreshMedia_(i.uri), "HAVE_MASTER" === t ? this.trigger("loadedmetadata") : this.trigger("mediachange") } }, { key: "pause", value: function () { this.stopRequest(), r.a.clearTimeout(this.mediaUpdateTimeout), r.a.clearTimeout(this.minimumUpdatePeriodTimeout_), "HAVE_NOTHING" === this.state && (this.started = !1) } }, { key: "load", value: function (e) { var t = this; r.a.clearTimeout(this.mediaUpdateTimeout), r.a.clearTimeout(this.minimumUpdatePeriodTimeout_); var i = this.media(); if (e) { var n = i ? i.targetDuration / 2 * 1e3 : 5e3; this.mediaUpdateTimeout = r.a.setTimeout((function () { return t.load() }), n) } else this.started ? this.trigger("loadedplaylist") : this.start() } }, { key: "parseMasterXml", value: function () { var e = Object(y.a)(this.masterXml_, { manifestUri: this.srcUrl, clientOffset: this.clientOffset_, sidxMapping: this.sidxMapping_ }); e.uri = this.srcUrl; for (var t = 0; t < e.playlists.length; t++) { var i = "placeholder-uri-" + t; e.playlists[t].uri = i, e.playlists[i] = e.playlists[t] } return Xr(e, (function (t, i, n, r) { if (t.playlists && t.playlists.length) { var a = "placeholder-uri-" + i + "-" + n + "-" + r; t.playlists[0].uri = a, e.playlists[a] = t.playlists[0] } })), Qr(e), Jr(e), e } }, { key: "start", value: function () { var e = this; this.started = !0, this.masterPlaylistLoader_ ? this.mediaRequest_ = r.a.setTimeout(this.haveMaster_.bind(this), 0) : this.request = this.hls_.xhr({ uri: this.srcUrl, withCredentials: this.withCredentials }, (function (t, i) { if (e.request) { if (e.request = null, t) return e.error = { status: i.status, message: "DASH playlist request error at URL: " + e.srcUrl, responseText: i.responseText, code: 2 }, "HAVE_NOTHING" === e.state && (e.started = !1), e.trigger("error"); e.masterXml_ = i.responseText, i.responseHeaders && i.responseHeaders.date ? e.masterLoaded_ = Date.parse(i.responseHeaders.date) : e.masterLoaded_ = Date.now(), e.srcUrl = Fr(e.handleManifestRedirects, e.srcUrl, i), e.syncClientServerClock_(e.onClientServerClockSync_.bind(e)) } })) } }, { key: "syncClientServerClock_", value: function (e) { var t = this, i = Object(y.b)(this.masterXml_); return null === i ? (this.clientOffset_ = this.masterLoaded_ - Date.now(), e()) : "DIRECT" === i.method ? (this.clientOffset_ = i.value - Date.now(), e()) : void (this.request = this.hls_.xhr({ uri: Nr(this.srcUrl, i.value), method: i.method, withCredentials: this.withCredentials }, (function (n, r) { if (t.request) { if (n) return t.clientOffset_ = t.masterLoaded_ - Date.now(), e(); var a = void 0; a = "HEAD" === i.method ? r.responseHeaders && r.responseHeaders.date ? Date.parse(r.responseHeaders.date) : t.masterLoaded_ : Date.parse(r.responseText), t.clientOffset_ = a - Date.now(), e() } }))) } }, { key: "haveMaster_", value: function () { this.state = "HAVE_MASTER", this.mediaRequest_ = null, this.masterPlaylistLoader_ ? this.media_ || this.media(this.childPlaylist_) : (this.master = this.parseMasterXml(), this.trigger("loadedplaylist")) } }, { key: "onClientServerClockSync_", value: function () { var e = this; this.haveMaster_(), this.hasPendingRequest() || this.media_ || this.media(this.master.playlists[0]), this.master && this.master.minimumUpdatePeriod && (this.minimumUpdatePeriodTimeout_ = r.a.setTimeout((function () { e.trigger("minimumUpdatePeriod") }), this.master.minimumUpdatePeriod)) } }, { key: "refreshXml_", value: function () { var e = this; this.request = this.hls_.xhr({ uri: this.srcUrl, withCredentials: this.withCredentials }, (function (t, i) { if (e.request) { if (e.request = null, t) return e.error = { status: i.status, message: "DASH playlist request error at URL: " + e.srcUrl, responseText: i.responseText, code: 2 }, "HAVE_NOTHING" === e.state && (e.started = !1), e.trigger("error"); e.masterXml_ = i.responseText, e.sidxMapping_ = function (e, t, i, n) { var r = Object(y.a)(e, { manifestUri: t, clientOffset: i }), a = vs(r.playlists, n); return Xr(r, (function (e, t, i, r) { if (e.playlists && e.playlists.length) { var s = e.playlists; a = fs(a, vs(s, n)) } })), a }(e.masterXml_, e.srcUrl, e.clientOffset_, e.sidxMapping_); var n = e.parseMasterXml(), a = ms(e.master, n), s = e.media().sidx; if (a) if (s) { var o = gs(s); if (!e.sidxMapping_[o]) { var l = e.media(); e.request = ys(l.sidx, l, e.hls_.xhr, { handleManifestRedirects: e.handleManifestRedirects }, e.sidxRequestFinished_(l, n, e.state, (function (t, i) { if (!t || !i) throw new Error("failed to request sidx on minimumUpdatePeriod"); e.sidxMapping_[o].sidx = i, e.minimumUpdatePeriodTimeout_ = r.a.setTimeout((function () { e.trigger("minimumUpdatePeriod") }), e.master.minimumUpdatePeriod), e.refreshMedia_(e.media().uri) }))) } } else e.master = a; e.minimumUpdatePeriodTimeout_ = r.a.setTimeout((function () { e.trigger("minimumUpdatePeriod") }), e.master.minimumUpdatePeriod) } })) } }, { key: "refreshMedia_", value: function (e) { var t = this; if (!e) throw new Error("refreshMedia_ must take a media uri"); var i = void 0, n = void 0; this.masterPlaylistLoader_ ? (i = this.masterPlaylistLoader_.master, n = this.masterPlaylistLoader_.parseMasterXml()) : (i = this.master, n = this.parseMasterXml()); var a = ms(i, n); a ? (this.masterPlaylistLoader_ ? this.masterPlaylistLoader_.master = a : this.master = a, this.media_ = a.playlists[e]) : (this.media_ = n.playlists[e], this.trigger("playlistunchanged")), this.media().endList || (this.mediaUpdateTimeout = r.a.setTimeout((function () { t.trigger("mediaupdatetimeout") }), Zr(this.media(), !!a))), this.trigger("loadedplaylist") } }]), t }(ps), bs = function (e) { return Br.log.debug ? Br.log.debug.bind(Br, "VHS:", e + " >") : function () { } }; function Ts() { } var ks = function () { function e(t, i, n, r) { Hr(this, e), this.callbacks_ = [], this.pendingCallback_ = null, this.timestampOffset_ = 0, this.mediaSource = t, this.processedAppend_ = !1, this.type_ = n, this.mimeType_ = i, this.logger_ = bs("SourceUpdater[" + n + "][" + i + "]"), "closed" === t.readyState ? t.addEventListener("sourceopen", this.createSourceBuffer_.bind(this, i, r)) : this.createSourceBuffer_(i, r) } return qr(e, [{ key: "createSourceBuffer_", value: function (e, t) { var i = this; this.sourceBuffer_ = this.mediaSource.addSourceBuffer(e), this.logger_("created SourceBuffer"), t && (t.trigger("sourcebufferadded"), this.mediaSource.sourceBuffers.length < 2) ? t.on("sourcebufferadded", (function () { i.start_() })) : this.start_() } }, { key: "start_", value: function () { var e = this; this.started_ = !0, this.onUpdateendCallback_ = function () { var t = e.pendingCallback_; e.pendingCallback_ = null, e.sourceBuffer_.removing = !1, e.logger_("buffered [" + Ma(e.buffered()) + "]"), t && t(), e.runCallback_() }, this.sourceBuffer_.addEventListener("updateend", this.onUpdateendCallback_), this.runCallback_() } }, { key: "abort", value: function (e) { var t = this; this.processedAppend_ && this.queueCallback_((function () { t.sourceBuffer_.abort() }), e) } }, { key: "appendBuffer", value: function (e, t) { var i = this; this.processedAppend_ = !0, this.queueCallback_((function () { e.videoSegmentTimingInfoCallback && i.sourceBuffer_.addEventListener("videoSegmentTimingInfo", e.videoSegmentTimingInfoCallback), i.sourceBuffer_.appendBuffer(e.bytes) }), (function () { e.videoSegmentTimingInfoCallback && i.sourceBuffer_.removeEventListener("videoSegmentTimingInfo", e.videoSegmentTimingInfoCallback), t() })) } }, { key: "buffered", value: function () { return this.sourceBuffer_ ? this.sourceBuffer_.buffered : Br.createTimeRanges() } }, { key: "remove", value: function (e, t) { var i = this, n = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : Ts; this.processedAppend_ && this.queueCallback_((function () { i.logger_("remove [" + e + " => " + t + "]"), i.sourceBuffer_.removing = !0, i.sourceBuffer_.remove(e, t) }), n) } }, { key: "updating", value: function () { return !this.sourceBuffer_ || this.sourceBuffer_.updating || !!this.pendingCallback_ && this.pendingCallback_ !== Ts } }, { key: "timestampOffset", value: function (e) { var t = this; return "undefined" !== typeof e && (this.queueCallback_((function () { t.sourceBuffer_.timestampOffset = e, t.runCallback_() })), this.timestampOffset_ = e), this.timestampOffset_ } }, { key: "queueCallback_", value: function (e, t) { this.callbacks_.push([e.bind(this), t]), this.runCallback_() } }, { key: "runCallback_", value: function () { var e = void 0; !this.updating() && this.callbacks_.length && this.started_ && (e = this.callbacks_.shift(), this.pendingCallback_ = e[1], e[0]()) } }, { key: "dispose", value: function () { var e = this, t = function t() { e.sourceBuffer_ && "open" === e.mediaSource.readyState && e.sourceBuffer_.abort(), e.sourceBuffer_.removeEventListener("updateend", t) }; this.sourceBuffer_.removeEventListener("updateend", this.onUpdateendCallback_), this.sourceBuffer_.removing ? this.sourceBuffer_.addEventListener("updateend", t) : t() } }]), e }(), Ss = { GOAL_BUFFER_LENGTH: 30, MAX_GOAL_BUFFER_LENGTH: 60, GOAL_BUFFER_LENGTH_RATE: 1, INITIAL_BANDWIDTH: 4194304, BANDWIDTH_VARIANCE: 1.2, BUFFER_LOW_WATER_LINE: 0, MAX_BUFFER_LOW_WATER_LINE: 30, BUFFER_LOW_WATER_LINE_RATE: 1 }, Cs = 2, Es = -101, ws = -102, Ps = function (e) { e.forEach((function (e) { e.abort() })) }, Ls = function (e, t) { return t.timedout ? { status: t.status, message: "HLS request timed-out at URL: " + t.uri, code: Es, xhr: t } : t.aborted ? { status: t.status, message: "HLS request aborted at URL: " + t.uri, code: ws, xhr: t } : e ? { status: t.status, message: "HLS request errored at URL: " + t.uri, code: Cs, xhr: t } : null }, As = function (e, t, i) { var n = 0, r = !1; return function (a, s) { if (!r) return a ? (r = !0, Ps(e), i(a, s)) : (n += 1) === e.length ? (s.endOfAllRequests = Date.now(), s.encryptedBytes ? function (e, t, i) { e.addEventListener("message", (function n(r) { if (r.data.source === t.requestId) { e.removeEventListener("message", n); var a = r.data.decrypted; return t.bytes = new Uint8Array(a.bytes, a.byteOffset, a.byteLength), i(null, t) } })); var n = void 0; n = t.key.bytes.slice ? t.key.bytes.slice() : new Uint32Array(Array.prototype.slice.call(t.key.bytes)), e.postMessage(Ca({ source: t.requestId, encrypted: t.encryptedBytes, key: n, iv: t.key.iv }), [t.encryptedBytes.buffer, n.buffer]) }(t, s, i) : i(null, s)) : void 0 } }, Is = function (e, t) { return function (i) { return e.stats = Br.mergeOptions(e.stats, function (e) { var t = e.target, i = { bandwidth: 1 / 0, bytesReceived: 0, roundTripTime: Date.now() - t.requestTime || 0 }; return i.bytesReceived = e.loaded, i.bandwidth = Math.floor(i.bytesReceived / i.roundTripTime * 8 * 1e3), i }(i)), !e.stats.firstBytesReceivedAt && e.stats.bytesReceived && (e.stats.firstBytesReceivedAt = Date.now()), t(i, e) } }, xs = function (e, t, i, n, r, a, s) { var o = [], l = As(o, i, s); if (r.key && !r.key.bytes) { var u = e(Br.mergeOptions(t, { uri: r.key.resolvedUri, responseType: "arraybuffer" }), function (e, t) { return function (i, n) { var r = n.response, a = Ls(i, n); if (a) return t(a, e); if (16 !== r.byteLength) return t({ status: n.status, message: "Invalid HLS key at URL: " + n.uri, code: Cs, xhr: n }, e); var s = new DataView(r); return e.key.bytes = new Uint32Array([s.getUint32(0), s.getUint32(4), s.getUint32(8), s.getUint32(12)]), t(null, e) } }(r, l)); o.push(u) } if (r.map && !r.map.bytes) { var c = e(Br.mergeOptions(t, { uri: r.map.resolvedUri, responseType: "arraybuffer", headers: ba(r.map) }), function (e, t, i) { return function (n, r) { var a = r.response, s = Ls(n, r); return s ? i(s, e) : 0 === a.byteLength ? i({ status: r.status, message: "Empty HLS segment content at URL: " + r.uri, code: Cs, xhr: r }, e) : (e.map.bytes = new Uint8Array(r.response), t && !t.isInitialized() && t.init(), e.map.timescales = k.a.timescale(e.map.bytes), e.map.videoTrackIds = k.a.videoTrackIds(e.map.bytes), i(null, e)) } }(r, n, l)); o.push(c) } var h = e(Br.mergeOptions(t, { uri: r.resolvedUri, responseType: "arraybuffer", headers: ba(r) }), function (e, t, i) { return function (n, r) { var a = r.response, s = Ls(n, r), o = void 0; return s ? i(s, e) : 0 === a.byteLength ? i({ status: r.status, message: "Empty HLS segment content at URL: " + r.uri, code: Cs, xhr: r }, e) : (e.stats = function (e) { return { bandwidth: e.bandwidth, bytesReceived: e.bytesReceived || 0, roundTripTime: e.roundTripTime || 0 } }(r), e.key ? e.encryptedBytes = new Uint8Array(r.response) : e.bytes = new Uint8Array(r.response), t && e.map && e.map.bytes && (t.isInitialized() || t.init(), (o = t.parse(e.bytes, e.map.videoTrackIds, e.map.timescales)) && o.captions && (e.captionStreams = o.captionStreams, e.fmp4Captions = o.captions)), i(null, e)) } }(r, n, l)); return h.addEventListener("progress", Is(r, a)), o.push(h), function () { return Ps(o) } }, Os = function (e, t) { var i; return e && (i = r.a.getComputedStyle(e)) ? i[t] : "" }, Ds = function (e, t) { var i = e.slice(); e.sort((function (e, n) { var r = t(e, n); return 0 === r ? i.indexOf(e) - i.indexOf(n) : r })) }, Ms = function (e, t) { var i = void 0, n = void 0; return e.attributes.BANDWIDTH && (i = e.attributes.BANDWIDTH), i = i || r.a.Number.MAX_VALUE, t.attributes.BANDWIDTH && (n = t.attributes.BANDWIDTH), i - (n = n || r.a.Number.MAX_VALUE) }, Rs = function (e, t, i) { if (!e || !t) return !1; var n = i === e.segments.length; return e.endList && "open" === t.readyState && n }, Bs = function (e) { return "number" === typeof e && isFinite(e) }, Us = function (e) { function t(e) { Hr(this, t); var i = Wr(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this)); if (!e) throw new TypeError("Initialization settings are required"); if ("function" !== typeof e.currentTime) throw new TypeError("No currentTime getter specified"); if (!e.mediaSource) throw new TypeError("No MediaSource specified"); return i.bandwidth = e.bandwidth, i.throughput = { rate: 0, count: 0 }, i.roundTrip = NaN, i.resetStats_(), i.mediaIndex = null, i.hasPlayed_ = e.hasPlayed, i.currentTime_ = e.currentTime, i.seekable_ = e.seekable, i.seeking_ = e.seeking, i.duration_ = e.duration, i.mediaSource_ = e.mediaSource, i.hls_ = e.hls, i.loaderType_ = e.loaderType, i.startingMedia_ = void 0, i.segmentMetadataTrack_ = e.segmentMetadataTrack, i.goalBufferLength_ = e.goalBufferLength, i.sourceType_ = e.sourceType, i.inbandTextTracks_ = e.inbandTextTracks, i.state_ = "INIT", i.checkBufferTimeout_ = null, i.error_ = void 0, i.currentTimeline_ = -1, i.pendingSegment_ = null, i.mimeType_ = null, i.sourceUpdater_ = null, i.xhrOptions_ = null, i.activeInitSegmentId_ = null, i.initSegments_ = {}, i.cacheEncryptionKeys_ = e.cacheEncryptionKeys, i.keyCache_ = {}, "main" === i.loaderType_ ? i.captionParser_ = new C.a : i.captionParser_ = null, i.decrypter_ = e.decrypter, i.syncController_ = e.syncController, i.syncPoint_ = { segmentIndex: 0, time: 0 }, i.syncController_.on("syncinfoupdate", (function () { return i.trigger("syncinfoupdate") })), i.mediaSource_.addEventListener("sourceopen", (function () { return i.ended_ = !1 })), i.fetchAtBuffer_ = !1, i.logger_ = bs("SegmentLoader[" + i.loaderType_ + "]"), Object.defineProperty(i, "state", { get: function () { return this.state_ }, set: function (e) { e !== this.state_ && (this.logger_(this.state_ + " -> " + e), this.state_ = e) } }), i } return Vr(t, e), qr(t, [{ key: "resetStats_", value: function () { this.mediaBytesTransferred = 0, this.mediaRequests = 0, this.mediaRequestsAborted = 0, this.mediaRequestsTimedout = 0, this.mediaRequestsErrored = 0, this.mediaTransferDuration = 0, this.mediaSecondsLoaded = 0 } }, { key: "dispose", value: function () { this.state = "DISPOSED", this.pause(), this.abort_(), this.sourceUpdater_ && this.sourceUpdater_.dispose(), this.resetStats_(), this.captionParser_ && this.captionParser_.reset() } }, { key: "abort", value: function () { "WAITING" === this.state ? (this.abort_(), this.state = "READY", this.paused() || this.monitorBuffer_()) : this.pendingSegment_ && (this.pendingSegment_ = null) } }, { key: "abort_", value: function () { this.pendingSegment_ && this.pendingSegment_.abortRequests(), this.pendingSegment_ = null } }, { key: "error", value: function (e) { return "undefined" !== typeof e && (this.error_ = e), this.pendingSegment_ = null, this.error_ } }, { key: "endOfStream", value: function () { this.ended_ = !0, this.pause(), this.trigger("ended") } }, { key: "buffered_", value: function () { return this.sourceUpdater_ ? this.sourceUpdater_.buffered() : Br.createTimeRanges() } }, { key: "initSegment", value: function (e) { var t = arguments.length > 1 && void 0 !== arguments[1] && arguments[1]; if (!e) return null; var i = Ea(e), n = this.initSegments_[i]; return t && !n && e.bytes && (this.initSegments_[i] = n = { resolvedUri: e.resolvedUri, byterange: e.byterange, bytes: e.bytes, timescales: e.timescales, videoTrackIds: e.videoTrackIds }), n || e } }, { key: "segmentKey", value: function (e) { var t = arguments.length > 1 && void 0 !== arguments[1] && arguments[1]; if (!e) return null; var i = wa(e), n = this.keyCache_[i]; this.cacheEncryptionKeys_ && t && !n && e.bytes && (this.keyCache_[i] = n = { resolvedUri: e.resolvedUri, bytes: e.bytes }); var r = { resolvedUri: (n || e).resolvedUri }; return n && (r.bytes = n.bytes), r } }, { key: "couldBeginLoading_", value: function () { return this.playlist_ && (this.sourceUpdater_ || this.mimeType_ && "INIT" === this.state) && !this.paused() } }, { key: "load", value: function () { if (this.monitorBuffer_(), this.playlist_) { if (this.syncController_.setDateTimeMapping(this.playlist_), "INIT" === this.state && this.couldBeginLoading_()) return this.init_(); !this.couldBeginLoading_() || "READY" !== this.state && "INIT" !== this.state || (this.state = "READY") } } }, { key: "init_", value: function () { return this.state = "READY", this.sourceUpdater_ = new ks(this.mediaSource_, this.mimeType_, this.loaderType_, this.sourceBufferEmitter_), this.resetEverything(), this.monitorBuffer_() } }, { key: "playlist", value: function (e) { var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {}; if (e) { var i = this.playlist_, n = this.pendingSegment_; this.playlist_ = e, this.xhrOptions_ = t, this.hasPlayed_() || (e.syncInfo = { mediaSequence: e.mediaSequence, time: 0 }); var r = null; if (i && (i.id ? r = i.id : i.uri && (r = i.uri)), this.logger_("playlist update [" + r + " => " + (e.id || e.uri) + "]"), this.trigger("syncinfoupdate"), "INIT" === this.state && this.couldBeginLoading_()) return this.init_(); if (i && i.uri === e.uri) { var a = e.mediaSequence - i.mediaSequence; this.logger_("live window shift [" + a + "]"), null !== this.mediaIndex && (this.mediaIndex -= a), n && (n.mediaIndex -= a, n.mediaIndex >= 0 && (n.segment = e.segments[n.mediaIndex])), this.syncController_.saveExpiredSegmentInfo(i, e) } else null !== this.mediaIndex && this.resyncLoader() } } }, { key: "pause", value: function () { this.checkBufferTimeout_ && (r.a.clearTimeout(this.checkBufferTimeout_), this.checkBufferTimeout_ = null) } }, { key: "paused", value: function () { return null === this.checkBufferTimeout_ } }, { key: "mimeType", value: function (e, t) { this.mimeType_ || (this.mimeType_ = e, this.sourceBufferEmitter_ = t, "INIT" === this.state && this.couldBeginLoading_() && this.init_()) } }, { key: "resetEverything", value: function (e) { this.ended_ = !1, this.resetLoader(), this.remove(0, this.duration_(), e), this.captionParser_ && this.captionParser_.clearAllCaptions(), this.trigger("reseteverything") } }, { key: "resetLoader", value: function () { this.fetchAtBuffer_ = !1, this.resyncLoader() } }, { key: "resyncLoader", value: function () { this.mediaIndex = null, this.syncPoint_ = null, this.abort() } }, { key: "remove", value: function (e, t, i) { if (this.sourceUpdater_ && this.sourceUpdater_.remove(e, t, i), Ba(e, t, this.segmentMetadataTrack_), this.inbandTextTracks_) for (var n in this.inbandTextTracks_) Ba(e, t, this.inbandTextTracks_[n]) } }, { key: "monitorBuffer_", value: function () { this.checkBufferTimeout_ && r.a.clearTimeout(this.checkBufferTimeout_), this.checkBufferTimeout_ = r.a.setTimeout(this.monitorBufferTick_.bind(this), 1) } }, { key: "monitorBufferTick_", value: function () { "READY" === this.state && this.fillBuffer_(), this.checkBufferTimeout_ && r.a.clearTimeout(this.checkBufferTimeout_), this.checkBufferTimeout_ = r.a.setTimeout(this.monitorBufferTick_.bind(this), 500) } }, { key: "fillBuffer_", value: function () { if (!this.sourceUpdater_.updating()) { this.syncPoint_ || (this.syncPoint_ = this.syncController_.getSyncPoint(this.playlist_, this.duration_(), this.currentTimeline_, this.currentTime_())); var e = this.checkBuffer_(this.buffered_(), this.playlist_, this.mediaIndex, this.hasPlayed_(), this.currentTime_(), this.syncPoint_); e && (this.isEndOfStream_(e.mediaIndex) ? this.endOfStream() : (e.mediaIndex !== this.playlist_.segments.length - 1 || "ended" !== this.mediaSource_.readyState || this.seeking_()) && (e.timeline !== this.currentTimeline_ && (this.syncController_.reset(), e.timestampOffset = e.startOfSegment, this.captionParser_ && this.captionParser_.clearAllCaptions()), this.loadSegment_(e))) } } }, { key: "isEndOfStream_", value: function (e) { var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : this.playlist_; return Rs(t, this.mediaSource_, e) && !this.sourceUpdater_.updating() } }, { key: "checkBuffer_", value: function (e, t, i, n, r, a) { var s = 0, o = void 0; e.length && (s = e.end(e.length - 1)); var l = Math.max(0, s - r); if (!t.segments.length) return null; if (l >= this.goalBufferLength_()) return null; if (!n && l >= 1) return null; if (null === a) return i = this.getSyncSegmentCandidate_(t), this.generateSegmentInfo_(t, i, null, !0); if (null !== i) { t.segments[i]; return o = s, this.generateSegmentInfo_(t, i + 1, o, !1) } if (this.fetchAtBuffer_) { var u = ga.getMediaInfoForTime(t, s, a.segmentIndex, a.time); i = u.mediaIndex, o = u.startTime } else { var c = ga.getMediaInfoForTime(t, r, a.segmentIndex, a.time); i = c.mediaIndex, o = c.startTime } return this.generateSegmentInfo_(t, i, o, !1) } }, { key: "getSyncSegmentCandidate_", value: function (e) { var t = this; if (-1 === this.currentTimeline_) return 0; var i = e.segments.map((function (e, t) { return { timeline: e.timeline, segmentIndex: t } })).filter((function (e) { return e.timeline === t.currentTimeline_ })); return i.length ? i[Math.min(i.length - 1, 1)].segmentIndex : Math.max(e.segments.length - 1, 0) } }, { key: "generateSegmentInfo_", value: function (e, t, i, n) { if (t < 0 || t >= e.segments.length) return null; var r = e.segments[t]; return { requestId: "segment-loader-" + Math.random(), uri: r.resolvedUri, mediaIndex: t, isSyncRequest: n, startOfSegment: i, playlist: e, bytes: null, encryptedBytes: null, timestampOffset: null, timeline: r.timeline, duration: r.duration, segment: r } } }, { key: "abortRequestEarly_", value: function (e) { if (this.hls_.tech_.paused() || !this.xhrOptions_.timeout || !this.playlist_.attributes.BANDWIDTH) return !1; if (Date.now() - (e.firstBytesReceivedAt || Date.now()) < 1e3) return !1; var t = this.currentTime_(), i = e.bandwidth, n = this.pendingSegment_.duration, r = ga.estimateSegmentRequestTime(n, i, this.playlist_, e.bytesReceived), a = function (e, t) { var i = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : 1, n = e.length ? e.end(e.length - 1) : 0; return (n - t) / i }(this.buffered_(), t, this.hls_.tech_.playbackRate()) - 1; if (r <= a) return !1; var s = function (e) { var t = e.master, i = e.currentTime, n = e.bandwidth, r = e.duration, a = e.segmentDuration, s = e.timeUntilRebuffer, o = e.currentTimeline, l = e.syncController, u = t.playlists.filter((function (e) { return !ga.isIncompatible(e) })), c = u.filter(ga.isEnabled); c.length || (c = u.filter((function (e) { return !ga.isDisabled(e) }))); var h = c.filter(ga.hasAttribute.bind(null, "BANDWIDTH")).map((function (e) { var t = l.getSyncPoint(e, r, o, i) ? 1 : 2; return { playlist: e, rebufferingImpact: ga.estimateSegmentRequestTime(a, n, e) * t - s } })), d = h.filter((function (e) { return e.rebufferingImpact <= 0 })); return Ds(d, (function (e, t) { return Ms(t.playlist, e.playlist) })), d.length ? d[0] : (Ds(h, (function (e, t) { return e.rebufferingImpact - t.rebufferingImpact })), h[0] || null) }({ master: this.hls_.playlists.master, currentTime: t, bandwidth: i, duration: this.duration_(), segmentDuration: n, timeUntilRebuffer: a, currentTimeline: this.currentTimeline_, syncController: this.syncController_ }); if (s) { var o = r - a - s.rebufferingImpact, l = .5; return a <= 1 / 30 && (l = 1), !s.playlist || s.playlist.uri === this.playlist_.uri || o < l ? !1 : (this.bandwidth = s.playlist.attributes.BANDWIDTH * Ss.BANDWIDTH_VARIANCE + 1, this.abort(), this.trigger("earlyabort"), !0) } } }, { key: "handleProgress_", value: function (e, t) { this.pendingSegment_ && t.requestId === this.pendingSegment_.requestId && !this.abortRequestEarly_(t.stats) && this.trigger("progress") } }, { key: "loadSegment_", value: function (e) { this.state = "WAITING", this.pendingSegment_ = e, this.trimBackBuffer_(e), e.abortRequests = xs(this.hls_.xhr, this.xhrOptions_, this.decrypter_, this.captionParser_, this.createSimplifiedSegmentObj_(e), this.handleProgress_.bind(this), this.segmentRequestFinished_.bind(this)) } }, { key: "trimBackBuffer_", value: function (e) { var t = function (e, t, i) { var n = void 0; return n = e.length && e.start(0) > 0 && e.start(0) < t ? e.start(0) : t - 30, Math.min(n, t - i) }(this.seekable_(), this.currentTime_(), this.playlist_.targetDuration || 10); t > 0 && this.remove(0, t) } }, { key: "createSimplifiedSegmentObj_", value: function (e) { var t = e.segment, i = { resolvedUri: t.resolvedUri, byterange: t.byterange, requestId: e.requestId }; if (t.key) { var n = t.key.iv || new Uint32Array([0, 0, 0, e.mediaIndex + e.playlist.mediaSequence]); i.key = this.segmentKey(t.key), i.key.iv = n } return t.map && (i.map = this.initSegment(t.map)), i } }, { key: "segmentRequestFinished_", value: function (e, t) { if (this.mediaRequests += 1, t.stats && (this.mediaBytesTransferred += t.stats.bytesReceived, this.mediaTransferDuration += t.stats.roundTripTime), this.pendingSegment_) { if (t.requestId === this.pendingSegment_.requestId) { if (e) return this.pendingSegment_ = null, this.state = "READY", e.code === ws ? void (this.mediaRequestsAborted += 1) : (this.pause(), e.code === Es ? (this.mediaRequestsTimedout += 1, this.bandwidth = 1, this.roundTrip = NaN, void this.trigger("bandwidthupdate")) : (this.mediaRequestsErrored += 1, this.error(e), void this.trigger("error"))); this.bandwidth = t.stats.bandwidth, this.roundTrip = t.stats.roundTripTime, t.map && (t.map = this.initSegment(t.map, !0)), t.key && this.segmentKey(t.key, !0), this.processSegmentResponse_(t) } } else this.mediaRequestsAborted += 1 } }, { key: "processSegmentResponse_", value: function (e) { var t = this.pendingSegment_; t.bytes = e.bytes, e.map && (t.segment.map.bytes = e.map.bytes), t.endOfAllRequests = e.endOfAllRequests, e.fmp4Captions && (!function (e, t, i) { for (var n in i) if (!e[n]) { t.trigger({ type: "usage", name: "hls-608" }); var r = t.textTracks().getTrackById(n); e[n] = r || t.addRemoteTextTrack({ kind: "captions", id: n, label: n }, !1).track } }(this.inbandTextTracks_, this.hls_.tech_, e.captionStreams), function (e) { var t = e.inbandTextTracks, i = e.captionArray, n = e.timestampOffset; if (i) { var r = window.WebKitDataCue || window.VTTCue; i.forEach((function (e) { var i = e.stream, a = e.startTime, s = e.endTime; t[i] && (a += n, s += n, t[i].addCue(new r(a, s, e.text))) })) } }({ inbandTextTracks: this.inbandTextTracks_, captionArray: e.fmp4Captions, timestampOffset: 0 }), this.captionParser_ && this.captionParser_.clearParsedCaptions()), this.handleSegment_() } }, { key: "handleSegment_", value: function () { var e = this; if (this.pendingSegment_) { var t = this.pendingSegment_, i = t.segment, n = this.syncController_.probeSegmentInfo(t); "undefined" === typeof this.startingMedia_ && n && (n.containsAudio || n.containsVideo) && (this.startingMedia_ = { containsAudio: n.containsAudio, containsVideo: n.containsVideo }); var r, a, s, o = (r = this.loaderType_, a = this.startingMedia_, s = n, "main" === r && a && s ? s.containsAudio || s.containsVideo ? a.containsVideo && !s.containsVideo ? "Only audio found in segment when we expected video. We can't switch to audio only from a stream that had video. To get rid of this message, please add codec information to the manifest." : !a.containsVideo && s.containsVideo ? "Video found in segment when we expected only audio. We can't switch to a stream with video from an audio only stream. To get rid of this message, please add codec information to the manifest." : null : "Neither audio nor video found in segment." : null); if (o) return this.error({ message: o, blacklistDuration: 1 / 0 }), void this.trigger("error"); if (t.isSyncRequest) return this.trigger("syncinfoupdate"), this.pendingSegment_ = null, void (this.state = "READY"); if (null !== t.timestampOffset && t.timestampOffset !== this.sourceUpdater_.timestampOffset()) { if (n && n.segmentTimestampInfo) { var l = n.segmentTimestampInfo[0].ptsTime, u = n.segmentTimestampInfo[0].dtsTime; t.timestampOffset -= l - u } this.sourceUpdater_.timestampOffset(t.timestampOffset), this.trigger("timestampoffset") } var c = this.syncController_.mappingForTimeline(t.timeline); if (null !== c && this.trigger({ type: "segmenttimemapping", mapping: c }), this.state = "APPENDING", i.map) { var h = Ea(i.map); if (!this.activeInitSegmentId_ || this.activeInitSegmentId_ !== h) { var d = this.initSegment(i.map); this.sourceUpdater_.appendBuffer({ bytes: d.bytes }, (function () { e.activeInitSegmentId_ = h })) } } t.byteLength = t.bytes.byteLength, "number" === typeof i.start && "number" === typeof i.end ? this.mediaSecondsLoaded += i.end - i.start : this.mediaSecondsLoaded += i.duration, this.logger_(function (e) { var t = e.segment, i = t.start, n = t.end, r = e.playlist, a = r.mediaSequence, s = r.id, o = r.segments, l = void 0 === o ? [] : o, u = e.mediaIndex, c = e.timeline; return ["appending [" + u + "] of [" + a + ", " + (a + l.length) + "] from playlist [" + s + "]", "[" + i + " => " + n + "] in timeline [" + c + "]"].join(" ") }(t)), this.sourceUpdater_.appendBuffer({ bytes: t.bytes, videoSegmentTimingInfoCallback: this.handleVideoSegmentTimingInfo_.bind(this, t.requestId) }, this.handleUpdateEnd_.bind(this)) } else this.state = "READY" } }, { key: "handleVideoSegmentTimingInfo_", value: function (e, t) { if (this.pendingSegment_ && e === this.pendingSegment_.requestId) { var i = this.pendingSegment_.segment; i.videoTimingInfo || (i.videoTimingInfo = {}), i.videoTimingInfo.transmuxerPrependedSeconds = t.videoSegmentTimingInfo.prependedContentDuration || 0, i.videoTimingInfo.transmuxedPresentationStart = t.videoSegmentTimingInfo.start.presentation, i.videoTimingInfo.transmuxedPresentationEnd = t.videoSegmentTimingInfo.end.presentation, i.videoTimingInfo.baseMediaDecodeTime = t.videoSegmentTimingInfo.baseMediaDecodeTime } } }, { key: "handleUpdateEnd_", value: function () { if (!this.pendingSegment_) return this.state = "READY", void (this.paused() || this.monitorBuffer_()); var e = this.pendingSegment_, t = e.segment, i = null !== this.mediaIndex; this.pendingSegment_ = null, this.recordThroughput_(e), this.addSegmentMetadataCue_(e), this.state = "READY", this.mediaIndex = e.mediaIndex, this.fetchAtBuffer_ = !0, this.currentTimeline_ = e.timeline, this.trigger("syncinfoupdate"), t.end && this.currentTime_() - t.end > 3 * e.playlist.targetDuration ? this.resetEverything() : (i && this.trigger("bandwidthupdate"), this.trigger("progress"), this.isEndOfStream_(e.mediaIndex + 1, e.playlist) && this.endOfStream(), this.paused() || this.monitorBuffer_()) } }, { key: "recordThroughput_", value: function (e) { var t = this.throughput.rate, i = Date.now() - e.endOfAllRequests + 1, n = Math.floor(e.byteLength / i * 8 * 1e3); this.throughput.rate += (n - t) / ++this.throughput.count } }, { key: "addSegmentMetadataCue_", value: function (e) { if (this.segmentMetadataTrack_) { var t = e.segment, i = t.start, n = t.end; if (Bs(i) && Bs(n)) { Ba(i, n, this.segmentMetadataTrack_); var a = r.a.WebKitDataCue || r.a.VTTCue, s = { custom: t.custom, dateTimeObject: t.dateTimeObject, dateTimeString: t.dateTimeString, bandwidth: e.playlist.attributes.BANDWIDTH, resolution: e.playlist.attributes.RESOLUTION, codecs: e.playlist.attributes.CODECS, byteLength: e.byteLength, uri: e.uri, timeline: e.timeline, playlist: e.playlist.uri, start: i, end: n }, o = new a(i, n, JSON.stringify(s)); o.value = s, this.segmentMetadataTrack_.addCue(o) } } } }]), t }(Br.EventTarget), js = function (e) { return decodeURIComponent(escape(String.fromCharCode.apply(null, e))) }, Ns = new Uint8Array("\n\n".split("").map((function (e) { return e.charCodeAt(0) }))), Fs = function (e) { function t(e) { var i = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {}; Hr(this, t); var n = Wr(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e, i)); return n.mediaSource_ = null, n.subtitlesTrack_ = null, n } return Vr(t, e), qr(t, [{ key: "buffered_", value: function () { if (!this.subtitlesTrack_ || !this.subtitlesTrack_.cues.length) return Br.createTimeRanges(); var e = this.subtitlesTrack_.cues, t = e[0].startTime, i = e[e.length - 1].startTime; return Br.createTimeRanges([[t, i]]) } }, { key: "initSegment", value: function (e) { var t = arguments.length > 1 && void 0 !== arguments[1] && arguments[1]; if (!e) return null; var i = Ea(e), n = this.initSegments_[i]; if (t && !n && e.bytes) { var r = Ns.byteLength + e.bytes.byteLength, a = new Uint8Array(r); a.set(e.bytes), a.set(Ns, e.bytes.byteLength), this.initSegments_[i] = n = { resolvedUri: e.resolvedUri, byterange: e.byterange, bytes: a } } return n || e } }, { key: "couldBeginLoading_", value: function () { return this.playlist_ && this.subtitlesTrack_ && !this.paused() } }, { key: "init_", value: function () { return this.state = "READY", this.resetEverything(), this.monitorBuffer_() } }, { key: "track", value: function (e) { return "undefined" === typeof e ? this.subtitlesTrack_ : (this.subtitlesTrack_ = e, "INIT" === this.state && this.couldBeginLoading_() && this.init_(), this.subtitlesTrack_) } }, { key: "remove", value: function (e, t) { Ba(e, t, this.subtitlesTrack_) } }, { key: "fillBuffer_", value: function () { var e = this; this.syncPoint_ || (this.syncPoint_ = this.syncController_.getSyncPoint(this.playlist_, this.duration_(), this.currentTimeline_, this.currentTime_())); var t = this.checkBuffer_(this.buffered_(), this.playlist_, this.mediaIndex, this.hasPlayed_(), this.currentTime_(), this.syncPoint_); if (t = this.skipEmptySegments_(t)) { if (null === this.syncController_.timestampOffsetForTimeline(t.timeline)) { return this.syncController_.one("timestampoffset", (function () { e.state = "READY", e.paused() || e.monitorBuffer_() })), void (this.state = "WAITING_ON_TIMELINE") } this.loadSegment_(t) } } }, { key: "skipEmptySegments_", value: function (e) { for (; e && e.segment.empty;)e = this.generateSegmentInfo_(e.playlist, e.mediaIndex + 1, e.startOfSegment + e.duration, e.isSyncRequest); return e } }, { key: "handleSegment_", value: function () { var e = this; if (this.pendingSegment_ && this.subtitlesTrack_) { this.state = "APPENDING"; var t = this.pendingSegment_, i = t.segment; if ("function" !== typeof r.a.WebVTT && this.subtitlesTrack_ && this.subtitlesTrack_.tech_) { var n = void 0, a = function () { e.subtitlesTrack_.tech_.off("vttjsloaded", n), e.error({ message: "Error loading vtt.js" }), e.state = "READY", e.pause(), e.trigger("error") }; return n = function () { e.subtitlesTrack_.tech_.off("vttjserror", a), e.handleSegment_() }, this.state = "WAITING_ON_VTTJS", this.subtitlesTrack_.tech_.one("vttjsloaded", n), void this.subtitlesTrack_.tech_.one("vttjserror", a) } i.requested = !0; try { this.parseVTTCues_(t) } catch (yo) { return this.error({ message: yo.message }), this.state = "READY", this.pause(), this.trigger("error") } if (this.updateTimeMapping_(t, this.syncController_.timelines[t.timeline], this.playlist_), t.isSyncRequest) return this.trigger("syncinfoupdate"), this.pendingSegment_ = null, void (this.state = "READY"); t.byteLength = t.bytes.byteLength, this.mediaSecondsLoaded += i.duration, t.cues.length && this.remove(t.cues[0].endTime, t.cues[t.cues.length - 1].endTime), t.cues.forEach((function (t) { e.subtitlesTrack_.addCue(t) })), this.handleUpdateEnd_() } else this.state = "READY" } }, { key: "parseVTTCues_", value: function (e) { var t = void 0, i = !1; "function" === typeof r.a.TextDecoder ? t = new r.a.TextDecoder("utf8") : (t = r.a.WebVTT.StringDecoder(), i = !0); var n = new r.a.WebVTT.Parser(r.a, r.a.vttjs, t); if (e.cues = [], e.timestampmap = { MPEGTS: 0, LOCAL: 0 }, n.oncue = e.cues.push.bind(e.cues), n.ontimestampmap = function (t) { return e.timestampmap = t }, n.onparsingerror = function (e) { Br.log.warn("Error encountered when parsing cues: " + e.message) }, e.segment.map) { var a = e.segment.map.bytes; i && (a = js(a)), n.parse(a) } var s = e.bytes; i && (s = js(s)), n.parse(s), n.flush() } }, { key: "updateTimeMapping_", value: function (e, t, i) { var n = e.segment; if (t) if (e.cues.length) { var r = e.timestampmap, a = r.MPEGTS / 9e4 - r.LOCAL + t.mapping; if (e.cues.forEach((function (e) { e.startTime += a, e.endTime += a })), !i.syncInfo) { var s = e.cues[0].startTime, o = e.cues[e.cues.length - 1].startTime; i.syncInfo = { mediaSequence: i.mediaSequence + e.mediaIndex, time: Math.min(s, o - n.duration) } } } else n.empty = !0 } }]), t }(Us), Hs = function (e, t) { for (var i = e.cues, n = 0; n < i.length; n++) { var r = i[n]; if (t >= r.adStartTime && t <= r.adEndTime) return r } return null }, qs = w.a.inspect, Vs = [{ name: "VOD", run: function (e, t, i, n, r) { if (i !== 1 / 0) { return { time: 0, segmentIndex: 0 } } return null } }, { name: "ProgramDateTime", run: function (e, t, i, n, r) { if (!e.datetimeToDisplayTime) return null; var a = t.segments || [], s = null, o = null; r = r || 0; for (var l = 0; l < a.length; l++) { var u = a[l]; if (u.dateTimeObject) { var c = u.dateTimeObject.getTime() / 1e3 + e.datetimeToDisplayTime, h = Math.abs(r - c); if (null !== o && (0 === h || o < h)) break; o = h, s = { time: c, segmentIndex: l } } } return s } }, { name: "Segment", run: function (e, t, i, n, r) { var a = t.segments || [], s = null, o = null; r = r || 0; for (var l = 0; l < a.length; l++) { var u = a[l]; if (u.timeline === n && "undefined" !== typeof u.start) { var c = Math.abs(r - u.start); if (null !== o && o < c) break; (!s || null === o || o >= c) && (o = c, s = { time: u.start, segmentIndex: l }) } } return s } }, { name: "Discontinuity", run: function (e, t, i, n, r) { var a = null; if (r = r || 0, t.discontinuityStarts && t.discontinuityStarts.length) for (var s = null, o = 0; o < t.discontinuityStarts.length; o++) { var l = t.discontinuityStarts[o], u = t.discontinuitySequence + o + 1, c = e.discontinuities[u]; if (c) { var h = Math.abs(r - c.time); if (null !== s && s < h) break; (!a || null === s || s >= h) && (s = h, a = { time: c.time, segmentIndex: l }) } } return a } }, { name: "Playlist", run: function (e, t, i, n, r) { return t.syncInfo ? { time: t.syncInfo.time, segmentIndex: t.syncInfo.mediaSequence - t.mediaSequence } : null } }], Ws = function (e) { function t() { Hr(this, t); var e = Wr(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this)); return e.inspectCache_ = void 0, e.timelines = [], e.discontinuities = [], e.datetimeToDisplayTime = null, e.logger_ = bs("SyncController"), e } return Vr(t, e), qr(t, [{ key: "getSyncPoint", value: function (e, t, i, n) { var r = this.runStrategies_(e, t, i, n); return r.length ? this.selectSyncPoint_(r, { key: "time", value: n }) : null } }, { key: "getExpiredTime", value: function (e, t) { if (!e || !e.segments) return null; var i = this.runStrategies_(e, t, e.discontinuitySequence, 0); if (!i.length) return null; var n = this.selectSyncPoint_(i, { key: "segmentIndex", value: 0 }); return n.segmentIndex > 0 && (n.time *= -1), Math.abs(n.time + ra(e, n.segmentIndex, 0)) } }, { key: "runStrategies_", value: function (e, t, i, n) { for (var r = [], a = 0; a < Vs.length; a++) { var s = Vs[a], o = s.run(this, e, t, i, n); o && (o.strategy = s.name, r.push({ strategy: s.name, syncPoint: o })) } return r } }, { key: "selectSyncPoint_", value: function (e, t) { for (var i = e[0].syncPoint, n = Math.abs(e[0].syncPoint[t.key] - t.value), r = e[0].strategy, a = 1; a < e.length; a++) { var s = Math.abs(e[a].syncPoint[t.key] - t.value); s < n && (n = s, i = e[a].syncPoint, r = e[a].strategy) } return this.logger_("syncPoint for [" + t.key + ": " + t.value + "] chosen with strategy [" + r + "]: [time:" + i.time + ", segmentIndex:" + i.segmentIndex + "]"), i } }, { key: "saveExpiredSegmentInfo", value: function (e, t) { for (var i = t.mediaSequence - e.mediaSequence - 1; i >= 0; i--) { var n = e.segments[i]; if (n && "undefined" !== typeof n.start) { t.syncInfo = { mediaSequence: e.mediaSequence + i, time: n.start }, this.logger_("playlist refresh sync: [time:" + t.syncInfo.time + ", mediaSequence: " + t.syncInfo.mediaSequence + "]"), this.trigger("syncinfoupdate"); break } } } }, { key: "setDateTimeMapping", value: function (e) { if (!this.datetimeToDisplayTime && e.segments && e.segments.length && e.segments[0].dateTimeObject) { var t = e.segments[0].dateTimeObject.getTime() / 1e3; this.datetimeToDisplayTime = -t } } }, { key: "reset", value: function () { this.inspectCache_ = void 0 } }, { key: "probeSegmentInfo", value: function (e) { var t = e.segment, i = e.playlist, n = void 0; return (n = t.map ? this.probeMp4Segment_(e) : this.probeTsSegment_(e)) && this.calculateSegmentTimeMapping_(e, n) && (this.saveDiscontinuitySyncInfo_(e), i.syncInfo || (i.syncInfo = { mediaSequence: i.mediaSequence + e.mediaIndex, time: t.start })), n } }, { key: "probeMp4Segment_", value: function (e) { var t = e.segment, i = k.a.timescale(t.map.bytes), n = k.a.startTime(i, e.bytes); return null !== e.timestampOffset && (e.timestampOffset -= n), { start: n, end: n + t.duration } } }, { key: "probeTsSegment_", value: function (e) { var t = qs(e.bytes, this.inspectCache_), i = void 0, n = void 0, r = void 0; return t ? (t.video && 2 === t.video.length ? (this.inspectCache_ = t.video[1].dts, i = t.video[0].dtsTime, n = t.video[1].dtsTime, r = t.video) : t.audio && 2 === t.audio.length && (this.inspectCache_ = t.audio[1].dts, i = t.audio[0].dtsTime, n = t.audio[1].dtsTime, r = t.audio), { segmentTimestampInfo: r, start: i, end: n, containsVideo: t.video && 2 === t.video.length, containsAudio: t.audio && 2 === t.audio.length }) : null } }, { key: "timestampOffsetForTimeline", value: function (e) { return "undefined" === typeof this.timelines[e] ? null : this.timelines[e].time } }, { key: "mappingForTimeline", value: function (e) { return "undefined" === typeof this.timelines[e] ? null : this.timelines[e].mapping } }, { key: "calculateSegmentTimeMapping_", value: function (e, t) { var i = e.segment, n = this.timelines[e.timeline]; if (null !== e.timestampOffset) n = { time: e.startOfSegment, mapping: e.startOfSegment - t.start }, this.timelines[e.timeline] = n, this.trigger("timestampoffset"), this.logger_("time mapping for timeline " + e.timeline + ": [time: " + n.time + "] [mapping: " + n.mapping + "]"), i.start = e.startOfSegment, i.end = t.end + n.mapping; else { if (!n) return !1; i.start = t.start + n.mapping, i.end = t.end + n.mapping } return !0 } }, { key: "saveDiscontinuitySyncInfo_", value: function (e) { var t = e.playlist, i = e.segment; if (i.discontinuity) this.discontinuities[i.timeline] = { time: i.start, accuracy: 0 }; else if (t.discontinuityStarts && t.discontinuityStarts.length) for (var n = 0; n < t.discontinuityStarts.length; n++) { var r = t.discontinuityStarts[n], a = t.discontinuitySequence + n + 1, s = r - e.mediaIndex, o = Math.abs(s); if (!this.discontinuities[a] || this.discontinuities[a].accuracy > o) { var l = void 0; l = s < 0 ? i.start - ra(t, e.mediaIndex, r) : i.end + ra(t, e.mediaIndex + 1, r), this.discontinuities[a] = { time: l, accuracy: o } } } } }]), t }(Br.EventTarget), zs = new za("./decrypter-worker.worker.js", (function (e, t) { var i = this; !function () { var e = function (e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") }, t = function () { function e(e, t) { for (var i = 0; i < t.length; i++) { var n = t[i]; n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, n.key, n) } } return function (t, i, n) { return i && e(t.prototype, i), n && e(t, n), t } }(), n = function (e, t) { if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return !t || "object" !== typeof t && "function" !== typeof t ? e : t }, r = function () { var e = [[[], [], [], [], []], [[], [], [], [], []]], t = e[0], i = e[1], n = t[4], r = i[4], a = void 0, s = void 0, o = void 0, l = [], u = [], c = void 0, h = void 0, d = void 0, p = void 0, f = void 0; for (a = 0; a < 256; a++)u[(l[a] = a << 1 ^ 283 * (a >> 7)) ^ a] = a; for (s = o = 0; !n[s]; s ^= c || 1, o = u[o] || 1)for (d = (d = o ^ o << 1 ^ o << 2 ^ o << 3 ^ o << 4) >> 8 ^ 255 & d ^ 99, n[s] = d, r[d] = s, f = 16843009 * l[h = l[c = l[s]]] ^ 65537 * h ^ 257 * c ^ 16843008 * s, p = 257 * l[d] ^ 16843008 * d, a = 0; a < 4; a++)t[a][s] = p = p << 24 ^ p >>> 8, i[a][d] = f = f << 24 ^ f >>> 8; for (a = 0; a < 5; a++)t[a] = t[a].slice(0), i[a] = i[a].slice(0); return e }, a = null, s = function () { function t(i) { e(this, t), a || (a = r()), this._tables = [[a[0][0].slice(), a[0][1].slice(), a[0][2].slice(), a[0][3].slice(), a[0][4].slice()], [a[1][0].slice(), a[1][1].slice(), a[1][2].slice(), a[1][3].slice(), a[1][4].slice()]]; var n = void 0, s = void 0, o = void 0, l = void 0, u = void 0, c = this._tables[0][4], h = this._tables[1], d = i.length, p = 1; if (4 !== d && 6 !== d && 8 !== d) throw new Error("Invalid aes key size"); for (l = i.slice(0), u = [], this._key = [l, u], n = d; n < 4 * d + 28; n++)o = l[n - 1], (n % d === 0 || 8 === d && n % d === 4) && (o = c[o >>> 24] << 24 ^ c[o >> 16 & 255] << 16 ^ c[o >> 8 & 255] << 8 ^ c[255 & o], n % d === 0 && (o = o << 8 ^ o >>> 24 ^ p << 24, p = p << 1 ^ 283 * (p >> 7))), l[n] = l[n - d] ^ o; for (s = 0; n; s++, n--)o = l[3 & s ? n : n - 4], u[s] = n <= 4 || s < 4 ? o : h[0][c[o >>> 24]] ^ h[1][c[o >> 16 & 255]] ^ h[2][c[o >> 8 & 255]] ^ h[3][c[255 & o]] } return t.prototype.decrypt = function (e, t, i, n, r, a) { var s = this._key[1], o = e ^ s[0], l = n ^ s[1], u = i ^ s[2], c = t ^ s[3], h = void 0, d = void 0, p = void 0, f = s.length / 4 - 2, m = void 0, g = 4, v = this._tables[1], y = v[0], _ = v[1], b = v[2], T = v[3], k = v[4]; for (m = 0; m < f; m++)h = y[o >>> 24] ^ _[l >> 16 & 255] ^ b[u >> 8 & 255] ^ T[255 & c] ^ s[g], d = y[l >>> 24] ^ _[u >> 16 & 255] ^ b[c >> 8 & 255] ^ T[255 & o] ^ s[g + 1], p = y[u >>> 24] ^ _[c >> 16 & 255] ^ b[o >> 8 & 255] ^ T[255 & l] ^ s[g + 2], c = y[c >>> 24] ^ _[o >> 16 & 255] ^ b[l >> 8 & 255] ^ T[255 & u] ^ s[g + 3], g += 4, o = h, l = d, u = p; for (m = 0; m < 4; m++)r[(3 & -m) + a] = k[o >>> 24] << 24 ^ k[l >> 16 & 255] << 16 ^ k[u >> 8 & 255] << 8 ^ k[255 & c] ^ s[g++], h = o, o = l, l = u, u = c, c = h }, t }(), o = function () { function t() { e(this, t), this.listeners = {} } return t.prototype.on = function (e, t) { this.listeners[e] || (this.listeners[e] = []), this.listeners[e].push(t) }, t.prototype.off = function (e, t) { if (!this.listeners[e]) return !1; var i = this.listeners[e].indexOf(t); return this.listeners[e].splice(i, 1), i > -1 }, t.prototype.trigger = function (e) { var t = this.listeners[e]; if (t) if (2 === arguments.length) for (var i = t.length, n = 0; n < i; ++n)t[n].call(this, arguments[1]); else for (var r = Array.prototype.slice.call(arguments, 1), a = t.length, s = 0; s < a; ++s)t[s].apply(this, r) }, t.prototype.dispose = function () { this.listeners = {} }, t.prototype.pipe = function (e) { this.on("data", (function (t) { e.push(t) })) }, t }(), l = function (t) { function i() { e(this, i); var r = n(this, t.call(this, o)); return r.jobs = [], r.delay = 1, r.timeout_ = null, r } return function (e, t) { if ("function" !== typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t); e.prototype = Object.create(t && t.prototype, { constructor: { value: e, enumerable: !1, writable: !0, configurable: !0 } }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t) }(i, t), i.prototype.processJob_ = function () { this.jobs.shift()(), this.jobs.length ? this.timeout_ = setTimeout(this.processJob_.bind(this), this.delay) : this.timeout_ = null }, i.prototype.push = function (e) { this.jobs.push(e), this.timeout_ || (this.timeout_ = setTimeout(this.processJob_.bind(this), this.delay)) }, i }(o), u = function (e) { return e << 24 | (65280 & e) << 8 | (16711680 & e) >> 8 | e >>> 24 }, c = function () { function i(t, n, r, a) { e(this, i); var s = i.STEP, o = new Int32Array(t.buffer), c = new Uint8Array(t.byteLength), h = 0; for (this.asyncStream_ = new l, this.asyncStream_.push(this.decryptChunk_(o.subarray(h, h + s), n, r, c)), h = s; h < o.length; h += s)r = new Uint32Array([u(o[h - 4]), u(o[h - 3]), u(o[h - 2]), u(o[h - 1])]), this.asyncStream_.push(this.decryptChunk_(o.subarray(h, h + s), n, r, c)); this.asyncStream_.push((function () { var e; a(null, (e = c).subarray(0, e.byteLength - e[e.byteLength - 1])) })) } return i.prototype.decryptChunk_ = function (e, t, i, n) { return function () { var r = function (e, t, i) { var n = new Int32Array(e.buffer, e.byteOffset, e.byteLength >> 2), r = new s(Array.prototype.slice.call(t)), a = new Uint8Array(e.byteLength), o = new Int32Array(a.buffer), l = void 0, c = void 0, h = void 0, d = void 0, p = void 0, f = void 0, m = void 0, g = void 0, v = void 0; for (l = i[0], c = i[1], h = i[2], d = i[3], v = 0; v < n.length; v += 4)p = u(n[v]), f = u(n[v + 1]), m = u(n[v + 2]), g = u(n[v + 3]), r.decrypt(p, f, m, g, o, v), o[v] = u(o[v] ^ l), o[v + 1] = u(o[v + 1] ^ c), o[v + 2] = u(o[v + 2] ^ h), o[v + 3] = u(o[v + 3] ^ d), l = p, c = f, h = m, d = g; return a }(e, t, i); n.set(r, e.byteOffset) } }, t(i, null, [{ key: "STEP", get: function () { return 32e3 } }]), i }(); new function (e) { e.onmessage = function (t) { var i = t.data, n = new Uint8Array(i.encrypted.bytes, i.encrypted.byteOffset, i.encrypted.byteLength), r = new Uint32Array(i.key.bytes, i.key.byteOffset, i.key.byteLength / 4), a = new Uint32Array(i.iv.bytes, i.iv.byteOffset, i.iv.byteLength / 4); new c(n, r, a, (function (t, n) { e.postMessage(function (e) { var t = {}; return Object.keys(e).forEach((function (i) { var n = e[i]; ArrayBuffer.isView(n) ? t[i] = { bytes: n.buffer, byteOffset: n.byteOffset, byteLength: n.byteLength } : t[i] = n })), t }({ source: i.source, decrypted: n }), [n.buffer]) })) } }(i) }() })), Gs = function (e) { var t = e.default ? "main" : "alternative"; return e.characteristics && e.characteristics.indexOf("public.accessibility.describes-video") >= 0 && (t = "main-desc"), t }, Ks = function (e, t) { e.abort(), e.pause(), t && t.activePlaylistLoader && (t.activePlaylistLoader.pause(), t.activePlaylistLoader = null) }, Ys = function (e, t) { t.activePlaylistLoader = e, e.load() }, Xs = { AUDIO: function (e, t) { return function () { var i = t.segmentLoaders[e], n = t.mediaTypes[e], r = t.blacklistCurrentPlaylist; Ks(i, n); var a = n.activeTrack(), s = n.activeGroup(), o = (s.filter((function (e) { return e.default }))[0] || s[0]).id, l = n.tracks[o]; if (a !== l) { for (var u in Br.log.warn("Problem encountered loading the alternate audio track.Switching back to default."), n.tracks) n.tracks[u].enabled = n.tracks[u] === l; n.onTrackChanged() } else r({ message: "Problem encountered loading the default audio track." }) } }, SUBTITLES: function (e, t) { return function () { var i = t.segmentLoaders[e], n = t.mediaTypes[e]; Br.log.warn("Problem encountered loading the subtitle track.Disabling subtitle track."), Ks(i, n); var r = n.activeTrack(); r && (r.mode = "disabled"), n.onTrackChanged() } } }, $s = { AUDIO: function (e, t, i) { if (t) { var n = i.tech, r = i.requestOptions, a = i.segmentLoaders[e]; t.on("loadedmetadata", (function () { var e = t.media(); a.playlist(e, r), (!n.paused() || e.endList && "none" !== n.preload()) && a.load() })), t.on("loadedplaylist", (function () { a.playlist(t.media(), r), n.paused() || a.load() })), t.on("error", Xs[e](e, i)) } }, SUBTITLES: function (e, t, i) { var n = i.tech, r = i.requestOptions, a = i.segmentLoaders[e], s = i.mediaTypes[e]; t.on("loadedmetadata", (function () { var e = t.media(); a.playlist(e, r), a.track(s.activeTrack()), (!n.paused() || e.endList && "none" !== n.preload()) && a.load() })), t.on("loadedplaylist", (function () { a.playlist(t.media(), r), n.paused() || a.load() })), t.on("error", Xs[e](e, i)) } }, Qs = { AUDIO: function (e, t) { var i = t.hls, n = t.sourceType, r = t.segmentLoaders[e], a = t.requestOptions, s = t.master.mediaGroups, o = t.mediaTypes[e], l = o.groups, u = o.tracks, c = t.masterPlaylistLoader; for (var h in s[e] && 0 !== Object.keys(s[e]).length || (s[e] = { main: { default: { default: !0 } } }), s[e]) for (var d in l[h] || (l[h] = []), s[e][h]) { var p = s[e][h][d], f = void 0; if (f = p.resolvedUri ? new ea(p.resolvedUri, i, a) : p.playlists && "dash" === n ? new _s(p.playlists[0], i, a, c) : null, p = Br.mergeOptions({ id: d, playlistLoader: f }, p), $s[e](e, p.playlistLoader, t), l[h].push(p), "undefined" === typeof u[d]) { var m = new Br.AudioTrack({ id: d, kind: Gs(p), enabled: !1, language: p.language, default: p.default, label: d }); u[d] = m } } r.on("error", Xs[e](e, t)) }, SUBTITLES: function (e, t) { var i = t.tech, n = t.hls, r = t.sourceType, a = t.segmentLoaders[e], s = t.requestOptions, o = t.master.mediaGroups, l = t.mediaTypes[e], u = l.groups, c = l.tracks, h = t.masterPlaylistLoader; for (var d in o[e]) for (var p in u[d] || (u[d] = []), o[e][d]) if (!o[e][d][p].forced) { var f = o[e][d][p], m = void 0; if ("hls" === r ? m = new ea(f.resolvedUri, n, s) : "dash" === r && (m = new _s(f.playlists[0], n, s, h)), f = Br.mergeOptions({ id: p, playlistLoader: m }, f), $s[e](e, f.playlistLoader, t), u[d].push(f), "undefined" === typeof c[p]) { var g = i.addRemoteTextTrack({ id: p, kind: "subtitles", default: f.default && f.autoselect, language: f.language, label: p }, !1).track; c[p] = g } } a.on("error", Xs[e](e, t)) }, "CLOSED-CAPTIONS": function (e, t) { var i = t.tech, n = t.master.mediaGroups, r = t.mediaTypes[e], a = r.groups, s = r.tracks; for (var o in n[e]) for (var l in a[o] || (a[o] = []), n[e][o]) { var u = n[e][o][l]; if (u.instreamId.match(/CC\d/) && (a[o].push(Br.mergeOptions({ id: l }, u)), "undefined" === typeof s[l])) { var c = i.addRemoteTextTrack({ id: u.instreamId, kind: "captions", default: u.default && u.autoselect, language: u.language, label: l }, !1).track; s[l] = c } } } }, Js = { AUDIO: function (e, t) { return function () { var i = t.mediaTypes[e].tracks; for (var n in i) if (i[n].enabled) return i[n]; return null } }, SUBTITLES: function (e, t) { return function () { var i = t.mediaTypes[e].tracks; for (var n in i) if ("showing" === i[n].mode) return i[n]; return null } } }, Zs = function (e) { ["AUDIO", "SUBTITLES", "CLOSED-CAPTIONS"].forEach((function (t) { Qs[t](t, e) })); var t = e.mediaTypes, i = e.masterPlaylistLoader, n = e.tech, r = e.hls;["AUDIO", "SUBTITLES"].forEach((function (i) { t[i].activeGroup = function (e, t) { return function (i) { var n = t.masterPlaylistLoader, r = t.mediaTypes[e].groups, a = n.media(); if (!a) return null; var s = null; return a.attributes[e] && (s = r[a.attributes[e]]), s = s || r.main, "undefined" === typeof i ? s : null === i ? null : s.filter((function (e) { return e.id === i.id }))[0] || null } }(i, e), t[i].activeTrack = Js[i](i, e), t[i].onGroupChanged = function (e, t) { return function () { var i = t.segmentLoaders, n = i[e], r = i.main, a = t.mediaTypes[e], s = a.activeTrack(), o = a.activeGroup(s), l = a.activePlaylistLoader; Ks(n, a), o && (o.playlistLoader ? (n.resyncLoader(), Ys(o.playlistLoader, a)) : l && r.resetEverything()) } }(i, e), t[i].onTrackChanged = function (e, t) { return function () { var i = t.segmentLoaders, n = i[e], r = i.main, a = t.mediaTypes[e], s = a.activeTrack(), o = a.activeGroup(s), l = a.activePlaylistLoader; Ks(n, a), o && (o.playlistLoader ? l !== o.playlistLoader ? (n.track && n.track(s), n.resetEverything(), Ys(o.playlistLoader, a)) : Ys(o.playlistLoader, a) : r.resetEverything()) } }(i, e) })); var a = t.AUDIO.activeGroup(), s = (a.filter((function (e) { return e.default }))[0] || a[0]).id; t.AUDIO.tracks[s].enabled = !0, t.AUDIO.onTrackChanged(), i.on("mediachange", (function () { ["AUDIO", "SUBTITLES"].forEach((function (e) { return t[e].onGroupChanged() })) })); var o = function () { t.AUDIO.onTrackChanged(), n.trigger({ type: "usage", name: "hls-audio-change" }) }; for (var l in n.audioTracks().addEventListener("change", o), n.remoteTextTracks().addEventListener("change", t.SUBTITLES.onTrackChanged), r.on("dispose", (function () { n.audioTracks().removeEventListener("change", o), n.remoteTextTracks().removeEventListener("change", t.SUBTITLES.onTrackChanged) })), n.clearTracks("audio"), t.AUDIO.tracks) n.audioTracks().addTrack(t.AUDIO.tracks[l]) }, eo = function () { var e = {}; return ["AUDIO", "SUBTITLES", "CLOSED-CAPTIONS"].forEach((function (t) { e[t] = { groups: {}, tracks: {}, activePlaylistLoader: null, activeGroup: Ts, activeTrack: Ts, onGroupChanged: Ts, onTrackChanged: Ts } })), e }, to = void 0, io = ["mediaRequests", "mediaRequestsAborted", "mediaRequestsTimedout", "mediaRequestsErrored", "mediaTransferDuration", "mediaBytesTransferred"], no = function (e) { return this.audioSegmentLoader_[e] + this.mainSegmentLoader_[e] }, ro = function (e) { function t(e) { Hr(this, t); var i = Wr(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this)), n = e.url, r = e.handleManifestRedirects, a = e.withCredentials, s = e.tech, o = e.bandwidth, l = e.externHls, u = e.useCueTags, c = e.blacklistDuration, h = e.enableLowInitialPlaylist, d = e.sourceType, p = e.seekTo, f = e.cacheEncryptionKeys; if (!n) throw new Error("A non-empty playlist URL is required"); to = l, i.withCredentials = a, i.tech_ = s, i.hls_ = s.hls, i.seekTo_ = p, i.sourceType_ = d, i.useCueTags_ = u, i.blacklistDuration = c, i.enableLowInitialPlaylist = h, i.useCueTags_ && (i.cueTagsTrack_ = i.tech_.addTextTrack("metadata", "ad-cues"), i.cueTagsTrack_.inBandMetadataTrackDispatchType = ""), i.requestOptions_ = { withCredentials: a, handleManifestRedirects: r, timeout: null }, i.mediaTypes_ = eo(), i.mediaSource = new Br.MediaSource, i.mediaSource.addEventListener("sourceopen", i.handleSourceOpen_.bind(i)), i.seekable_ = Br.createTimeRanges(), i.hasPlayed_ = function () { return !1 }, i.syncController_ = new Ws(e), i.segmentMetadataTrack_ = s.addRemoteTextTrack({ kind: "metadata", label: "segment-metadata" }, !1).track, i.decrypter_ = new zs, i.inbandTextTracks_ = {}; var m = { hls: i.hls_, mediaSource: i.mediaSource, currentTime: i.tech_.currentTime.bind(i.tech_), seekable: function () { return i.seekable() }, seeking: function () { return i.tech_.seeking() }, duration: function () { return i.mediaSource.duration }, hasPlayed: function () { return i.hasPlayed_() }, goalBufferLength: function () { return i.goalBufferLength() }, bandwidth: o, syncController: i.syncController_, decrypter: i.decrypter_, sourceType: i.sourceType_, inbandTextTracks: i.inbandTextTracks_, cacheEncryptionKeys: f }; return i.masterPlaylistLoader_ = "dash" === i.sourceType_ ? new _s(n, i.hls_, i.requestOptions_) : new ea(n, i.hls_, i.requestOptions_), i.setupMasterPlaylistLoaderListeners_(), i.mainSegmentLoader_ = new Us(Br.mergeOptions(m, { segmentMetadataTrack: i.segmentMetadataTrack_, loaderType: "main" }), e), i.audioSegmentLoader_ = new Us(Br.mergeOptions(m, { loaderType: "audio" }), e), i.subtitleSegmentLoader_ = new Fs(Br.mergeOptions(m, { loaderType: "vtt" }), e), i.setupSegmentLoaderListeners_(), io.forEach((function (e) { i[e + "_"] = no.bind(i, e) })), i.logger_ = bs("MPC"), i.masterPlaylistLoader_.load(), i } return Vr(t, e), qr(t, [{ key: "setupMasterPlaylistLoaderListeners_", value: function () { var e = this; this.masterPlaylistLoader_.on("loadedmetadata", (function () { var t = e.masterPlaylistLoader_.media(), i = 1.5 * t.targetDuration * 1e3; ma(e.masterPlaylistLoader_.master, e.masterPlaylistLoader_.media()) ? e.requestOptions_.timeout = 0 : e.requestOptions_.timeout = i, t.endList && "none" !== e.tech_.preload() && (e.mainSegmentLoader_.playlist(t, e.requestOptions_), e.mainSegmentLoader_.load()), Zs({ sourceType: e.sourceType_, segmentLoaders: { AUDIO: e.audioSegmentLoader_, SUBTITLES: e.subtitleSegmentLoader_, main: e.mainSegmentLoader_ }, tech: e.tech_, requestOptions: e.requestOptions_, masterPlaylistLoader: e.masterPlaylistLoader_, hls: e.hls_, master: e.master(), mediaTypes: e.mediaTypes_, blacklistCurrentPlaylist: e.blacklistCurrentPlaylist.bind(e) }), e.triggerPresenceUsage_(e.master(), t); try { e.setupSourceBuffers_() } catch (yo) { return Br.log.warn("Failed to create SourceBuffers", yo), e.mediaSource.endOfStream("decode") } e.setupFirstPlay(), !e.mediaTypes_.AUDIO.activePlaylistLoader || e.mediaTypes_.AUDIO.activePlaylistLoader.media() ? e.trigger("selectedinitialmedia") : e.mediaTypes_.AUDIO.activePlaylistLoader.one("loadedmetadata", (function () { e.trigger("selectedinitialmedia") })) })), this.masterPlaylistLoader_.on("loadedplaylist", (function () { var t = e.masterPlaylistLoader_.media(); if (!t) { e.excludeUnsupportedVariants_(); var i = void 0; return e.enableLowInitialPlaylist && (i = e.selectInitialPlaylist()), i || (i = e.selectPlaylist()), e.initialMedia_ = i, void e.masterPlaylistLoader_.media(e.initialMedia_) } if (e.useCueTags_ && e.updateAdCues_(t), e.mainSegmentLoader_.playlist(t, e.requestOptions_), e.updateDuration(), e.tech_.paused() || (e.mainSegmentLoader_.load(), e.audioSegmentLoader_ && e.audioSegmentLoader_.load()), !t.endList) { var n = function () { var t = e.seekable(); 0 !== t.length && e.mediaSource.addSeekableRange_(t.start(0), t.end(0)) }; if (e.duration() !== 1 / 0) { e.tech_.one("durationchange", (function t() { e.duration() === 1 / 0 ? n() : e.tech_.one("durationchange", t) })) } else n() } })), this.masterPlaylistLoader_.on("error", (function () { e.blacklistCurrentPlaylist(e.masterPlaylistLoader_.error) })), this.masterPlaylistLoader_.on("mediachanging", (function () { e.mainSegmentLoader_.abort(), e.mainSegmentLoader_.pause() })), this.masterPlaylistLoader_.on("mediachange", (function () { var t = e.masterPlaylistLoader_.media(), i = 1.5 * t.targetDuration * 1e3; ma(e.masterPlaylistLoader_.master, e.masterPlaylistLoader_.media()) ? e.requestOptions_.timeout = 0 : e.requestOptions_.timeout = i, e.mainSegmentLoader_.playlist(t, e.requestOptions_), e.mainSegmentLoader_.load(), e.tech_.trigger({ type: "mediachange", bubbles: !0 }) })), this.masterPlaylistLoader_.on("playlistunchanged", (function () { var t = e.masterPlaylistLoader_.media(); e.stuckAtPlaylistEnd_(t) && (e.blacklistCurrentPlaylist({ message: "Playlist no longer updating." }), e.tech_.trigger("playliststuck")) })), this.masterPlaylistLoader_.on("renditiondisabled", (function () { e.tech_.trigger({ type: "usage", name: "hls-rendition-disabled" }) })), this.masterPlaylistLoader_.on("renditionenabled", (function () { e.tech_.trigger({ type: "usage", name: "hls-rendition-enabled" }) })) } }, { key: "triggerPresenceUsage_", value: function (e, t) { var i = e.mediaGroups || {}, n = !0, r = Object.keys(i.AUDIO); for (var a in i.AUDIO) for (var s in i.AUDIO[a]) { i.AUDIO[a][s].uri || (n = !1) } n && this.tech_.trigger({ type: "usage", name: "hls-demuxed" }), Object.keys(i.SUBTITLES).length && this.tech_.trigger({ type: "usage", name: "hls-webvtt" }), to.Playlist.isAes(t) && this.tech_.trigger({ type: "usage", name: "hls-aes" }), to.Playlist.isFmp4(t) && this.tech_.trigger({ type: "usage", name: "hls-fmp4" }), r.length && Object.keys(i.AUDIO[r[0]]).length > 1 && this.tech_.trigger({ type: "usage", name: "hls-alternate-audio" }), this.useCueTags_ && this.tech_.trigger({ type: "usage", name: "hls-playlist-cue-tags" }) } }, { key: "setupSegmentLoaderListeners_", value: function () { var e = this; this.mainSegmentLoader_.on("bandwidthupdate", (function () { var t = e.selectPlaylist(), i = e.masterPlaylistLoader_.media(), n = e.tech_.buffered(), r = n.length ? n.end(n.length - 1) - e.tech_.currentTime() : 0, a = e.bufferLowWaterLine(); (!i.endList || e.duration() < Ss.MAX_BUFFER_LOW_WATER_LINE || t.attributes.BANDWIDTH < i.attributes.BANDWIDTH || r >= a) && e.masterPlaylistLoader_.media(t), e.tech_.trigger("bandwidthupdate") })), this.mainSegmentLoader_.on("progress", (function () { e.trigger("progress") })), this.mainSegmentLoader_.on("error", (function () { e.blacklistCurrentPlaylist(e.mainSegmentLoader_.error()) })), this.mainSegmentLoader_.on("syncinfoupdate", (function () { e.onSyncInfoUpdate_() })), this.mainSegmentLoader_.on("timestampoffset", (function () { e.tech_.trigger({ type: "usage", name: "hls-timestamp-offset" }) })), this.audioSegmentLoader_.on("syncinfoupdate", (function () { e.onSyncInfoUpdate_() })), this.mainSegmentLoader_.on("ended", (function () { e.onEndOfStream() })), this.mainSegmentLoader_.on("earlyabort", (function () { e.blacklistCurrentPlaylist({ message: "Aborted early because there isn't enough bandwidth to complete the request without rebuffering." }, 120) })), this.mainSegmentLoader_.on("reseteverything", (function () { e.tech_.trigger("hls-reset") })), this.mainSegmentLoader_.on("segmenttimemapping", (function (t) { e.tech_.trigger({ type: "hls-segment-time-mapping", mapping: t.mapping }) })), this.audioSegmentLoader_.on("ended", (function () { e.onEndOfStream() })) } }, { key: "mediaSecondsLoaded_", value: function () { return Math.max(this.audioSegmentLoader_.mediaSecondsLoaded + this.mainSegmentLoader_.mediaSecondsLoaded) } }, { key: "load", value: function () { this.mainSegmentLoader_.load(), this.mediaTypes_.AUDIO.activePlaylistLoader && this.audioSegmentLoader_.load(), this.mediaTypes_.SUBTITLES.activePlaylistLoader && this.subtitleSegmentLoader_.load() } }, { key: "smoothQualityChange_", value: function () { var e = this.selectPlaylist(); e !== this.masterPlaylistLoader_.media() && (this.masterPlaylistLoader_.media(e), this.mainSegmentLoader_.resetLoader()) } }, { key: "fastQualityChange_", value: function () { var e = this, t = this.selectPlaylist(); t !== this.masterPlaylistLoader_.media() && (this.masterPlaylistLoader_.media(t), this.mainSegmentLoader_.resetEverything((function () { Br.browser.IE_VERSION || Br.browser.IS_EDGE ? e.tech_.setCurrentTime(e.tech_.currentTime() + .04) : e.tech_.setCurrentTime(e.tech_.currentTime()) }))) } }, { key: "play", value: function () { if (!this.setupFirstPlay()) { this.tech_.ended() && this.seekTo_(0), this.hasPlayed_() && this.load(); var e = this.tech_.seekable(); return this.tech_.duration() === 1 / 0 && this.tech_.currentTime() < e.start(0) ? this.seekTo_(e.end(e.length - 1)) : void 0 } } }, { key: "setupFirstPlay", value: function () { var e = this, t = this.masterPlaylistLoader_.media(); if (!t || this.tech_.paused() || this.hasPlayed_()) return !1; if (!t.endList) { var i = this.seekable(); if (!i.length) return !1; if (Br.browser.IE_VERSION && 0 === this.tech_.readyState()) return this.tech_.one("loadedmetadata", (function () { e.trigger("firstplay"), e.seekTo_(i.end(0)), e.hasPlayed_ = function () { return !0 } })), !1; this.trigger("firstplay"), this.seekTo_(i.end(0)) } return this.hasPlayed_ = function () { return !0 }, this.load(), !0 } }, { key: "handleSourceOpen_", value: function () { try { this.setupSourceBuffers_() } catch (yo) { return Br.log.warn("Failed to create Source Buffers", yo), this.mediaSource.endOfStream("decode") } if (this.tech_.autoplay()) { var e = this.tech_.play(); "undefined" !== typeof e && "function" === typeof e.then && e.then(null, (function (e) { })) } this.trigger("sourceopen") } }, { key: "onEndOfStream", value: function () { var e = this.mainSegmentLoader_.ended_; if (this.mediaTypes_.AUDIO.activePlaylistLoader && (e = !this.mainSegmentLoader_.startingMedia_ || this.mainSegmentLoader_.startingMedia_.containsVideo ? e && this.audioSegmentLoader_.ended_ : this.audioSegmentLoader_.ended_), e) { this.logger_("calling mediaSource.endOfStream()"); try { this.mediaSource.endOfStream() } catch (yo) { Br.log.warn("Failed to call media source endOfStream", yo) } } } }, { key: "stuckAtPlaylistEnd_", value: function (e) { if (!this.seekable().length) return !1; var t = this.syncController_.getExpiredTime(e, this.mediaSource.duration); if (null === t) return !1; var i = to.Playlist.playlistEnd(e, t), n = this.tech_.currentTime(), r = this.tech_.buffered(); if (!r.length) return i - n <= .1; var a = r.end(r.length - 1); return a - n <= .1 && i - a <= .1 } }, { key: "blacklistCurrentPlaylist", value: function () { var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}, t = arguments[1], i = void 0, n = void 0; if (i = e.playlist || this.masterPlaylistLoader_.media(), t = t || e.blacklistDuration || this.blacklistDuration, !i) { this.error = e; try { return this.mediaSource.endOfStream("network") } catch (yo) { return this.trigger("error") } } var r = 1 === this.masterPlaylistLoader_.master.playlists.filter(pa).length, a = this.masterPlaylistLoader_.master.playlists; return 1 === a.length ? (Br.log.warn("Problem encountered with the current HLS playlist. Trying again since it is the only playlist."), this.tech_.trigger("retryplaylist"), this.masterPlaylistLoader_.load(r)) : (r && (Br.log.warn("Removing all playlists from the blacklist because the last rendition is about to be blacklisted."), a.forEach((function (e) { e.excludeUntil !== 1 / 0 && delete e.excludeUntil })), this.tech_.trigger("retryplaylist")), i.excludeUntil = Date.now() + 1e3 * t, this.tech_.trigger("blacklistplaylist"), this.tech_.trigger({ type: "usage", name: "hls-rendition-blacklisted" }), n = this.selectPlaylist(), Br.log.warn("Problem encountered with the current HLS playlist." + (e.message ? " " + e.message : "") + " Switching to another playlist."), this.masterPlaylistLoader_.media(n, r)) } }, { key: "pauseLoading", value: function () { this.mainSegmentLoader_.pause(), this.mediaTypes_.AUDIO.activePlaylistLoader && this.audioSegmentLoader_.pause(), this.mediaTypes_.SUBTITLES.activePlaylistLoader && this.subtitleSegmentLoader_.pause() } }, { key: "setCurrentTime", value: function (e) { var t = Oa(this.tech_.buffered(), e); return this.masterPlaylistLoader_ && this.masterPlaylistLoader_.media() && this.masterPlaylistLoader_.media().segments ? t && t.length ? e : (this.mainSegmentLoader_.resetEverything(), this.mainSegmentLoader_.abort(), this.mediaTypes_.AUDIO.activePlaylistLoader && (this.audioSegmentLoader_.resetEverything(), this.audioSegmentLoader_.abort()), this.mediaTypes_.SUBTITLES.activePlaylistLoader && (this.subtitleSegmentLoader_.resetEverything(), this.subtitleSegmentLoader_.abort()), void this.load()) : 0 } }, { key: "duration", value: function () { return this.masterPlaylistLoader_ ? this.mediaSource ? this.mediaSource.duration : to.Playlist.duration(this.masterPlaylistLoader_.media()) : 0 } }, { key: "seekable", value: function () { return this.seekable_ } }, { key: "onSyncInfoUpdate_", value: function () { var e = void 0, t = void 0; if (this.masterPlaylistLoader_) { var i = this.masterPlaylistLoader_.media(); if (i) { var n = this.syncController_.getExpiredTime(i, this.mediaSource.duration); if (null !== n && 0 !== (e = to.Playlist.seekable(i, n)).length) { if (this.mediaTypes_.AUDIO.activePlaylistLoader) { if (i = this.mediaTypes_.AUDIO.activePlaylistLoader.media(), null === (n = this.syncController_.getExpiredTime(i, this.mediaSource.duration))) return; if (0 === (t = to.Playlist.seekable(i, n)).length) return } var r = void 0, a = void 0; this.seekable_ && this.seekable_.length && (r = this.seekable_.end(0), a = this.seekable_.start(0)), t ? t.start(0) > e.end(0) || e.start(0) > t.end(0) ? this.seekable_ = e : this.seekable_ = Br.createTimeRanges([[t.start(0) > e.start(0) ? t.start(0) : e.start(0), t.end(0) < e.end(0) ? t.end(0) : e.end(0)]]) : this.seekable_ = e, this.seekable_ && this.seekable_.length && this.seekable_.end(0) === r && this.seekable_.start(0) === a || (this.logger_("seekable updated [" + Ma(this.seekable_) + "]"), this.tech_.trigger("seekablechanged")) } } } } }, { key: "updateDuration", value: function () { var e = this, t = this.mediaSource.duration, i = to.Playlist.duration(this.masterPlaylistLoader_.media()), n = this.tech_.buffered(), r = function t() { e.logger_("Setting duration from " + e.mediaSource.duration + " => " + i); try { e.mediaSource.duration = i } catch (yo) { Br.log.warn("Failed to set media source duration", yo) } e.tech_.trigger("durationchange"), e.mediaSource.removeEventListener("sourceopen", t) }; n.length > 0 && (i = Math.max(i, n.end(n.length - 1))), t !== i && ("open" !== this.mediaSource.readyState ? this.mediaSource.addEventListener("sourceopen", r) : r()) } }, { key: "dispose", value: function () { var e = this; this.decrypter_.terminate(), this.masterPlaylistLoader_.dispose(), this.mainSegmentLoader_.dispose(), ["AUDIO", "SUBTITLES"].forEach((function (t) { var i = e.mediaTypes_[t].groups; for (var n in i) i[n].forEach((function (e) { e.playlistLoader && e.playlistLoader.dispose() })) })), this.audioSegmentLoader_.dispose(), this.subtitleSegmentLoader_.dispose() } }, { key: "master", value: function () { return this.masterPlaylistLoader_.master } }, { key: "media", value: function () { return this.masterPlaylistLoader_.media() || this.initialMedia_ } }, { key: "setupSourceBuffers_", value: function () { var e, t = this.masterPlaylistLoader_.media(); if (t && "open" === this.mediaSource.readyState) { if ((e = ts(this.masterPlaylistLoader_.master, t)).length < 1) return this.error = "No compatible SourceBuffer configuration for the variant stream:" + t.resolvedUri, this.mediaSource.endOfStream("decode"); this.configureLoaderMimeTypes_(e), this.excludeIncompatibleVariants_(t) } } }, { key: "configureLoaderMimeTypes_", value: function (e) { var t = e.length > 1 && -1 === e[0].indexOf(",") && e[0] !== e[1] ? new Br.EventTarget : null; this.mainSegmentLoader_.mimeType(e[0], t), e[1] && this.audioSegmentLoader_.mimeType(e[1], t) } }, { key: "excludeUnsupportedVariants_", value: function () { this.master().playlists.forEach((function (e) { var t; e.attributes.CODECS && r.a.MediaSource && r.a.MediaSource.isTypeSupported && !r.a.MediaSource.isTypeSupported('video/mp4; codecs="' + (t = e.attributes.CODECS, t.replace(/avc1\.(\d+)\.(\d+)/i, (function (e) { return Ja([e])[0] }))) + '"') && (e.excludeUntil = 1 / 0) })) } }, { key: "excludeIncompatibleVariants_", value: function (e) { var t = 2, i = null, n = void 0; e.attributes.CODECS && (n = Za(e.attributes.CODECS), i = n.videoCodec, t = n.codecCount), this.master().playlists.forEach((function (e) { var n = { codecCount: 2, videoCodec: null }; e.attributes.CODECS && (n = Za(e.attributes.CODECS)), n.codecCount !== t && (e.excludeUntil = 1 / 0), n.videoCodec !== i && (e.excludeUntil = 1 / 0) })) } }, { key: "updateAdCues_", value: function (e) { var t = 0, i = this.seekable(); i.length && (t = i.start(0)), function (e, t) { var i = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : 0; if (e.segments) for (var n = i, a = void 0, s = 0; s < e.segments.length; s++) { var o = e.segments[s]; if (a || (a = Hs(t, n + o.duration / 2)), a) { if ("cueIn" in o) { a.endTime = n, a.adEndTime = n, n += o.duration, a = null; continue } if (n < a.endTime) { n += o.duration; continue } a.endTime += o.duration } else if ("cueOut" in o && ((a = new r.a.VTTCue(n, n + o.duration, o.cueOut)).adStartTime = n, a.adEndTime = n + parseFloat(o.cueOut), t.addCue(a)), "cueOutCont" in o) { var l = void 0, u = void 0, c = o.cueOutCont.split("/").map(parseFloat), h = zr(c, 2); l = h[0], u = h[1], (a = new r.a.VTTCue(n, n + o.duration, "")).adStartTime = n - l, a.adEndTime = a.adStartTime + u, t.addCue(a) } n += o.duration } }(e, this.cueTagsTrack_, t) } }, { key: "goalBufferLength", value: function () { var e = this.tech_.currentTime(), t = Ss.GOAL_BUFFER_LENGTH, i = Ss.GOAL_BUFFER_LENGTH_RATE, n = Math.max(t, Ss.MAX_GOAL_BUFFER_LENGTH); return Math.min(t + e * i, n) } }, { key: "bufferLowWaterLine", value: function () { var e = this.tech_.currentTime(), t = Ss.BUFFER_LOW_WATER_LINE, i = Ss.BUFFER_LOW_WATER_LINE_RATE, n = Math.max(t, Ss.MAX_BUFFER_LOW_WATER_LINE); return Math.min(t + e * i, n) } }]), t }(Br.EventTarget), ao = function e(t, i, n) { Hr(this, e); var r, a, s, o = t.masterPlaylistController_, l = o[(t.options_.smoothQualityChange ? "smooth" : "fast") + "QualityChange_"].bind(o); if (i.attributes.RESOLUTION) { var u = i.attributes.RESOLUTION; this.width = u.width, this.height = u.height } this.bandwidth = i.attributes.BANDWIDTH, this.id = n, this.enabled = (r = t.playlists, a = i.uri, s = l, function (e) { var t = r.master.playlists[a], i = da(t), n = pa(t); return "undefined" === typeof e ? n : (e ? delete t.disabled : t.disabled = !0, e === n || i || (s(), e ? r.trigger("renditionenabled") : r.trigger("renditiondisabled")), e) }) }, so = ["seeking", "seeked", "pause", "playing", "error"], oo = function () { function e(t) { var i = this; Hr(this, e), this.tech_ = t.tech, this.seekable = t.seekable, this.seekTo = t.seekTo, this.allowSeeksWithinUnsafeLiveWindow = t.allowSeeksWithinUnsafeLiveWindow, this.media = t.media, this.consecutiveUpdates = 0, this.lastRecordedTime = null, this.timer_ = null, this.checkCurrentTimeTimeout_ = null, this.logger_ = bs("PlaybackWatcher"), this.logger_("initialize"); var n = function () { return i.monitorCurrentTime_() }, a = function () { return i.techWaiting_() }, s = function () { return i.cancelTimer_() }, o = function () { return i.fixesBadSeeks_() }; this.tech_.on("seekablechanged", o), this.tech_.on("waiting", a), this.tech_.on(so, s), this.tech_.on("canplay", n), this.dispose = function () { i.logger_("dispose"), i.tech_.off("seekablechanged", o), i.tech_.off("waiting", a), i.tech_.off(so, s), i.tech_.off("canplay", n), i.checkCurrentTimeTimeout_ && r.a.clearTimeout(i.checkCurrentTimeTimeout_), i.cancelTimer_() } } return qr(e, [{ key: "monitorCurrentTime_", value: function () { this.checkCurrentTime_(), this.checkCurrentTimeTimeout_ && r.a.clearTimeout(this.checkCurrentTimeTimeout_), this.checkCurrentTimeTimeout_ = r.a.setTimeout(this.monitorCurrentTime_.bind(this), 250) } }, { key: "checkCurrentTime_", value: function () { if (this.tech_.seeking() && this.fixesBadSeeks_()) return this.consecutiveUpdates = 0, void (this.lastRecordedTime = this.tech_.currentTime()); if (!this.tech_.paused() && !this.tech_.seeking()) { var e = this.tech_.currentTime(), t = this.tech_.buffered(); if (this.lastRecordedTime === e && (!t.length || e + .1 >= t.end(t.length - 1))) return this.techWaiting_(); this.consecutiveUpdates >= 5 && e === this.lastRecordedTime ? (this.consecutiveUpdates++, this.waiting_()) : e === this.lastRecordedTime ? this.consecutiveUpdates++ : (this.consecutiveUpdates = 0, this.lastRecordedTime = e) } } }, { key: "cancelTimer_", value: function () { this.consecutiveUpdates = 0, this.timer_ && (this.logger_("cancelTimer_"), clearTimeout(this.timer_)), this.timer_ = null } }, { key: "fixesBadSeeks_", value: function () { if (!this.tech_.seeking()) return !1; var e = this.seekable(), t = this.tech_.currentTime(), i = void 0; this.afterSeekableWindow_(e, t, this.media(), this.allowSeeksWithinUnsafeLiveWindow) && (i = e.end(e.length - 1)); this.beforeSeekableWindow_(e, t) && (i = e.start(0) + .1); return "undefined" !== typeof i && (this.logger_("Trying to seek outside of seekable at time " + t + " with seekable range " + Ma(e) + ". Seeking to " + i + "."), this.seekTo(i), !0) } }, { key: "waiting_", value: function () { if (!this.techWaiting_()) { var e = this.tech_.currentTime(), t = this.tech_.buffered(), i = Oa(t, e); return i.length && e + 3 <= i.end(0) ? (this.cancelTimer_(), this.seekTo(e), this.logger_("Stopped at " + e + " while inside a buffered region [" + i.start(0) + " -> " + i.end(0) + "]. Attempting to resume playback by seeking to the current time."), void this.tech_.trigger({ type: "usage", name: "hls-unknown-waiting" })) : void 0 } } }, { key: "techWaiting_", value: function () { var e = this.seekable(), t = this.tech_.currentTime(); if (this.tech_.seeking() && this.fixesBadSeeks_()) return !0; if (this.tech_.seeking() || null !== this.timer_) return !0; if (this.beforeSeekableWindow_(e, t)) { var i = e.end(e.length - 1); return this.logger_("Fell out of live window at time " + t + ". Seeking to live point (seekable end) " + i), this.cancelTimer_(), this.seekTo(i), this.tech_.trigger({ type: "usage", name: "hls-live-resync" }), !0 } var n = this.tech_.buffered(), r = Da(n, t); if (this.videoUnderflow_(r, n, t)) return this.cancelTimer_(), this.seekTo(t), this.tech_.trigger({ type: "usage", name: "hls-video-underflow" }), !0; if (r.length > 0) { var a = r.start(0) - t; return this.logger_("Stopped at " + t + ", setting timer for " + a + ", seeking to " + r.start(0)), this.timer_ = setTimeout(this.skipTheGap_.bind(this), 1e3 * a, t), !0 } return !1 } }, { key: "afterSeekableWindow_", value: function (e, t, i) { var n = arguments.length > 3 && void 0 !== arguments[3] && arguments[3]; if (!e.length) return !1; var r = e.end(e.length - 1) + .1, a = !i.endList; return a && n && (r = e.end(e.length - 1) + 3 * i.targetDuration), t > r } }, { key: "beforeSeekableWindow_", value: function (e, t) { return !!(e.length && e.start(0) > 0 && t < e.start(0) - .1) } }, { key: "videoUnderflow_", value: function (e, t, i) { if (0 === e.length) { var n = this.gapFromVideoUnderflow_(t, i); if (n) return this.logger_("Encountered a gap in video from " + n.start + " to " + n.end + ". Seeking to current time " + i), !0 } return !1 } }, { key: "skipTheGap_", value: function (e) { var t = this.tech_.buffered(), i = this.tech_.currentTime(), n = Da(t, i); this.cancelTimer_(), 0 !== n.length && i === e && (this.logger_("skipTheGap_:", "currentTime:", i, "scheduled currentTime:", e, "nextRange start:", n.start(0)), this.seekTo(n.start(0) + 1 / 30), this.tech_.trigger({ type: "usage", name: "hls-gap-skip" })) } }, { key: "gapFromVideoUnderflow_", value: function (e, t) { for (var i = function (e) { if (e.length < 2) return Br.createTimeRanges(); for (var t = [], i = 1; i < e.length; i++) { var n = e.end(i - 1), r = e.start(i); t.push([n, r]) } return Br.createTimeRanges(t) }(e), n = 0; n < i.length; n++) { var r = i.start(n), a = i.end(n); if (t - r < 4 && t - r > 2) return { start: r, end: a } } return null } }]), e }(), lo = { errorInterval: 30, getSource: function (e) { return e(this.tech({ IWillNotUseThisInPlugins: !0 }).currentSource_) } }, uo = function (e) { !function e(t, i) { var n = 0, r = 0, a = Br.mergeOptions(lo, i); t.ready((function () { t.trigger({ type: "usage", name: "hls-error-reload-initialized" }) })); var s = function () { r && t.currentTime(r) }, o = function (e) { null !== e && void 0 !== e && (r = t.duration() !== 1 / 0 && t.currentTime() || 0, t.one("loadedmetadata", s), t.src(e), t.trigger({ type: "usage", name: "hls-error-reload" }), t.play()) }, l = function () { if (Date.now() - n < 1e3 * a.errorInterval) t.trigger({ type: "usage", name: "hls-error-reload-canceled" }); else { if (a.getSource && "function" === typeof a.getSource) return n = Date.now(), a.getSource.call(t, o); Br.log.error("ERROR: reloadSourceOnError - The option getSource must be a function!") } }, u = function e() { t.off("loadedmetadata", s), t.off("error", l), t.off("dispose", e) }; t.on("error", l), t.on("dispose", u), t.reloadSourceOnError = function (i) { u(), e(t, i) } }(this, e) }; Br.use("*", (function (e) { return { setSource: function (e, t) { t(null, e) }, setCurrentTime: function (t) { return e.vhs && e.currentSource().src === e.vhs.source_.src && e.vhs.setCurrentTime(t), t }, play: function () { e.vhs && e.currentSource().src === e.vhs.source_.src && e.vhs.setCurrentTime(e.tech_.currentTime()) } } })); var co = { PlaylistLoader: ea, Playlist: ga, Decrypter: P.b, AsyncStream: P.a, decrypt: P.c, utils: La, STANDARD_PLAYLIST_SELECTOR: function () { return function (e, t, i, n, a) { var s = e.playlists.map((function (e) { var t, i; return t = e.attributes.RESOLUTION && e.attributes.RESOLUTION.width, i = e.attributes.RESOLUTION && e.attributes.RESOLUTION.height, { bandwidth: e.attributes.BANDWIDTH || r.a.Number.MAX_VALUE, width: t, height: i, playlist: e } })); Ds(s, (function (e, t) { return e.bandwidth - t.bandwidth })); var o = (s = s.filter((function (e) { return !ga.isIncompatible(e.playlist) }))).filter((function (e) { return ga.isEnabled(e.playlist) })); o.length || (o = s.filter((function (e) { return !ga.isDisabled(e.playlist) }))); var l = o.filter((function (e) { return e.bandwidth * Ss.BANDWIDTH_VARIANCE < t })), u = l[l.length - 1], c = l.filter((function (e) { return e.bandwidth === u.bandwidth }))[0]; if (!1 === a) { var h = c || o[0] || s[0]; return h ? h.playlist : null } var d = l.filter((function (e) { return e.width && e.height })); Ds(d, (function (e, t) { return e.width - t.width })); var p = d.filter((function (e) { return e.width === i && e.height === n })); u = p[p.length - 1]; var f = p.filter((function (e) { return e.bandwidth === u.bandwidth }))[0], m = void 0, g = void 0, v = void 0; f || (g = (m = d.filter((function (e) { return e.width > i || e.height > n }))).filter((function (e) { return e.width === m[0].width && e.height === m[0].height })), u = g[g.length - 1], v = g.filter((function (e) { return e.bandwidth === u.bandwidth }))[0]); var y = v || f || c || o[0] || s[0]; return y ? y.playlist : null }(this.playlists.master, this.systemBandwidth, parseInt(Os(this.tech_.el(), "width"), 10), parseInt(Os(this.tech_.el(), "height"), 10), this.limitRenditionByPlayerDimensions) }, INITIAL_PLAYLIST_SELECTOR: function () { var e = this.playlists.master.playlists.filter(ga.isEnabled); return Ds(e, (function (e, t) { return Ms(e, t) })), e.filter((function (e) { return Za(e.attributes.CODECS).videoCodec }))[0] || null }, comparePlaylistBandwidth: Ms, comparePlaylistResolution: function (e, t) { var i = void 0, n = void 0; return e.attributes.RESOLUTION && e.attributes.RESOLUTION.width && (i = e.attributes.RESOLUTION.width), i = i || r.a.Number.MAX_VALUE, t.attributes.RESOLUTION && t.attributes.RESOLUTION.width && (n = t.attributes.RESOLUTION.width), i === (n = n || r.a.Number.MAX_VALUE) && e.attributes.BANDWIDTH && t.attributes.BANDWIDTH ? e.attributes.BANDWIDTH - t.attributes.BANDWIDTH : i - n }, xhr: _a() };["GOAL_BUFFER_LENGTH", "MAX_GOAL_BUFFER_LENGTH", "GOAL_BUFFER_LENGTH_RATE", "BUFFER_LOW_WATER_LINE", "MAX_BUFFER_LOW_WATER_LINE", "BUFFER_LOW_WATER_LINE_RATE", "BANDWIDTH_VARIANCE"].forEach((function (e) { Object.defineProperty(co, e, { get: function () { return Br.log.warn("using Hls." + e + " is UNSAFE be sure you know what you are doing"), Ss[e] }, set: function (t) { Br.log.warn("using Hls." + e + " is UNSAFE be sure you know what you are doing"), "number" !== typeof t || t < 0 ? Br.log.warn("value of Hls." + e + " must be greater than or equal to 0") : Ss[e] = t } }) })); var ho = function (e) { if (/^(audio|video|application)\/(x-|vnd\.apple\.)?mpegurl/i.test(e)) return "hls"; return /^application\/dash\+xml/i.test(e) ? "dash" : null }, po = function (e, t) { for (var i = t.media(), n = -1, r = 0; r < e.length; r++)if (e[r].id === i.uri) { n = r; break } e.selectedIndex_ = n, e.trigger({ selectedIndex: n, type: "change" }) }; co.canPlaySource = function () { return Br.log.warn("HLS is no longer a tech. Please remove it from your player's techOrder.") }; var fo = function (e) { if ("dash" === e.options_.sourceType) { var t = Br.players[e.tech_.options_.playerId]; if (t.eme) { var i = function (e, t, i) { if (!e) return e; var n = {}; for (var r in e) n[r] = { audioContentType: 'audio/mp4; codecs="' + i.attributes.CODECS + '"', videoContentType: 'video/mp4; codecs="' + t.attributes.CODECS + '"' }, t.contentProtection && t.contentProtection[r] && t.contentProtection[r].pssh && (n[r].pssh = t.contentProtection[r].pssh), "string" === typeof e[r] && (n[r].url = e[r]); return Br.mergeOptions(e, n) }(e.source_.keySystems, e.playlists.media(), e.masterPlaylistController_.mediaTypes_.AUDIO.activePlaylistLoader.media()); i && (t.currentSource().keySystems = i, t.eme.initializeMediaKeys && t.eme.initializeMediaKeys()) } } }, mo = function () { if (!window.localStorage) return null; var e = window.localStorage.getItem("videojs-vhs"); if (!e) return null; try { return JSON.parse(e) } catch (yo) { return null } }; co.supportsNativeHls = function () { var e = s.a.createElement("video"); if (!Br.getTech("Html5").isSupported()) return !1; return ["application/vnd.apple.mpegurl", "audio/mpegurl", "audio/x-mpegurl", "application/x-mpegurl", "video/x-mpegurl", "video/mpegurl", "application/mpegurl"].some((function (t) { return /maybe|probably/i.test(e.canPlayType(t)) })) }(), co.supportsNativeDash = !!Br.getTech("Html5").isSupported() && /maybe|probably/i.test(s.a.createElement("video").canPlayType("application/dash+xml")), co.supportsTypeNatively = function (e) { return "hls" === e ? co.supportsNativeHls : "dash" === e && co.supportsNativeDash }, co.isSupported = function () { return Br.log.warn("HLS is no longer a tech. Please remove it from your player's techOrder.") }; var go = function (e) { function t(e, i, n) { Hr(this, t); var r = Wr(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, i, n.hls)); if (i.options_ && i.options_.playerId) { var a = Br(i.options_.playerId); a.hasOwnProperty("hls") || Object.defineProperty(a, "hls", { get: function () { return Br.log.warn("player.hls is deprecated. Use player.tech().hls instead."), i.trigger({ type: "usage", name: "hls-player-access" }), r }, configurable: !0 }), a.vhs = r, a.dash = r, r.player_ = a } if (r.tech_ = i, r.source_ = e, r.stats = {}, r.setOptions_(), r.options_.overrideNative && i.overrideNativeAudioTracks && i.overrideNativeVideoTracks) i.overrideNativeAudioTracks(!0), i.overrideNativeVideoTracks(!0); else if (r.options_.overrideNative && (i.featuresNativeVideoTracks || i.featuresNativeAudioTracks)) throw new Error("Overriding native HLS requires emulated tracks. See https://git.io/vMpjB"); return r.on(s.a, ["fullscreenchange", "webkitfullscreenchange", "mozfullscreenchange", "MSFullscreenChange"], (function (e) { var t = s.a.fullscreenElement || s.a.webkitFullscreenElement || s.a.mozFullScreenElement || s.a.msFullscreenElement; t && t.contains(r.tech_.el()) && r.masterPlaylistController_.smoothQualityChange_() })), r.on(r.tech_, "seeking", (function () { 0 === this.tech_.currentTime() && this.tech_.player_.loop() && this.setCurrentTime(0) })), r.on(r.tech_, "error", (function () { this.masterPlaylistController_ && this.masterPlaylistController_.pauseLoading() })), r.on(r.tech_, "play", r.play), r } return Vr(t, e), qr(t, [{ key: "setOptions_", value: function () { var e = this; if (this.options_.withCredentials = this.options_.withCredentials || !1, this.options_.handleManifestRedirects = this.options_.handleManifestRedirects || !1, this.options_.limitRenditionByPlayerDimensions = !1 !== this.options_.limitRenditionByPlayerDimensions, this.options_.smoothQualityChange = this.options_.smoothQualityChange || !1, this.options_.useBandwidthFromLocalStorage = "undefined" !== typeof this.source_.useBandwidthFromLocalStorage ? this.source_.useBandwidthFromLocalStorage : this.options_.useBandwidthFromLocalStorage || !1, this.options_.customTagParsers = this.options_.customTagParsers || [], this.options_.customTagMappers = this.options_.customTagMappers || [], this.options_.cacheEncryptionKeys = this.options_.cacheEncryptionKeys || !1, "number" !== typeof this.options_.blacklistDuration && (this.options_.blacklistDuration = 300), "number" !== typeof this.options_.bandwidth && this.options_.useBandwidthFromLocalStorage) { var t = mo(); t && t.bandwidth && (this.options_.bandwidth = t.bandwidth, this.tech_.trigger({ type: "usage", name: "hls-bandwidth-from-local-storage" })), t && t.throughput && (this.options_.throughput = t.throughput, this.tech_.trigger({ type: "usage", name: "hls-throughput-from-local-storage" })) } "number" !== typeof this.options_.bandwidth && (this.options_.bandwidth = Ss.INITIAL_BANDWIDTH), this.options_.enableLowInitialPlaylist = this.options_.enableLowInitialPlaylist && this.options_.bandwidth === Ss.INITIAL_BANDWIDTH, ["withCredentials", "limitRenditionByPlayerDimensions", "bandwidth", "smoothQualityChange", "customTagParsers", "customTagMappers", "handleManifestRedirects", "cacheEncryptionKeys"].forEach((function (t) { "undefined" !== typeof e.source_[t] && (e.options_[t] = e.source_[t]) })), this.limitRenditionByPlayerDimensions = this.options_.limitRenditionByPlayerDimensions } }, { key: "src", value: function (e, t) { var i = this; e && (this.setOptions_(), this.options_.url = this.source_.src, this.options_.tech = this.tech_, this.options_.externHls = co, this.options_.sourceType = ho(t), this.options_.seekTo = function (e) { i.tech_.setCurrentTime(e), i.setCurrentTime(e) }, this.masterPlaylistController_ = new ro(this.options_), this.playbackWatcher_ = new oo(Br.mergeOptions(this.options_, { seekable: function () { return i.seekable() }, media: function () { return i.masterPlaylistController_.media() } })), this.masterPlaylistController_.on("error", (function () { Br.players[i.tech_.options_.playerId].error(i.masterPlaylistController_.error) })), this.masterPlaylistController_.selectPlaylist = this.selectPlaylist ? this.selectPlaylist.bind(this) : co.STANDARD_PLAYLIST_SELECTOR.bind(this), this.masterPlaylistController_.selectInitialPlaylist = co.INITIAL_PLAYLIST_SELECTOR.bind(this), this.playlists = this.masterPlaylistController_.masterPlaylistLoader_, this.mediaSource = this.masterPlaylistController_.mediaSource, Object.defineProperties(this, { selectPlaylist: { get: function () { return this.masterPlaylistController_.selectPlaylist }, set: function (e) { this.masterPlaylistController_.selectPlaylist = e.bind(this) } }, throughput: { get: function () { return this.masterPlaylistController_.mainSegmentLoader_.throughput.rate }, set: function (e) { this.masterPlaylistController_.mainSegmentLoader_.throughput.rate = e, this.masterPlaylistController_.mainSegmentLoader_.throughput.count = 1 } }, bandwidth: { get: function () { return this.masterPlaylistController_.mainSegmentLoader_.bandwidth }, set: function (e) { this.masterPlaylistController_.mainSegmentLoader_.bandwidth = e, this.masterPlaylistController_.mainSegmentLoader_.throughput = { rate: 0, count: 0 } } }, systemBandwidth: { get: function () { var e = 1 / (this.bandwidth || 1), t = void 0; return t = this.throughput > 0 ? 1 / this.throughput : 0, Math.floor(1 / (e + t)) }, set: function () { Br.log.error('The "systemBandwidth" property is read-only') } } }), this.options_.bandwidth && (this.bandwidth = this.options_.bandwidth), this.options_.throughput && (this.throughput = this.options_.throughput), Object.defineProperties(this.stats, { bandwidth: { get: function () { return i.bandwidth || 0 }, enumerable: !0 }, mediaRequests: { get: function () { return i.masterPlaylistController_.mediaRequests_() || 0 }, enumerable: !0 }, mediaRequestsAborted: { get: function () { return i.masterPlaylistController_.mediaRequestsAborted_() || 0 }, enumerable: !0 }, mediaRequestsTimedout: { get: function () { return i.masterPlaylistController_.mediaRequestsTimedout_() || 0 }, enumerable: !0 }, mediaRequestsErrored: { get: function () { return i.masterPlaylistController_.mediaRequestsErrored_() || 0 }, enumerable: !0 }, mediaTransferDuration: { get: function () { return i.masterPlaylistController_.mediaTransferDuration_() || 0 }, enumerable: !0 }, mediaBytesTransferred: { get: function () { return i.masterPlaylistController_.mediaBytesTransferred_() || 0 }, enumerable: !0 }, mediaSecondsLoaded: { get: function () { return i.masterPlaylistController_.mediaSecondsLoaded_() || 0 }, enumerable: !0 }, buffered: { get: function () { return Ra(i.tech_.buffered()) }, enumerable: !0 }, currentTime: { get: function () { return i.tech_.currentTime() }, enumerable: !0 }, currentSource: { get: function () { return i.tech_.currentSource_ }, enumerable: !0 }, currentTech: { get: function () { return i.tech_.name_ }, enumerable: !0 }, duration: { get: function () { return i.tech_.duration() }, enumerable: !0 }, master: { get: function () { return i.playlists.master }, enumerable: !0 }, playerDimensions: { get: function () { return i.tech_.currentDimensions() }, enumerable: !0 }, seekable: { get: function () { return Ra(i.tech_.seekable()) }, enumerable: !0 }, timestamp: { get: function () { return Date.now() }, enumerable: !0 }, videoPlaybackQuality: { get: function () { return i.tech_.getVideoPlaybackQuality() }, enumerable: !0 } }), this.tech_.one("canplay", this.masterPlaylistController_.setupFirstPlay.bind(this.masterPlaylistController_)), this.tech_.on("bandwidthupdate", (function () { i.options_.useBandwidthFromLocalStorage && function (e) { if (!window.localStorage) return !1; var t = mo(); t = t ? Br.mergeOptions(t, e) : e; try { window.localStorage.setItem("videojs-vhs", JSON.stringify(t)) } catch (yo) { return !1 } }({ bandwidth: i.bandwidth, throughput: Math.round(i.throughput) }) })), this.masterPlaylistController_.on("selectedinitialmedia", (function () { !function (e) { var t = e.playlists; e.representations = function () { return t.master.playlists.filter((function (e) { return !da(e) })).map((function (t, i) { return new ao(e, t, t.uri) })) } }(i), fo(i) })), this.on(this.masterPlaylistController_, "progress", (function () { this.tech_.trigger("progress") })), this.tech_.ready((function () { return i.setupQualityLevels_() })), this.tech_.el() && this.tech_.src(Br.URL.createObjectURL(this.masterPlaylistController_.mediaSource))) } }, { key: "setupQualityLevels_", value: function () { var e = this, t = Br.players[this.tech_.options_.playerId]; t && t.qualityLevels && (this.qualityLevels_ = t.qualityLevels(), this.masterPlaylistController_.on("selectedinitialmedia", (function () { var t, i; t = e.qualityLevels_, (i = e).representations().forEach((function (e) { t.addQualityLevel(e) })), po(t, i.playlists) })), this.playlists.on("mediachange", (function () { po(e.qualityLevels_, e.playlists) }))) } }, { key: "play", value: function () { this.masterPlaylistController_.play() } }, { key: "setCurrentTime", value: function (e) { this.masterPlaylistController_.setCurrentTime(e) } }, { key: "duration", value: function () { return this.masterPlaylistController_.duration() } }, { key: "seekable", value: function () { return this.masterPlaylistController_.seekable() } }, { key: "dispose", value: function () { this.playbackWatcher_ && this.playbackWatcher_.dispose(), this.masterPlaylistController_ && this.masterPlaylistController_.dispose(), this.qualityLevels_ && this.qualityLevels_.dispose(), this.player_ && (delete this.player_.vhs, delete this.player_.dash, delete this.player_.hls), this.tech_ && this.tech_.hls && delete this.tech_.hls, function e(t, i, n) { null === t && (t = Function.prototype); var r = Object.getOwnPropertyDescriptor(t, i); if (void 0 === r) { var a = Object.getPrototypeOf(t); return null === a ? void 0 : e(a, i, n) } if ("value" in r) return r.value; var s = r.get; return void 0 !== s ? s.call(n) : void 0 }(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "dispose", this).call(this) } }, { key: "convertToProgramTime", value: function (e, t) { return Aa({ playlist: this.masterPlaylistController_.media(), time: e, callback: t }) } }, { key: "seekToProgramTime", value: function (e, t) { var i = !(arguments.length > 2 && void 0 !== arguments[2]) || arguments[2], n = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : 2; return Ia({ programTime: e, playlist: this.masterPlaylistController_.media(), retryCount: n, pauseAfterSeek: i, seekTo: this.options_.seekTo, tech: this.options_.tech, callback: t }) } }]), t }(Br.getComponent("Component")), vo = { name: "videojs-http-streaming", VERSION: "1.10.6", canHandleSource: function (e) { var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {}, i = Br.mergeOptions(Br.options, t); return vo.canPlayType(e.type, i) }, handleSource: function (e, t) { var i = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : {}, n = Br.mergeOptions(Br.options, i); return t.hls = new go(e, t, n), t.hls.xhr = _a(), t.hls.src(e.src, e.type), t.hls }, canPlayType: function (e) { var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {}, i = Br.mergeOptions(Br.options, t), n = i.hls.overrideNative, r = ho(e), a = r && (!co.supportsTypeNatively(r) || n); return a ? "maybe" : "" } }; "undefined" !== typeof Br.MediaSource && "undefined" !== typeof Br.URL || (Br.MediaSource = hs, Br.URL = ds), hs.supportsNativeMediaSources() && Br.getTech("Html5").registerSourceHandler(vo, 0), Br.HlsHandler = go, Br.HlsSourceHandler = vo, Br.Hls = co, Br.use || Br.registerComponent("Hls", co), Br.options.hls = Br.options.hls || {}, Br.registerPlugin ? Br.registerPlugin("reloadSourceOnError", uo) : Br.plugin("reloadSourceOnError", uo), t.a = Br } }]);